\part*{Part I: Gelfand-Kazhdan descent and chiral differential
  operators}

The goal of this part is to provide a construction of chiral differential operators via the methods of Gelfand-Kazhdan formal geometry; this approach is a modest modification of an approach described for the chiral de Rham complex in \cite{MSV}. (In subsequent work we will provide a BV construction of chiral de Rham complex, along with a family of related sheaves of vertex algebras.) Our phrasing here aims to highlight the parallels with the next part, where we introduce a homotopy-coherent version of Gelfand-Kazhdan formal geometry that works nicely with the Batalin-Vilkovisky formalism and Feynman diagrammatics and thus allows us to construct a factorization algebra refining CDOs.

Recall that Gelfand-Kazhdan formal geometry is an approach to any ``natural'' construction in differential geometry, i.e., to constructions that apply uniformly to all manifolds of a given dimension (or with some other common, local geometric structure). The basic idea is that on any $n$-manifold, the immediate neighborhood of every point looks the same, and so if some construction can be described on any sufficiently small neighborhood and is equivariant for local diffeomorphisms, the construction should apply to every $n$-manifold. In other words, it is a kind of refinement of tensor calculus. To be more precise, in formal geometry, one works with a ``formal'' neighborhood of a point $p$ in $\RR^n$, namely the ``space'' whose algebra of functions is the $\infty$-jets of functions at $p$ ({\em aka} Taylor series at $p$ of functions). Let us denote this space by $\hD^n$.The relevant group of ``formal'' diffeomorphisms then means the $\infty$-jet at $p$ of diffeomorphisms that fix $p$ ({\em aka} Taylor series at $p$ of diffeomorphisms), which we will denote by $\Aut_n$. (Note that for every point $p$, the group is isomorphic.) Every $n$-manifold $X$ possesses a canonical {\em flat} principal $\Aut_n$-bundle $X^{coor}$ whose fiber over $p \in X$ is the space of formal coordinates centered at $p$ and is equipped with a flat connection valued in formal vector fields $\Vect$ (which is slightly larger than the Lie algebra of $\Aut_n$).  In the context of this paper we are interested in complex manifolds and there is a corresponding bundle of holomorphic formal coordinates. These are $\infty$-jets of biholomorphisms.

From this reasoning we see that every $\Aut_n$-representation $V$ that has a compatible action of $\Vect$ produces a flat vector bundle $\cV_X$ over each $n$-dimensional manifold $X$ whose horizontal sections typically encode familiar vector bundles. Such a representation is called a Harish-Chandra module. As an example, consider $\hO_n$, the functions on $\hD^n$, whose flat sections over $X$ are smooth functions on $X$ (holomorphic functions in the complex case). Or consider $\hT_n$, the vector fields on $\hD^n$, whose flat sections over $X$ are vector fields on $X$. This construction of a vector bundle on $X$ from an $\Aut_n$-representation is an example of Gelfand-Kazhdan descent. In light of this, it should be no surprise that there is a Gelfand-Kazhdan version of characteristic classes for these vector bundles that recovers the usual Chern classes.

\begin{rmk} The Gelfand-Kazhdan approach to formal geometry can also be applied to more interesting geometries. For example, symplectic, Poisson, or even Riemannian geometry can be encapsulated by the formalism.
\end{rmk}

Chiral differential operators, like differential operators, are easy to define locally on an $n$-manifold, using coordinates. The challenge is to glue these local descriptions to produce the global object. The vertex algebra $\hCDO_n$ of CDOs on a formal $n$-disk $\hD_n$ is well-known, but it is not equivariant for the Harish-Chandra pair of automorphisms of $\hD_n$. The failure to be equivariant is a characteristic class that globalizes to the first Pontryagin class, or $\ch_2(T_X)$, in Dolbeault cohomology. This class defines an extension of the Harish-Chandra pair, and $\hCDO_n$ is equivariant for this extension. Each choice of trivialization $\alpha$ of $\ch_2(T_X)$ encodes an extension $\Tilde{X}^{coor}_\alpha$ of $X^{coor}$ to a flat principal bundle for this extension of pairs. Hence, one can apply Gelfand-Kazhdan descent to $\hCDO_n$ along $\Tilde{X}^{coor}_\alpha$ to produce a vertex algebra, and it is precisely the chiral differential operators on $X$ associated to the trivialization $\alpha$.

Sections \ref{sec hc descent} and \ref{sec gk descent} of this part are devoted to articulating rigorously this machinery in a format convenient for our problem. As mentioned parenthetically, we need a slight enlargement of the theory of flat vector bundles involving Harish-Chandra pairs, which consist of a Lie group and a thickening of its Lie algebra.

Specifically, in Section \ref{sec gk descent} we formulate a version of Harish-Chandra descent that we call {\em Gelfand-Kazhdan descent} that is suitable for our purposes. In Section \ref{sec vertex alg} we recall well-known facts about the vertex algebra of affine chiral differential operators and extracting the relavent Harish-Chandra structures. Sections \ref{sec ext desc} is devoted to developing an extended version of Gelfand-Kazhdan descent that is applied to CDOs in Section ~\ref{sec vertex desc}.

We will extract some familiar properties and structures of the sheaf of chiral differential operators from the perspective of Gelfand-Kazhdan formal geometry. For instance, we show in Proposition \ref{prop conformal cdo} that chiral differential operators have the structure of a sheaf of {\em conformal} vertex algebras only if $X$ is Calabi-Yau (in addition to having $\ch_2(T_X) = 0$, of course). Moreover, we show how the Witten genus appears as the character of the sheaf of CDOs, which has already appeared in the works \cite{Cheung, BorLib}. 

\begin{rmk} We should emphasize here that Part I is not the truly novel aspect of this paper. As mentioned in \cite{MSV}, the standard arguments of Gelfand-Kazhdan formal geometry apply to the chiral de Rham complex, and they certainly knew that a minor extension of such formal geometry should allow one to construct CDOs. Our main goal in Part I is to explain these standard arguments and this extension carefully and systematically. We do this for two reasons: first, to allow a systematic comparison with the BV quantization in Part II, and second, to provide a general tool that ought to be applicable to constructing many more interesting vertex algebras. There are elegant machines for such purposes, thanks to \cite{BD, KV}, but we wanted a version closer to the concrete computations that most interest us.
\end{rmk}

\section{Flat vector bundles and Harish-Chandra descent} \label{sec hc descent}

This section is a discussion of the theory of vector bundles with flat connection arising from Harish-Chandra pairs. It establishes notation and terminology but can likely be used as a reference. In this section we have largely treated both smooth and holomorphic geometry, but throughout the rest of the paper we are concerned with the latter.

\subsection{Algebra of Harish-Chandra pairs}

\subsubsection{Harish-Chandra pairs}
All Lie algebras and Lie groups will be defined over $\CC$. For $G$ a Lie group, we use $\Lie(G)$ to denote its associated Lie algebra, which can be identified with the tangent space of the identity element. To start, we work with finite-dimensional groups and algebras, but we will eventually discuss certain infinite-dimensional examples.
 
\begin{dfn} A {\em Harish-Chandra pair} (or HC-pair) is a pair $(\fg, K)$ where $\fg$ is a Lie algebra and $K$ is a Lie group together with
\begin{itemize}
\item[(i)] an action of $K$ on $\fg$, $\rho_K : K \to {\rm Aut}(\fg)$
\item[(ii)] an injective Lie algebra map $i : {\rm Lie}(K) \hookrightarrow \fg$
\end{itemize}
such that the action of $\Lie(K)$ on $\fg$ induced by $\rho_K$,
\ben
{\rm Lie}(\rho_K) : {\rm Lie}(K) \to {\rm Der}(\fg),
\een
is the adjoint action induced from the embedding $i: {\rm Lie}(K) \hookrightarrow \fg$.
\end{dfn}

\begin{ex} If $G$ is a Lie group and $K$ is a closed subgroup, then
  the pair $({\rm Lie}(G), K)$ is a HC-pair. 
\end{ex}

\begin{dfn} 
A {\em morphism of Harish-Chandra pairs} $(\mathfrak{f}, f) : (\fg, K) \to (\fg',K')$ is 
\begin{itemize}
\item[(i)] a map of Lie algebras $\mathfrak{f} : \fg \to \fg'$ and
\item[(ii)] a map of Lie groups $f : K \to K'$
\end{itemize}
such that the diagram in Lie algebras
\ben
\xymatrix{
{\rm Lie}(K) \ar[r]^-{{\rm Lie}(f)} \ar[d]_-{i} & {\rm Lie}(K') \ar[d]_-{i'} \\
\fg \ar[r]^-{\mathfrak{f}} & \fg' 
}
\een
commutes. 
\end{dfn}

%Equivalently, this category can be described as follows. Let ${\rm LieGrp}_{\mathbb{F}}$ be the category of Lie groups and ${\rm Lie}_{\mathbb{F}}$ be the category of Lie algebras over $\FF$. 
%Define the category ${\rm Lie}_{\FF}^{\rm inj}$ whose objects are injective maps of Lie algebras $\fh \hookrightarrow \fg$ and whose morphisms are the obvious commuting squares. There is a forgetful functor ${\rm Lie}_\FF^{\rm inj} \to {\rm Lie}_\FF$ that sends an object $\fh \hookrightarrow \fg$ to the source Lie algebra $\fh$. 
%
%\brian{Then $\pairs_\FF$ is the categorical pull-back
%\ben
%\xymatrix{
%\pairs_\FF \ar[r] \ar[d] & {\rm LieGrp}_{\mathbb{F}} \ar[d]^-{\rm Lie} \\
%{\rm Lie}^{\rm inj}_{\FF} \ar[r]^-{\rm forget} & {\rm Lie}_{\FF} . 
%}
%\een
%BAD: This is a little funky, because I have no condition that the action of ${\rm Lie}(K)$ on $\fg$ agrees with the adjoint action. Need to fix this, any ideas?}

\subsubsection{Modules}

Fix a HC-pair $(\fg,K)$. In this section we set up the notion of a module for~$(\fg,K)$. Below, we discuss modules in the category of vector spaces, but the definition is easily generalized to $\CC$-linear symmetric monoidal categories.

\begin{dfn} \label{hcmod}
A {\em $(\fg,K)$-module} is a vector space $V$ together with 
\begin{itemize}
\item[(i)] a Lie algebra map $\rho_\fg : \fg \to {\rm End}(V)$ and
\item[(ii)] a Lie group map $\rho_K : K \to \GL(V)$ 
\end{itemize}
such that the composition
\ben
\xymatrix{
{\rm Lie}(K) \ar[r]^-{i} & \fg \ar[r]^-{\rho_\fg} & {\rm End}(V)
}
\een
equals ${\rm Lie}(\rho_K)$. 

A {\em morphism of $(\fg,K)$-modules} is a linear map intertwining the actions of $\fg$ and $K$.

Denote the category of $(\fg,K)$-modules by $\Mod_{(\fg,K)}$.
Denote by $\Mod_{(\fg,K)}^{fin}$ the full subcategory whose objects consist of modules whose underlying vector space is finite-dimensional.
\end{dfn}

%In other words, a morphism of $(\fg,K)$-modules is specified by a  map of underlying $\fg$-modules. 

\subsection{Bundles}

We will need the analog of a torsor for a pair $(\fg,K)$ over a manifold $X$.
Our definitions are structural and so apply equally well to both
smooth and complex manifolds. In the complex case we will need
the notion of a holomorphic $(\fg,K)$-torsor. 

When $X$ is complex, we use $\cO^{hol}(X)$ to denote the space of
holomorphic functions and $\cX^{hol}(X)$ to denote holomorphic vector fields, 
i.e., holomorphic sections of $T^{1,0}X$. 
We let $\Omega^k(X)$ denote the space of smooth $k$-forms and $d_{\dR}$ the de Rham differential. 
If $X$ is complex, then $\Omega^{k,l}(X)$ denotes the smooth $(k,l)$-forms according to the Hodge decomposition. 
We denote by $\Omega^k_{hol}(X)$ the space of holomorphic $k$-forms,
i.e., holomorphic sections of~$\Lambda^k T^{*,(1,0)}X$. Finally, when
we consider a differential graded vector space $(V,\d)$ we let $V^\#$
denote the underlying graded vector space $V$. For instance,
$\Omega^\#(X)$ denotes the graded vector space of differential forms on $X$. 

\begin{dfn} \label{gkbun}
A {\em $(\fg,K)$-principal bundle with flat connection} (or more concisely, flat $(\fg,K)$-bundle) over $X$ is 
\begin{itemize}
\item[(i)] a principal $K$-bundle $P \to X$ and
\item[(ii)] a $K$-invariant $\fg$-valued $1$-form on $P$, $\omega \in \Omega^1(P; \fg)$
\end{itemize}
such that 
\begin{itemize}
\item[(1)] for all $a \in {\rm Lie}(K)$, we have $\omega(\xi_a) = a$ where $\xi_a \in \cX(P)$ denotes the induced vector field and 
\item[(2)] $\omega$ satisfies the Maurer-Cartan equation
\ben
\d_{dR} \omega + \frac{1}{2}[\omega,\omega] = 0
\een
where the bracket is taken in the Lie algebra $\fg$. 
\end{itemize}
\end{dfn}

In particular, if $\fg = \Lie(K)$, then condition (1) encodes the usual notion of a connection on a principal $K$-bundle, while condition (2) says that the connection is {\em flat}, i.e., we have a principal bundle for the discrete group~$K^\delta$ underlying~$K$.\si

Recall that one can interpret a connection on a principal $K$-bundle as a splitting of the tangent bundle $TP$ into horizontal and vertical components in a $K$-equivariant way. 
Let $T_\pi P$ denote the vertical tangent bundle (i.e., the kernel of the projection map $TP \to \pi^* TX$);
note that $T_\pi P$ is canonically isomorphic to the trivial bundle $\ul{{\rm Lie}(K)}$ over $P$.
A connection $\omega \in \Omega^1(P,{\rm Lie}(K))$ then determines a splitting
\ben
TP = T_\pi P \oplus H_\omega
\een
where $H_\omega \subset TP$ is defined as $\ker \omega$. That is, $H_\omega|_{p}$ is the subspace of $T_p P$ consisting of all vectors $X_p$ such that $\omega(X_p) = 0$ so that $H_{\omega}|_p \cong T_{\pi(p)}X$.   

There is a similar interpretation for Harish-Chandra pairs.
The embedding $i: \Lie(K) \hookrightarrow \fg$ determines a map of trivial bundles $i_P: \ul{{\rm Lie}(K)} \to \ul{\fg}$ over $P$. Define $T_\fg P$ to be the pushout
\ben
\xymatrix{
\ul{{\rm Lie}(K)} \ar[r] \ar[d] & \ul{\fg} \ar[d] \\
TP \ar[r] & T_\fg P
}
\een
in bundles over $P$. Then a $K$-equivariant element $\omega \in \Omega^1(P; \fg)$ satisfying (ii) above is equivalent to a $K$-equivariant splitting
\ben
T_\fg P = \ul{\fg} \oplus H_{\omega}, 
\een
where $H_{\omega}|_p \cong T_{\pi(p)} X$. 

Note that if there is an inclusion of Lie groups $K \hookrightarrow G$ inducing $\Lie(K) \hookrightarrow \Lie(G) = \fg$, 
then this data is a flat $G$-bundle along with a reduction of structure group to a flat $K$-bundle.
This example indicates that the Harish-Chandra version is a useful replacement in the case where the map $i:\Lie(K) \to \fg$ does \emph{not} integrate to a map of Lie groups. 

\begin{ex} The most
important example is the case where $\fg = \Vect$, the Lie algebra
of formal vector fields, and $K = \GL_n$. In fact, $\Vect$ is not the
Lie algebra of any Lie group. The pair $(\Vect,\GL_n)$ is
fundamental for Gelfand-Kazhdan descent, defined in later sections.
\end{ex}

In the complex case it is natural to include the holomorphic structure. 

\begin{dfn}\label{holgk} 
Let $X$ be a complex manifold, $K$ a complex Lie group, and $\fg$ a complex Lie algebra. 
A {\em holomorphic} $(\fg,K)$-principal bundle with flat connection is a holomorphic principal
$K$-bundle $P \to X$ together with a $K$-invariant $\fg$-valued
holomorphic $1$-form $\omega \in \Omega^1_{hol}(P;\fg)$ such that 
\begin{itemize}
\item[(1)] for all $a \in \Lie(K)$, we have $\omega(\xi_a) = a$ where
  $\xi_a \in \cX^{hol}(P)$; 
\item[(2)] $\omega$ satisfies the Maurer-Cartan equation
\ben
\partial \omega + \frac{1}{2} [\omega, \omega] = 0 .
\een 
\end{itemize}
\end{dfn}

\begin{rmk} 
Since $\omega$ in Definition \ref{holgk} is assumed to be holomorphic, i.e., $\dbar \omega = 0$, 
the Maurer-Cartan equation is equivalent to 
\ben
\d_{dR} \omega + \frac{1}{2} [\omega, \omega] = 0
\een 
where $\d_{dR} = \partial + \dbar$ is the full de Rham differential decomposed via the complex structure on $P \to X$. 
Thus, a holomorphic $(\fg,K)$-principal bundle with flat connection $(P \to X, \omega)$ is equivalent to 
an ordinary $(\fg,K)$-principal bundle with flat connection (as in Definition \ref{gkbun}) such that 
the underlying $K$-bundle is holomorphic and $\omega$ is a $(1,0)$-form.
\end{rmk}

We now turn to maps between such structures.

\begin{dfn}
A {\em morphism of $(\fg,K)$-bundles} $(P \to X, \omega) \to (P' \to X', \omega')$ is a map of $K$-principal bundles
\ben
\xymatrix{
P \ar[r]^F \ar[d] & P' \ar[d] \\
X \ar[r]^f & X'
}
\een
such that $F^* \omega' = \omega$. 

Denote the category of flat $(\fg,K)$-bundles by $\Loc_{(\fg,K)}$. 
\end{dfn}

Note that there is a forgetful functor from  $\Loc_{(\fg,K)}$ to ${\rm
  Man}$, the category of manifolds which is either (a) smooth manifolds
with smooth maps or (b) complex manifolds with holomorphic maps. As flat bundles pull back along maps of the underlying manifolds,
we have that this functor is a cartesian fibration.

\subsection{Descent}

Recall the associated bundle construction: given a principal $K$-bundle $\pi : P \to X$ and a finite-dimensional $K$-representation $V$, form the vector bundle
\ben
V_X := P \times^K V
\een
over $X$. 
(People often use the notation $P\times_K V$ instead, but we wish to avoid potential confusion with the fibered product.)\si

One can view this construction as a pairing between the category of principal $K$-bundles and the category of finite-dimensional $K$-modules, i.e., a functor
\[
- \times^K - : {\rm Bun}_K^\op \times \Mod_K^{fin} \to {\rm VB}
\]
where ${\rm Bun}_K$ is the cartesian fibration whose fiber over a manifold $X$ is the category of $K$-principal bundles on $X$,
where ${\rm VB} \to {\rm Man}$ is the cartesian fibration whose fiber over $X$ is the category of vector bundles on $X$, and 
where $\Mod_K$ denotes the category of $K$-modules. This is a functor
between cartesian fibrations over ${\rm Man}$. This functor exhibits how natural the associated bundle construction is, and 
it can be used to produce natural characteristic classes for $K$-bundles.

In this section, we will produce an analogous functor of {\em Harish-Chandra descent}
\[
\desc: \Loc_{(\fg,K)}^\op \times \Mod_{(\fg,K)}^{fin} \to {\rm VB}_{flat},
\]
where ${\rm VB}_{flat}$ denotes the cartesian fibration whose fiber over a manifold $X$ is the category of flat vector bundles on $X$.
It says, in essence, that each $(\fg,K)$-bundle on $X$ produces a family of local systems on $X$, and 
these are natural under pullback of bundles.
Similarly, each $(\fg,K)$-module produces a functor from flat $(\fg,K)$-bundles to local systems over the site of all manifolds.

\begin{rmk}
The construction is often termed \emph{Harish-Chandra localization}
(see \cite{BK} \cite{BL}),
but this terminology occasionally led to possible ambiguities due to other uses of of the word ``localization,''
so we use ``descent.''
\end{rmk}

We will also describe the characteristic map, which is a natural transformation 
\[
{\rm char} : \clie^*(\fg,K; -) \Rightarrow \Omega^*(-,\desc(-)),
\]
where $\clie^*(\fg,K; -)$ denotes the relative Lie algebra cochains functor (it is independent of the bundle variable) and 
where $\Omega^*(-,\desc(-))$ denotes the de Rham complex of the flat bundle produced by $\desc$.
This natural transformation encodes the secondary characteristic classes of these flat bundles.

\subsubsection{Basic forms}

There is a model for the associated bundle construction that is useful for our purposes. 
Let $V$ be a finite-dimensional $K$-representation. 
Denote by $\ul{V}$ the trivial vector bundle on $P$ with fiber $V$. 
Sections of this bundle $\Gamma_P(V)$ have the structure of a $K$-representation by
\ben
A \cdot (f\tensor v) := (A \cdot f) \tensor (A \cdot v) \;\; , \;\; A \in K, \; f \in \cO(P)\; , v \in V .
\een
Every $K$-invariant section $f : P \to \ul{V}$ induces a section $s(f): X \to V_X$,
where the value of $s(f)$ at $x \in X$ is the $K$-equivalence class $[(p,f(p)]$, with $p \in \pi^{-1}(x) \cong K$.
That is, there is a natural map 
\ben
s : \Gamma_P(\ul{V})^K \to \Gamma_X(V_X) 
\een
and it is an isomorphism of $\cO(X)$-modules. A $K$-invariant section $f$ of $\ul{V} \to P$ also satisfies the infinitesimal version of invariance: 
\ben
(Y \cdot f)\tensor v + f \tensor {\rm Lie}(\rho)(Y) \cdot v = 0 
\een
for any $Y \in {\rm Lie}(K)$.

There is a similiar statement for differential forms with values in the bundle $V_X$. Let $\Omega^k(P ; \ul{V}) = \Omega^k(P) \tensor V$ denote the space of $k$-forms on $P$ with values in the trivial bundle $\ul{V}$. Given $\alpha \in \Omega^1(X ; V_X)$, its pull-back along the projection $\pi: P \to X$ is annihilated by any vertical vector field on $P$. In general, if $\alpha \in \Omega^k(X; V_X)$, then $i_Y(\pi^*\alpha) = 0$ for all $Y \in {\rm Lie}(K)$.

\begin{dfn} A $k$-form $\alpha \in \Omega^k(P; \ul{V})$ is called {\em basic} if 
\begin{itemize}
\item[(i)] it is $K$-invariant: $L_Y \alpha + \rho(Y) \cdot \alpha = 0 $ for all $Y \in {\rm Lie}(K)$ and
\item[(ii)] it vanishes on vertical vector fields: $i_Y \alpha = 0$ for all $Y \in {\rm Lie}(K)$. 
\end{itemize}
\end{dfn}

Denote the subspace of basic $k$-forms by $\Omega^k(P; \ul{V})_{bas}$. Just as with sections, there is a natural isomorphism
\ben
s : \Omega^k(P; \ul{V})_{bas} \xto{\cong} \Omega^k(X; V_X) 
\een
between basic $k$-forms and $k$-forms on $X$ with values in the associated bundle.
In fact, $\Omega^{\#}(P; \ul{V})_{bas}$ forms a graded submodule of $\Omega^{\#}(P; \ul{V})$ and the isomorphism $s$ extends to an isomorphism of graded modules $\Omega^{\#}(P; \ul{V})_{bas} \cong \Omega^{\#}(X; V_X)$.

It is manifest that this construction of basic forms is natural in maps of $(\fg,K)$-bundles: basic forms pull back to basic forms along maps of bundles.

\subsubsection{}

Fix a $(\fg,K)$-bundle $P \to X$ with connection one-form $\omega \in \Omega^1(P; \fg)$. Fix a $(\fg,K)$-module $V$ with action maps $\rho_K$ and $\rho_{\fg}$. The subalgebra of basic forms
\ben
\Omega^{\#}(P; \ul{V})_{bas} \subset \Omega^{\#}(P; \ul{V})
\een
only uses the data of the $K$-representation. The $\fg$-module structure induces an operator
\ben
\rho_\fg(\omega) : \Omega^k(P; \ul{V}) \to \Omega^{k+1}(P; \ul{V})
\een
for each $k$. Let $\nabla^{P,V}$ denote the operator
\ben
\nabla^{P,V} := \d_{dR,P} + \rho_\fg(\omega) : \Omega^k(P; \ul{V}) \to \Omega^{k+1}(P; \ul{V})
\een 
for each~$k$. 

A direct calculation verifies the following. 

\begin{lemma} 
The operator $\nabla^{P,V}$ is a differential on the submodule of basic forms.
Under the isomorphism $s: \Omega^{\#}(P; \ul{V})_{bas} \cong \Omega^{\#}(X;
V_X)$, the cochain complex $(\Omega^{\#}(P; \ul{V})_{bas}, \nabla^V)$ is a
dg module over $\Omega^*(X)$. 
\end{lemma}

%\begin{itemize}
%\item[(1)] $\nabla^V$ preserves the sub-algebra of basic forms and so determines an operator
%\ben
%\nabla^V : \Omega^k(X; V_X) \to \Omega^{k+1}(X; V_X) .
%\een
%\item[(2)] If $f \in \cO(X) \cong \cO(P)^K$ and $\alpha \in \Omega^k(P; \ul{V})_{bas} \cong \Omega^k(X; V_X)$ then
%\ben
%\nabla^V(f \cdot \alpha) = (\d_{dR} f) \tensor \alpha + f \tensor \nabla^V \alpha .
%\een
%\item[(3)] It is square-zero, $(\nabla^V)^2 = 0$. 
%\end{itemize}
%$

\begin{dfn}\label{def desc}
The {\em associated flat vector bundle} to the flat $(\fg,K)$-bundle $P \to X$ and the finite-dimensional $(\fg,K)$-representation $V$ is 
\[
\desc((P\to X),V) := (P \times^K V, \nabla^{P,V}),
\]
namely the associated vector bundle on $X$ and its flat connection.
Its {\em de Rham complex} is
\[
\bdesc((P \to X), V) := \left(\Omega^*(P; \ul{V})_{bas}, \nabla^{P,V}\right),
\]
whose zeroeth cohomology is the horizontal sections of the local system.
\end{dfn}

As the construction of the flat connection $\nabla^{P,V}$ intertwines naturally with maps of $(\fg,K)$-bundles, 
we obtain the following functors.

\begin{dfn}
The {\em $(\fg,K)$-descent functor} is the functor 
\[
\desc: \Loc_{(\fg,K)}^\op \times \Mod^{fin}_{(\fg,K)} \to {\rm VB}_{flat}
\]
sending $(P \to X, V)$ to $(V_X,\nabla^{P,V})$.
There is a closely related functor
\[
\ddesc: \Loc_{(\fg,K)}^\op \times \Mod^{fin}_{(\fg,K)} \to \Mod_{\Omega^*}
\]
sending $(P \to X, V)$ to the de Rham complex of $\desc((P \to X,V))$. 
\end{dfn}

To every flat vector bundle we can associate a local system by taking
the horizontal sections. We denote by $\sdesc$ the
composition of the functor $\desc$ with taking horizontal
sections. Explicitly, $\sdesc$ is the zeroeth cohomology of the de
Rham complex of the flat vector bundle given by descent. In other words, it is
the zeroth cohomology of the complex~$\left(\Omega^*(P;  \ul{V})_{bas}, \nabla^{P,V}\right)$.

In the case of a holomorphic $(\fg, K)$-bundle with flat connection $(P \to X, \omega)$,
the $(0,1)$-component of the connection $\nabla^{P,V}$ agrees with the $\dbar$ operator
\ben
(\nabla^{P,V})^{0,1} = \dbar_P : \Omega^{0} (P; \ul{V})_{bas} \to \Omega^{0,1}(P;\ul{V})_{bas} .
\een
Hence the horizontal sections are also holomorphic. 


\begin{ex}
A special role is played by the $(\fg,K)$-bundles over a point. 
In this case, the only $K$-bundle is trivial, and the composite functor
\[
\begin{array}{ccc}
\Mod_{(\fg,K)}&  \to & \Mod^{dg}_\CC \\
V & \mapsto & \clie^*(\fg,K;V)
\end{array}
\]
agrees with relative cochains computing the relative Lie algebra
cohomology of $V$. 
\end{ex}

\begin{ex} 
Let $K$ be a Lie group and let $\fk$ be its Lie algebra. 
Then $(\fk,K)$ is a HC-pair and we have an equivalence of categories
\ben
\Mod^{fin}_{(\fk,K)} \cong {\rm Rep}^{fin}_K .
\een
Let $P \to X$ be a principal $K$-bundle and $\omega \in \Omega^1(P;\fk)$ a {\em flat} connection (in the traditional sense). 
Then the functor
\ben
\ddesc((P,\omega),-) : {\rm Mod}^{fin}_{(\fk,K)} \to {\rm Mod}_{\Omega^*_X}
\een
is equivalent to the functor ${\rm Rep}_{K}^{fin} \to
\Mod_{\Omega^*_X}$ that sends a $K$-representation $V$ to the de Rham
complex of the associated bundle $V_X = P \times^K V$ equipped with
its induced flat connection, i.e., $V \mapsto \Omega^*(X ; V_X)$.
\end{ex}

\begin{rmk}
\label{descent for infinite dimensional things}
We have described these constructions for finite-dimensional representations,
but they make sense with an infinite-dimensional representation $V$ 
\emph{provided} one knows how smooth manifolds map into $V$.
Given that data, one knows how to write down functions (or differential forms) on $P$ with values in $V$.
In many examples, the vector space $V$ comes equipped with that information.
For instance, every locally convex topological vector space has it,
as do bornological or convenient vector spaces.
A systematic discussion of these issues can be found in \cite{KrieglMichor},
and an overview with close ties to the examples used here can be found in Appendix B of~\cite{CG1}.
\end{rmk}

\subsection{The characteristic map}

Recall that on a principal $K$-bundle $P \to X$ with connection one-form $\omega \in \Omega^1(P,\ul{\Lie(K)})$, 
the one-form provides a linear map $\omega^*: \Lie(K)^* \to \Omega^1(P)$.
If the connection is flat (i.e., satisfies the Maurer-Cartan equation), 
then $\omega^*$ extends to a map of commutative dg algebras
\[
\omega^*: \clie^*(\Lie(K)) \to \Omega^*(P),
\]
which provides some kind of characteristic classes for the flat $K$-bundle $P$.

We now adapt this construction to the Harish-Chandra setting.
In this case, the connection one-form $\omega$ lives in $\Omega^1(P, \ul{\fg})$ and as it is flat,
it provides a map of commutative dg algebras $\omega^*: \clie^*(\fg) \to \Omega^*(P)$.This map admits an important refinement: since $\omega$ is $K$-invariant, it induces a map
\[
\omega^*: \clie^*(\fg,K) \to \Omega^*(P)_{bas}.
\]
This construction extends to associated bundles, so that for $V$ a $(\fg,K)$-module, there is a map
\[
{\rm char}^{P,V} : \clie^*(\fg, K; V) \to \Omega^*(\desc((P,\omega),V)), 
\]
which provides some kind of characteristic classes for flat $(\fg,K)$-bundles.

As these constructions manifestly intertwine with pullbacks of bundles, we have the following.

\begin{dfn}
The {\em characteristic map} is the natural transformation
\[
{\rm char} : \clie^*(\fg,K; -) \Rightarrow \Omega^*(-, \desc(-,-))
\]
between the relative Lie algebra cohomology of a $(\fg,K)$-module and 
the de Rham complex of its associated local system along a flat $(\fg,K)$-bundle .
\end{dfn}

\section{Formal vector bundles and Gelfand-Kazhdan descent}\label{sec
  gk descent}

In this section we review the theory of Gelfand-Kazhdan formal geometry and its use in natural constructions in differential geometry,
organized in a manner somewhat different from the standard
approaches. We emphasize the role of the frame bundle and jet bundles.
We conclude with a treatment of the Atiyah class, which may be our only novel addition (although unsurprising) to the formalism.

We remark that from hereon we will work with complex manifolds and holomorphic vector bundles.
 
\subsection{A Harish-Chandra pair for the formal disk}

Let $\hO_n$ denote the algebra of formal power series 
\ben
\CC \llbracket t_1,\ldots,t_n \rrbracket,
\een 
which we view as ``functions on the formal $n$-disk $\hD^n$.'' 
It is filtered by powers of the maximal ideal $\fm_n = (t_1,\ldots,t_n)$, and it is the limit of the sequence of artinian algebras
\[
\cdots \to \hO_n/(t_1,\ldots,t_n)^k \to \cdots \hO_n/(t_1,\ldots,t_n)^2 \to \hO_n/(t_1,\ldots,t_n) \cong \CC.
\] 
One can use the associated adic topology to interpret many of our constructions, but we will not emphasize that perspective here.

We use $\Vect$ to denote the Lie algebra of derivations of $\hO_n$, which consists of first-order differential operators with formal power series coefficients:
\[
\Vect = \left\{ \sum_{i =1 }^n f_i \frac{\partial}{\partial t_i} \,:\, f_i \in \hO_n\right\}.
\]
The group $\GL_n$ also acts naturally on $\hO_n$: for $M \in \GL_n$ and $f \in \hO_n$,
\[
(M \cdot f)(t) = f (Mt),
\]
where on the right side we view $t$ as an element of $\CC^n$ and let $M$ act linearly.
In other words, we interpret $\GL_n$ as acting ``by diffeomorphisms'' on $\hD^n$ and then use the induced pullback action on functions on $\hD^n$.
The actions of both $\Vect$ and $\GL_n$ intertwine with multiplication of power series, 
since ``the pullback of a product of functions equals the product of the pullbacks.''

\subsubsection{Formal automorphisms}

Let $\Aut_n$ be the group of filtration-preserving automorphisms of the algebra $\hO_n$,
which we will see is a pro-algebraic group.
Explicitly, such an automorphism $\phi$ is a map of algebras that preserves the maximal ideal, 
so $\phi$ is specified by where it sends the generators $t_1$, \dots, $t_n$ of the algebra.
In other words, each $\phi \in \Aut_n$ consists of an $n$-tuple $(\phi_1,\ldots,\phi_n)$ 
such that each $\phi_i$ is in the maximal ideal generated by $(t_1,\ldots,t_n)$ and such that there exists an $n$-tuple $(\psi_1,\ldots,\psi_n)$ 
where the composite
\[
\psi_j(\phi_1(t),\ldots,\phi_n(t)) = t_j
\]
for every $j$ (and likewise with $\psi$ and $\phi$ reversed).
This second condition can be replaced by verifying that the Jacobian matrix
\[
Jac(\phi) = (\partial \phi_i/\partial t_j) \in {\rm Mat}_n(\hO_n)
\]
is invertible over $\hO_n$, by a version of the inverse function theorem.

Note that this group is far from being finite-dimensional, so it does not fit immediately into the setting of HC-pairs described above. 
It is, however, a {\em pro}-Lie group in the following way. 
As each $\phi \in \Aut_n$ preserves the filtration on $\hO_n$, it induces an automorphism of each partial quotient $\hO_n/\fm_n^k$.
Let $\Aut_{n,k}$ denote the image of $\Aut_n$ in $\Aut(\hO_n/\fm_n^{k+1})$; this group $\Aut_{n,k}$ is clearly a quotient of $\Aut_n$.
Note, for instance, that $\Aut_{n,1} = \GL_n$.
Explicitly, an element $\phi$ of ${\rm Aut}_{n,k}$ is the collection of $n$-tuples $(\phi_1,\ldots,\phi_n)$ 
such that each $\phi_i$ is an element of $\fm_n/\fm_n^{k+1}$ and such that the Jacobian matrix $Jac(\phi)$ is invertible in $\hO_n/\fm_n^{k+1}$.
The group ${\rm Aut}_{n,k}$ is manifestly a finite dimensional Lie group, as the quotient algebra is a finite-dimensional vector space. 
 
The group of automorphisms $\Aut_n$ is the pro-Lie group associated with the natural sequence of Lie groups
\ben
\cdots \to \Aut_{n,k} \to \Aut_{n,k-1} \to \cdots \to \Aut_{n,1} = \GL_n.
\een
Let $\Aut_n^+$ denote the kernel of the map $\Aut_n \to \GL_n$ so that we have a short exact sequence
\ben
1 \to \Aut_n^+ \to \Aut_n \to \GL_n \to 1 .
\een
In other words, for an element $\phi$ of $\Aut_n^+$, each component
$\phi_i$ is of the form $t_i + \cO(t^2)$. The group $\Aut_n^+$ is
pro-nilpotent, hence contractible. 

The Lie algebra of $\Aut_n$ is {\em not} the Lie algebra of formal
vector fields $\Vect$. A direct
calculation shows that the Lie algebra of $\Aut_n$ is the Lie algebra $\Vectz \subset \Vect$ of formal vector fields with zero constant coefficient (i.e., that vanish at the origin of $\hD^n$). 

Observe that the group $\GL_n$ acts on the Lie algebra $\Vect$ by the obvious linear ``changes of frame.''
The Lie algebra $\Lie({\GL_n}) = \fgl_n$ sits inside $\Vect$ as the linear vector fields
\ben
\left\{\sum_{i,j} a^j_i t_i \frac{\partial}{\partial t_j} \; : \; a^{i}_j \in \CC \right\}.
\een 
We record these compatibilities in the following statement.

\begin{lemma} 
The pair $(\Vect, \GL_n)$ form a Harish-Chandra pair.
\end{lemma}
\begin{proof} The only thing to check is that the differential of the
  action of $\GL_n$ corresponds with the adjoint action of $\fgl_n
  \subset \Vect$ on formal vector fields. This is by construction. 
\end{proof}

\subsection{The coordinate bundle}

In this section we review the central object in the Gelfand-Kazhdan
picture of formal geometry: the coordinate bundle.

%Our version of Harish-Chandra localization is intimately related to, and motivated by, the methods of formal geometry developed by Gelfand, Fuchs, Kazhdan, and many others \brian{refs}. 
%It has been used prominently in the setting of deformation quantization, notably by Kontsevich \brian{ref}, Nest-Tsygan \brian{ref}, Cattaneo-Felder \brian{ref}, and \brian{more}. 
%Here we start by reviewing the big picture before delving into some precise definitions and summarizing the relevant results from the literature.

\subsubsection{}

Given a complex manifold, its {\em coordinate space} $X^{coor}$ is the (infinite-dimensional) space parametrizing holomorphic formal coordinate systems of $X$. 
(It is a pro-complex manifold, as we'll see.) 
Explicitly, a point in $X^{coor}$ consists of a point $x \in X$ 
together with an isomorphism of completed commutative algebras 
\[
\phi: \sO_{X,x}^\wedge \to \CC[[t_1,\ldots,t_n]] = \hO_n,
\]
where $\sO_{X,x}^\wedge$ denotes the completion $\lim_{\leftarrow} \sO_{X,x}/\fm_x^k$ of the germ at $x$ of holomorphic functions with respect to powers of the ideal $\fm_x$ of functions vanishing at~$x$. \si 
Intuitively, $\phi$ corresponds to an embedding of the formal disk into $X$, sending the base point to~$x$.

There is a canonical projection map $\pi^{coor} : X^{coor} \to X$ by remembering only the underlying point in $X$. 
The group $\Aut_n$ acts on $X^{coor}$ by ``change of coordinates," 
i.e., by precomposing a  $\phi$ with an automorphism of the disk around the origin in $\CC^n$.
This action identifies $\pi^{coor}$ as a principal bundle for the pro-Lie group $\Aut_n$. 

One way to formalize these ideas is to realize $X^{coor}$ as a limit of finite-dimensional complex manifolds. 
Let $X_k^{coor}$ be the space consisting of points $(x, [\phi]_k)$, 
where $\phi$ is a formal holomorphic coordinate system, as above, and $[-]_k$ denotes the projection on $\CC[[[t_1,\ldots,t_n]]/(t_1,\ldots,t_n)^{k+1}$. 
Let $\pi_k^{coor} : X^{coor}_k \to X$ be the projection. 
By construction, the finite-dimensional complex Lie group $\Aut_{n,k}$ acts on the fibers of the projection freely and transitively 
so that $\pi_k^{coor}$ is a holomorphic principal $\Aut_{n,k}$-bundle. The bundle $X^{coor} \to X$ is the limit of the sequence of holomorphic principal bundles on X
\ben
\xymatrix{
\cdots \ar[r] & X^{coor}_k \ar[r] \ar[drrrr]_-{\pi_k^{coor}} & X^{coor}_{k-1} \ar[drrr]^-{\pi_{k-1}^{coor}} \ar[r] & \cdots \ar[r] & X_2^{coor} \ar[dr]^{\pi_2^{coor}} \ar[r] & X_1^{coor} \ar[d]^-{\pi_1^{coor}} \\ 
 & & & & & X .
}
\een
In particular, note that the $\GL_n = \Aut_{n,1}$-bundle $\pi_1^{coor} : X^{coor}_1 \to X$ is the frame bundle
\ben
\pi^{fr} : {\rm Fr}_X \to X,
\een
i.e., the principal bundle associated to the holomorphic tangent bundle of $X$.

\subsubsection{The Grothendieck connection} 

We can also realize the Lie algebra $\Vect$ as an inverse limit. 
Recall the filtration on $\Vect$ by powers of the maximal ideal $\fm_n$ of $\hO_n$. 
Let ${\rm W}_{n,k}$ denote the quotient $\Vect / \fm_n^{k+1} \Vect$. 
For instance, ${\rm W}_{n,1} = \mathfrak{aff}_n = \CC^n \ltimes \fgl_n$, the Lie algebra of affine transformations of $\CC^n$. 
We have $\Vect = \lim_{k \to \infty} {\rm W}_{n,k}$. 

The Lie algebra of $\Aut_{n,k}$ is
\[
{\rm W}_{n,k}^0 := \fm_n \cdot \Vectz /\fm_n^{k+1} \Vectz .
\]
That is, the Lie algebra of vector fields vanishing at zero modulo the $(k+1)$th power of the maximal ideal. Thus, the principal $\Aut_{n,k}$-bundle $X_{k}^{coor} \to X$ induces an exact sequence of holomorphic tangent spaces
\ben
{\rm W}_{n,k}^0 \to T_{(x,[\varphi]_k)}X^{coor} \to T_x X;
\een
by using $\varphi$, we obtain a canonical isomorphism of tangent spaces $\CC^n \cong T_0 \CC^n \cong T_x X$. Combining these observations, we obtain an isomorphism
\ben
{\rm W}_{n,k} \cong T_{(x,[\varphi]_k)} X^{coor}_k .
\een
In the limit $k \to \infty$ we obtain an isomorphism $\Vect \cong T_{(x,[\varphi]_\infty)} X^{coor}$ at each point.
These isomorphisms glue together to give the following. \si

\begin{dfn}
Let
\ben
\theta : \Vect \to \cX^{hol}(X^{coor}) .
\een
denote the Lie algebra morphism encoding the canonical action of $\Vect$ on $X^{coor}$ by
holomorphic vector fields.
(See Section 5 of \cite{NT} and Section 3 of \cite{CF2} for further discussions of this kind of construction.)
\end{dfn}

The inverse of the map $\theta$ provides a connection one-form
\ben
\omega^{coor} \in \Omega^1_{hol}(X^{coor}; \Vect),
\een
which we call the {\em universal Grothendieck connection} on $X$. 
As $\theta$ is a Lie algebra homomorphism, $\omega^{coor}$ satisfies the Maurer-Cartan equation
\be\label{mc}
\partial \omega^{coor} + \frac{1}{2} [\omega^{coor},\omega^{coor}] = 0 .
\ee
Note that the proposition ensures that this connection is universal on all complex manifolds of dimension $n$ 
and indeed pulls back along local biholomorphisms.

\begin{rmk} 
Both the pair $(\Vect, \Aut_n)$ and the bundle $X^{coor} \to X$ together
with $\omega^{coor}$ do not fit in our model for general
Harish-Chandra descent above. 
They are, however, objects in a larger category of pro-Harish-Chandra pairs and pro-Harish-Chandra bundles, respectively. 
We do not develop this theory here, but it is inherent in the work of~\cite{BK}.  
Indeed, by working with well-behaved representations for the pair $(\Vect,\Aut_n)$, 
Gelfand, Kazhdan, and others use this universal construction to produce many of the natural constructions in differential geometry.
As we remarked earlier, it is a kind of refinement of tensor calculus.
\end{rmk}

\subsubsection{A Harish-Chandra structure on the frame bundle}

\def\Sect{{\rm Sect}}
\def\Fr{{\rm Fr}}
\def\Exp{{\rm Exp}}

Although the existence of the coordinate bundle
$X^{coor}$ is necessary in the remainder of this paper, it is convenient for us to use it in a rather
indirect way. Rather, we will work with the frame bundle ${\rm Fr}_X \to X$ equipped with the structure of a module for the Harish-Chandra pair $(\Vect, \GL_n)$. 
The $\Vect$-valued connection on $\Fr_X$ is induced from the Grothendieck connection above.

\si

\begin{dfn}\label{fmlexp} 
Let $\Exp (X)$ denote the quotient $X^{coor} / \GL_n$. 
A $C^\infty$-section of $\Exp(X)$ over $X$ is called a {\em formal exponential}. 
\end{dfn}

\begin{rmk} 
\si
Following Section 4 of \cite{kapranov1999}, we can realize $\Exp (X)$ as the inverse limit of finite dimensional manifolds $\Exp_k (X) = X^{coor}_k / \GL_n$.
Moreover, we can equip $\Exp(X)$ with the structure of a principal $\Aut_n^+$-bundle over $X$ in the following way.
Consider the short exact sequence of pro-Lie groups
\ben
1 \to \Aut_n^+ \to \Aut_n \to \GL_n \to 1 .
\een
There is a splitting of this determined by the choice of coordinates on the formal disk which exhibits an isomorphism
\[
\Aut_n = \Aut_{n}^+ \rtimes \GL_n 
\] 
and a bijection of {\em sets} $q : \Aut_n^+ \xto{\cong} \Aut_n / \GL_n$. 

Further, there is an action of $\Aut_n$ on $\Aut_n^+$ defined by
\[
f \cdot p := Jac(f) \circ p \circ Jac(f)^{-1}
\]
which makes $q$ a $\Aut_n$-equivariant isomorphism. 
Using this isomorphism, we equip $X^{coor} / \GL_n$ with the desired $\Aut_n^+$ structure.
\end{rmk}

Note that $\Aut_n^+$ is contractible, and so smooth sections always exist. 
A formal exponential is useful because it equips the frame bundle with a $(\Vect,\GL_n)$-module structure, as follows.

%The space of formal exponentials is the (infinite dimensional) affine space $\Sect_X(\Exp_X^\infty)$. Unraveling the definition, such a section $\sigma$ of $X^{aff}$ is an $\infty$-jet equivalence class of a local diffeomorphism
%\ben
%\sigma_x : T_x X \to X
%\een
%for each $x \in X$ such that
%\begin{itemize}
%\item[(i)] $\sigma_x(0) = x$
%\item[(ii)]\label{exp2} The derivative at $0$ of $\sigma_x$ is the identity $D (\sigma)_0 = {\rm id} : T_x X \to T_x X$. 
%\end{itemize}
% 
%\begin{rmk} In \brian{Cattaneo-Felder, more} this bundle is denoted $X^{aff} \to X$ and is called the affine bundle. 
%\end{rmk}

\begin{prop} \label{gauge equiv}
A formal exponential $\sigma$ pulls back to a $\GL_n$-equivariant map $\tilde{\sigma} : \Fr_X \to X^{coor}$,
and hence equips $(\Fr_x, \sigma^* \omega^{coor})$ with the structure
of a principal $(\Vect,\GL_n)$-bundle with flat connection.
Moreover, any two choices of formal exponential determine $(\Vect,\GL_n)$-structures on $X$ that are gauge-equivalent. 
\end{prop}

For a full proof, see \cite{NT}, \cite{nest1995}, or \cite{khors} but the basic idea is easy to explain.

\begin{proof}[Sketch of proof]
The first assertion is tautological, since the data of a section is equivalent to such an equivariant map, but we explicate the underlying geometry.
A map $\rho : \Fr_X \to X^{coor}$ assigns to each pair  $(x, \mathbf{y}) \in \Fr_X$,
with $x \in X$ and $\mathbf{y} : \CC^n \xto{\cong} T_x X$ a linear frame,
an $\infty$-jet of a biholomorphism $\phi: \CC^n \to X$ such that $\phi(0) = x$ and $D\phi(0) = \mathbf{y}$.
Being $\GL_n$-equivariant ensures that these biholomorphisms are related by linear changes of coordinates on $\CC^n$.
In other words, a $\GL_n$-equivariant map $\tilde{\sigma}$ describes how each frame on $T_x X$ exponentiates to a formal coordinate system around $x$,
and so the associated section $\sigma$ assigns a formal exponential map $\sigma(x) \colon T_x X \to X$ to each point $x$ in $X$.
(Here we see the origin of the name ``formal exponential.'')

The second assertion would be immediate if $X^{coor}$ were a complex manifold, since the flat bundle structure would pull back,
so all issues are about carefully working with pro-manifolds.

The final assertion is also straightforward: the space of sections is contractible since $\Aut_n^+$ is contractible, 
so one can produce an explicit gauge equivalence.
\end{proof}
 
\begin{rmk} 
In \cite{willwacher} Willwacher provides a description of the space $\Exp(X)$ of {\em all} formal exponentials. He shows that it is isomorphic to the space of pairs $(\nabla_0, \Phi)$
where $\nabla_0$ is a torsion-free connection on $X$ for $T_X$ and $\Phi$ is a section of the bundle
\ben
\Fr_X \times_{\GL_n} {\rm W}_n^3
\een
where ${\rm W}_n^3 \subset \Vect$ is the subspace of formal vector fields whose coefficients are at least cubic. 
In particular, every torsion-free affine connection determines a formal exponential. The familiar case above that produces a formal coordinate from a connection corresponds to choosing the zero vector field. 
\end{rmk}

%Given a formal exponential $\sigma$ we now construct a formal vector field valued connection one-form $\omega^\sigma \in \Omega^1(\Fr_X; \Vect)$ satisfying the Maurer-Cartan equation. Hence, a $(\Vect,\GL_n)$-structure on $\Fr_X$. 
%
%Let $(x, \mathbf{y}) \in \Fr_X$. Define $\omega^\sigma_{(x, \mathbf{y})} : T_{(x, \mathbf{y})} \Fr_X \to \Vect$
%as the composition 
%\ben
%\xymatrix{
%T_{(x, \mathbf{y})} \Fr_X \ar[r]^-{D \sigma} & T_{(x, \sigma(\mathbf{y}))} X^{coor} \ar[r]^-{\omega^{coor}} & \Vect .
%}
%\een 
%This defines $\omega^\sigma \in \Omega^1(\Fr_X; \Vect)$. The fact that $\omega^\sigma$ is $\GL_n$-invariant follows from the fact that $D \sigma|_0$ is the identity. 
%
%\brian{MC equation, gauge equivalence for different choices of splitting}

\begin{dfn}
A {\em Gelfand-Kazhdan structure} on the frame bundle $\Fr_X\to X$ of a complex manifold $X$ of dimension $n$ is a formal exponential $\sigma$, 
which makes $\Fr_X$ into a flat $(\Vect,\GL_n)$-bundle with connection one-form $\omega^\sigma$, 
the pullback of $\omega^{coor}$ along the $\GL_n$-equivariant lift $\tilde{\sigma} : \Fr_X \to X^{coor}$.
\end{dfn}

\begin{ex} 
Consider the case of an open subset $U \subset \CC^n$. 
There are thus natural holomorphic coordinates $\{z_1,\ldots,z_n\}$ on $U$. 
These coordinates provides a natural choice of a formal exponential. 
Moreover, with respect to the isomorphism
\ben
\Omega^1_{hol}(\Fr_U ; \Vect)^{\GL_n} \cong \Omega^1_{hol}(U ; \Vect),
\een
we find that the connection 1-form has the form
\ben
\omega^{coor} = \sum_{i=1}^n \d z_i \tensor \frac{\partial}{\partial t_i},
\een 
where the $\{t_i\}$ are the coordinates on the formal disk $\hD^n$.
\end{ex} 

A Gelfand-Kazhdan structure allows us to apply a version of Harish-Chandra descent, which will be a central tool in our work.

Although we developed Harish-Chandra descent on all flat $(\fg,K)$-bundles, 
it is natural here to restrict our attention to manifolds of the same dimension,
as the notions of coordinate and affine bundle are dimension-dependent.
Hence we replace the underlying category of all complex manifolds by a more restrictive setting.

\begin{dfn}
Let $\Hol_n$ denote the category whose objects are complex manifolds of dimension $n$ and whose morphisms are local biholomorphisms.
In other words, a map $f: X \to Y$ in $\Hol_n$ is a map of complex manifolds such that each point $x \in X$ admits a neighborhood $U$ on which $f|_U$ is biholomorphic with $f(U)$.
\end{dfn}

There is a natural inclusion functor $i : \Hol_n \to {\rm CplxMan}$ (not fully faithful) and the frame bundle $\Fr$ defines a section of the fibered category $i^*\VB$,
since the frame bundle pulls back along local biholomorphisms.
For similar reasons, the coordinate bundle is a pro-object in $i^*\VB$.

\begin{dfn}
Let $\GK_n$ denote the category fibered over $\Hol_n$ whose objects are a Gelfand-Kazhdan structure 
--- that is, a pair $(X, \sigma)$ of a complex $n$-manifold and a formal exponential ---
and whose morphisms are simply local biholomorphisms between the underlying manifolds.
\end{dfn}

Note that the projection functor from $\GK_n$ to $\Hol_n$ is an equivalence of categories, since the space of formal exponentials is affine.

\subsection{The category of formal vector bundles}

For most of our purposes, it is convenient and sufficient to work with a small category of $(\Vect,\GL_n)$-modules 
that is manifestly well-behaved and whose localizations appear throughout geometry in other guises, 
notably as $\infty$-jet bundles of vector bundles on complex manifolds.
(Although it would undoubtedly be useful, we will not develop here the general theory of modules for the Harish-Chandra pair $(\Vect,\GL_n)$, 
which would involve subtleties of pro-Lie algebras and their representations.)

We first start by describing the category of $(\Vect, \GL_n)$-modules
that correspond to modules over the structure sheaf of a manifold. Note that $\hO_n$ is the quintessential example of a commutative algebra object in the symmetric monoidal category of $(\Vect,\GL_n)$-modules, 
for any natural version of such a category. We consider modules that
have actions of both the pair and the algebra $\hO_n$ with obvious
compatibility restrictions. 

\begin{dfn} A {\em formal $\hO_n$-module} is a
  vector space $\cV$ equipped with
\begin{itemize}
\item[(i)] the structure of a $(\Vect, \GL_n)$-module;
\item[(ii)] the structure of a $\hO_n$-module;
\end{itemize}
such that 
\begin{itemize}
\item[(1)] for all $X \in \Vect$, $f \in \hO_n$ and $v \in \cV$ we
  have $X(f \cdot v) = X(f) \cdot v + f \cdot (X \cdot v)$;
\item[(2)] for all $A \in \GL_n$ we have $A (f \cdot v) = (A \cdot f) \cdot (A \cdot v)$,  where $A$ acts on $f$ by a linear change of frame.
\end{itemize}
A morphism of formal $\hO_n$-modules is a $\hO_n$-linear map of
$(\Vect, \GL_n)$-modules $f : \cV \to \cV'$. We denote this category
by $\Mod_{(\Vect, \GL_n)}^{\cO_n}$. 
\end{dfn}

It is useful to bear in mind that such an object is much like a vector bundle equipped with a flat connection,
due to the action of vector fields by derivations.
More properly this category behaves much like $D$-modules (i.e., modules over the ring $D$ of differential operators).
For instance, just as the category of $D$-modules is symmetric monoidal via tensor over $\cO$, we have the following result.

\begin{lemma}
The category $\Mod^{\cO_n}_{(\Vect, \GL_n)}$ is symmetric monoidal with respect to tensor over $\hO_n$.
\end{lemma} 

\begin{proof}
The category of $\hO_n$-modules is clearly symmetric monoidal by tensoring over $\hO_n$. We simply need to verify that the Harish-Chandra module structures extend in a natural way, but this is clear.
\end{proof}

We will often restrict ourselves to considering Harish-Chandra modules as above that are free as underlying $\hO_n$-modules. 
Indeed, let
\ben
\VB_n \subset \Mod_{(\Vect, \GL_n)}^{\cO_n}
\een
be the full subcategory spanned by objects that are free and finitely generated as underlying $\hO_n$-modules, \si
so we refer to this category as {\em formal vector bundles}.

The category of formal $\hO_n$-modules has a natural symmetric monoidal structure by tensor product over~$\hO$. The Harish-Chandra action is extended by
\[
X \cdot (s \otimes t) = (X s) \otimes t + s \otimes (Xt). 
\]
This should not look surprising; it is the same formula for tensoring
$D$-modules over~$\cO$. 

The internal hom $\Hom_{\hO}(\cV,\cW)$ also provides a vector bundle on the formal disk, 
where the Harish-Chandra action is extended by
\[
(X \cdot \phi)(v) = X \cdot (\phi(v)) - \phi(X\cdot v). 
\]
Observe that for any $D$-module $M$, we have an isomorphism
\[
\Hom_{D}(\hO, M) \cong \Hom_{\Vect}(\CC, M)
\]
since a map of $D$-modules out of $\hO$ is determined by where it sends the constant function~1. 
Hence we find that there is a quasi-isomorphism 
\[
\RR\Hom_{D}(\hO, \cV) \simeq \clie^*(\Vect ; \cV),
\]
or more accurately a zig-zag of quasi-isomorphisms. Here
$\clie^*(\Vect ; \cV)$ is the continuous cohomology of $\Vect$ with
coefficients in $\cV$. This is known as the {\em Gelfand-Fuks}
cohomology of $\cV$ and is what we use for the remainder of the
paper. 

This relationship extends to the $\GL_n$-equivariant setting as well, giving us the following result.

\begin{lemma}
There is a quasi-isomorphism
\[
\clie^*(\Vect,\GL_n; \cV) \simeq \RR \Hom_D(\hO,\cV)^{\GL_n-{\rm eq}},
\]
where the superscript $\GL_n-{\rm eq}$ denotes the $\GL_n$-equivariant maps.
\end{lemma}

\begin{rmk}
One amusing way to understand this category is as Harish-Chandra descent to the formal $n$-disk itself. 
Consider the frame bundle $\widehat{\Fr} = \hD^n \times \GL_n \to \hD^n$ of the formal $n$-disk itself, 
which possesses a natural flat connection via the Maurer-Cartan form $\omega_{MC}$ on $\GL_n$. 
Let $\rho: \GL_n \to \GL(V)$ be a finite-dimensional representation. 
Then the subcomplex of $\Omega^*(\widehat{\Fr})\otimes V$ given by the basic forms is isomorphic to
\[
\left(\Omega^*(\hD^n) \otimes V, \d_{dR} + \rho(\omega_{MC}) \right).
\]
This equips the associated bundle $\widehat{\Fr}\times^{\GL_n} V$ with a flat connection and 
hence makes its sheaf of sections a $D$-module on the formal disk.
\end{rmk}

Many of the important $\hO_n$-modules we will consider simply come from linear tensor representations of $\GL_n$. 
Given a finite-dimensional $\GL_n$-representation $V$, we construct a $\hO_n$-module $\cV \in \VB_n$ as follows. 

Consider the decreasing filtration of $\Vect$ by vanishing order of jets 
\ben
\cdots \subset \fm^{2}_n \cdot {\rm W}_{n} \subset \fm^1_n \cdot {\rm W}_n \subset {\rm W}_n .
\een 
The induced map $\fm_n^1 \cdot \Vect \to \fm_n^1 \cdot \Vect / \fm_n^2
\cdot \Vect \cong \fgl_n$ allows us to restrict $V$ to a $(\fm_n^1 \cdot
\Vect)$-module. 
We  then coinduce this module along the inclusion $\fm^1 \cdot \Vect
\subset \Vect$ to get a $\Vect$-module $\cV = \Hom_{\fm_n^1 \cdot \Vect}(U(\Vect),V)$. 
There is an induced action of $\GL_n$ on $\cV$. Indeed, as a $\GL_n$-representation one has $\cV \cong \hO_n \tensor_{\CC} V$.
Moreover, this action is compatible with the $\Vect$-module structure, so that $\cV$ is actually a $(\Vect, \GL_n)$-module. 
Thus, the construction provides a functor  from $\Rep_{\GL_n}$ to
$\VB_n$.

\begin{dfn} 
We denote by $\Tens_n$ the image of finite-dimensional $\GL_n$-representations in $\VB_n$ along this functor. 
We call it the category of {\em formal tensor fields}.
\end{dfn}

As mentioned $\hO_n$ is an example, associated to the trivial one-dimensional $\GL_n$ representation.
Another key example is $\hT_n$, the vector fields on the formal disk, which is associated to the defining $\GL_n$ representation $\CC^n$; 
it is simply the adjoint representation of $\Vect$.
Other examples include $\hOmega^1_n$, the 1-forms on the formal disk; it
is the correct version of the coadjoint representation, and more
generally the space of $k$-forms on the formal disk $\hOmega^k_n$. 

The category $\Tens_n$ can be interpreted in two other ways, as we will see in subsequent work.
\begin{enumerate}
\item They are the $\infty$-jet bundles of tensor bundles: for a finite-dimensional $\GL_n$-representation, 
construct its associated vector bundle along the frame bundle and take its $\infty$-jets.
\item They are the flat vector bundles of finite-rank on the formal $n$-disk that are equivariant with respect to automorphisms of the disk. 
In other words, they are $\GL_n$-equivariant $D$-modules whose underlying $\hO$-module is finite-rank and free.
\end{enumerate}
It should be no surprise that given a Gelfand-Kazhdan structure on the frame bundle of a non-formal $n$-manifold $X$, 
a formal tensor field descends to the $\infty$-jet bundle of the corresponding tensor bundle on $X$. 
The flat connection on this descent bundle is, of course, the Grothendieck connection on this $\infty$-jet bundle. 
(For some discussion, see section 1.3, pages 12-14, of \cite{Fuks}.)

Note that the subcategories 
\ben
\Tens_n \hookrightarrow \VB_n
\hookrightarrow \Mod_{(\Vect, \GL_n)}^{\cO_n}
\een
inherit the symmetric monoidal structure constructed above. 

\subsection{Gelfand-Kazhdan descent}

We will focus on defining descent for the category $\VB_n$ of formal vector
bundles. 

Fix an $n$-dimensional manifold $X$.
The main result of this section is that the associated bundle construction along the frame bundle $\Fr_X$,
\[
\begin{array}{cccc}
\Fr_X \times^{\GL_n} - :&  \Rep(\GL_n)^{fin} & \to &\VB(X)\\
& V & \mapsto & \Fr_X \times^{\GL_n} V
\end{array},
\]
which builds a tensor bundle from a $\GL_n$ representation, arises from Harish-Chandra descent for $(\Vect,\GL_n)$. 
This result allows us to equip tensor bundles with interesting structures (e.g., a vertex algebra structure) by working $(\Vect,\GL_n)$-equivariantly on the formal $n$-disk.
In other words, it reduces the problem of making a universal
construction on all $n$-manifolds to the problem of making an
equivariant construction on the formal $n$-disk,
since the descent procedure automates extension from the formal to the global.

Note that every formal vector bundle $\cV \in \WGLCAT$ is naturally filtered via a filtration inherited from $\hO_n$. 
Explicitly, we see that $\cV$ is the limit of the sequence of finite-dimensional vector spaces
\[
\cdots \to \hO_n/\fm_n^k \otimes V \to \cdots \to \hO_n/\fm_n \otimes V \cong V
\]
where $V$ is the underlying $\GL_n$-representation.
Each quotient $\hO_n/\fm_n^k \otimes V$ is a module over $\Aut_{n,k}$, and 
hence determines a vector bundle on $X$ by the associated bundle construction along $X^{coor}_k$.
In this way, $\cV$ produces a natural sequence of vector bundles on $X$ and thus a pro-vector bundle on $X$.

Given a formal exponential $\sigma$ on $X$, we obtain a $\GL_n$-equivariant map from $\Fr_X$ to $X^{coor}_k$ for every $k$,
by composing the projection map $X^{coor} \to X_k^{coor}$ with the $\GL_n$-equivariant map from $\Fr_X$ to $X^{coor}$.

\begin{dfn}
{\em Gelfand-Kazhdan descent} is the functor
\[
\desc_\GK: \GK_n^\op \times \WGLCAT \to \Pro(\VB)_{flat}
\]
sending $(\Fr_X,\sigma)$ --- a frame bundle with formal exponential
--- and a formal vector bundle $\cV$ 
to the pro-vector bundle $\Fr_X \times^{\GL_n} \cV$ with flat connection induced by the Grothendieck connection.
\end{dfn}

This functor is, in essence, Harish-Chandra descent, but in a slightly exotic context.
It has several nice properties.

\begin{lemma}\label{prop lax}
For any choice of Gelfand-Kazhdan structure $(\Fr_X,\sigma)$, the descent functor $\desc_\GK((\Fr_X,\sigma),-)$ is lax symmetric monoidal.
\end{lemma}

\begin{proof}
For every $\cV,\cW$ in $\WGLCAT$, we have natural maps
\[
(\Omega^*(\Fr_X) \otimes \cV)_{basic} \otimes (\Omega^*(\Fr_X) \otimes \cW)_{basic} \to (\Omega^*(\Fr_X) \otimes (\cV \otimes \cW))_{basic} \to (\Omega^*(\Fr_X) \otimes (\cV \otimes_{\hO_n} \cW))_{basic}
\]
and the composition provides the natural transformation producing the lax symmetric monoidal structure.
\end{proof}

In particular, we observe that the de Rham complex of $\desc_\GK((\Fr_X,\sigma),\hO_n)$ is a commutative algebra object in $\Omega^*(X)$-modules. 
As every object of $\WGLCAT$ is an $\hO_n$-module and the morphisms are $\hO_n$-linear, 
we find that descent actually factors through the category of $\desc_\GK((\Fr_X,\sigma),\hO_n)$-modules. 
In sum, we have the following.

\begin{lemma}
The descent functor $\desc_\GK((\Fr_X,\sigma),-)$ factors as a composite
\[
\VB_n \xto{\widetilde{\desc}_\GK((\Fr_X,\sigma),-)} \Mod_{\desc_\GK((\Fr_X,\sigma),\hO_n)} \xto{\txt{forget}} \VB_{flat}(X)
\]
and the functor $\widetilde{\desc}_\GK((\Fr_X,\sigma),-)$ is symmetric monoidal.
\end{lemma}

As before, we let $\sdesc_{\GK}$ denote the associated local system
obtained from $\desc_{\GK}$ by taking horizontal sections. This
functor is well-known: it recovers the tensor bundles on $X$.

If $E \to X$ is a holomorphic vector bundle on $X$ we denote by
$J_{hol}^\infty(E)$ the holomorphic $\infty$-jet bundle of $E$. If
$E_0$ is the fiber of $E$ over a point $x \in X$, then the fiber of
this pro-vector bundle over $x$ can be identified with
\ben
J_{hol}^\infty (E)|_{x} \cong E_0 \times \CC \ll t_1,\ldots,t_n\rr .
\een
This pro-vector bundle has a canonical flat connection.

\begin{prop}
For $\cV \in \VB_n$ corresponding to the $\GL_n$-representation $V$,
there is a natural isomorphism of flat pro-vector bundles
\[
\desc_\GK((\Fr(X),\omega^\sigma),\cV) \cong J_{hol}^\infty(\Fr_X
\times^{\GL_n} V)
\]
In other words, the functor of descent along the frame bundle is
naturally isomorphic to the functor of taking $\infty$-jets of the associated bundle construction.
\end{prop} 

As a corollary, we see that the associated sheaf of flat sections is
\ben
\sdesc_{\GK}(\omega^\sigma, \cV) \cong \Gamma_{hol}(\Fr_X
\times^{\GL_n} V)
\een
where $\Gamma_{hol}(-)$ denotes the space of holomorphic sections. 

In other words, Gelfand-Kazhdan descent produces every tensor bundle. 
For example, for the defining representation $V = \CC^n$ of $\GL_n$, we have $\cV =\hT_n$, 
i.e., the vector fields on the formal disk viewed as the adjoint representation of  $\Vect$. 
Under Gelfand-Kazhdan descent, it produces the tangent bundle ${\rm T}$ on $\Hol_n$.

%\begin{rmk}
%It will be convenient for us to enlarge this category $\VB_n$ by adjoining countable direct sums and direct products. Denote this larger category by $\Hat{\VB}_n$. 
%This enlargement will allow us to describe the vertex algebras in this
%setting of formal geometry.
%\end{rmk}

\subsection{Formal characteristic classes}

\subsubsection{Recollection}

In \cite{atiyah}, Atiyah examined the obstruction --- which now bears his name --- to equipping a holomorphic vector bundle with a holomorphic connection from several perspectives. To start, as he does, we take a very structural approach. He begins by constructing the following sequence of vector bundles (see Theorem 1).

\begin{dfn}
Let $G$ be a complex Lie group. Let $E \to X$ be a holomorphic vector
bundle on a complex manifold and $\cE$ its sheaf of sections. The {\em Atiyah sequence} of $E$ is the
exact sequence holomorphic vector bundles given by
\[
0 \to E \tensor T^* X \to J^1(E) \to E \to 0,
\]
where $J^1(E)$ the bundle of {\em first-order} jets of $E$
The {\em Atiyah class} is the element $\At(E) \in {\rm H}^1(X, \Omega^1_X
\tensor \End_{\cO_X} (\cE))$ associated to the extension above. 
\end{dfn}

\begin{rmk}
Taking linear duals we see tha above short exact sequence is
equivalent to one of the form
\ben
0 \to \End (E) \to {\rm A}(E) \to T X \to 0
\een
where ${\rm A}(E)$ is the so-called {\em Atiyah bundle} associated to $E$. 

We should remark that the sheaf $\cA(E)$ of holomorphic sections of the Atiyah bundle ${\rm A}(E)$ is a Lie algebra by borrowing the Lie bracket on vector fields.
By inspection, the Atiyah sequence of sheaves (by taking sections) is a sequence of Lie algebras; 
 in fact, $\cA(E)$ is a central example of a Lie algebroid, as the quotient map to vector fields $\cT_X$ on $X$ is an anchor map.
\end{rmk}

Atiyah also examined how this sequence relates to the Chern theory of connections.

\begin{prop} 
A {\em holomorphic connection} on $E$ is a splitting of the Atiyah sequence (as holomorphic vector bundles).
\end{prop}

Atiyah's first main result in the paper is the following.

\begin{prop}[Theorem 2, \cite{atiyah}]
A holomorphic connection exists on $E$ if and only if the Atiyah class $\At(E)$ vanishes.
\end{prop}

He observes immediately after this statement that the construction is
functorial in maps of bundles. Later, he finds a direct connection
between the Atiyah class and the curvature of a smooth connection. A
smooth connections always exists (i.e., the sequence splits as smooth
vector bundles, not necessarily holomorphically), and one is free to
choose a connection such that the local 1-form only has
Dolbeault type $(1,0)$, i.e., is an element in $\Omega^{1,0}(X; \End(E))$. In that case, the $(1,1)$-component
$\Theta^{1,1}$ of the curvature $\Theta$ is a 1-cocycle in the
Dolbeault complex $(\Omega^{1,*}(X ; \End(E)), \overline{\partial})$ for $\End(E)$ and its cohomology class $[\Theta^{1,1}]$ is the Atiyah class $\At(E)$. In consequence, Atiyah deduces the following.

\begin{prop}
For $X$ a compact K\"ahler manifold, the $k$th Chern class $c_k(E)$ of $E$ is given by the cohomology class of $(2\pi i)^{-k} S_k(\At(E))$, 
where $S_k$ is the $k$th elementary symmetric polynomial, and hence only depends on the Atiyah class.
\end{prop}

This assertion follows from the degeneracy of the Hodge-to-de Rham
spectral sequence. More generally, the term $(2\pi i)^{-k}
S_k(\At(E))$ agrees with the image of the $k$th Chern class in the
Hodge cohomology $H^k(X ; \Omega^k_{hol})$.

The functoriality of the Atiyah class means that it makes sense not just on a fixed complex manifold, but also on the larger sites $\Hol_n$ and $\GK_n$. 
We thus immediately obtain from Atiyah the following notion.

\begin{dfn}
For each $V \in \vb(\Hol_n)$, the {\em Atiyah class} $\At(V)$ is the equivalence class of the extension of the tangent bundle $T$ by $\End(V)$ given by the Atiyah sequence.
\end{dfn}

Moreover, we have the following.

\begin{lemma}
The cohomology class of $(2\pi i)^{-k} S_k(\At(V))$ provides a section
of the sheaf $H^k(X ; \Omega^k_{hol})$. On any compact K\"ahler manifold, it agrees with $c_k(V)$.
\end{lemma}

\subsubsection{The formal Atiyah class}

We now wish to show that Gelfand-Kazhdan descent sends an exact sequence in $\VB_{\hc}$ to an exact sequence in $\vb(\GK_n)$ (and hence in $\vb(\Hol_n)$). 
It will then remain to verify that for each tensor bundle on $\Hol_n$, 
there is an exact sequence over the formal $n$-disk that descends to the Atiyah sequence for that tensor bundle.

We will use the notation $\desc_\GK(\cV)$ to denote the functor $\desc_\GK(-,\cV): \GK_n^\op \to \Pro(\vb)_{flat}$, 
since we want to focus on the sheaf on $\GK_n$ (or $\Hol_n$) defined
by each formal vector bundle~$\cV$. Taking flat sections we get an
$\cO$-module $\sdesc_{\GK}(\cV)$ which is locally free of finite
rank and so determines an object in $\vb(\GK_n)$. 

\begin{lemma}
If $$\cA \to \cB \to \cC$$ is an exact sequence in $\vb_{\hc}$, then 
$$\sdesc_\GK(\cA) \to \sdesc_\GK(\cB) \to \sdesc_\GK(\cC)$$ 
is exact in $\vb(\GK_n)$.
\end{lemma}

\begin{proof}
A sequence of vector bundles is exact if and only if the associated
sequence of $\cO$-modules is exact (i.e., the sheaves of sections of
the vector bundles). But a sequence of sheaves is exact if and only if
it is exact stalkwise. Observe that there is only one point at which
to compute a stalk in the site $\Hol_n$, since every point $x \in X$
has a small neighborhood isomorphic to a small neighborhood of $0 \in
\CC^n$. As we are working in an analytic setting, the stalk of a
$\cO$-module at a point $x$ injects into the $\infty$-jet at
$x$. Hence, it suffices to verifying the exactness of the sequence of
$\infty$-jets. Hence, we consider the $\infty$-jet at $0 \in \CC^n$ of
the sequence $\desc_\GK(A) \to \desc_\GK(B) \to \desc_\GK(C)$. But
this sequence is simply $A \to B \to C$, which is exact by
hypothesis.
\end{proof}
 %To see that we recover our original sequence, note that \owen{not sure how much to add here}

\begin{cor}
There is a canonical map from $\Ext^1_{\hc}(\cB,\cA)$ to $\Ext^1_{\GK_n}(\sdesc_\GK(\cB), \sdesc_\GK(\cA))$.
\end{cor}

In particular, once we produce the $\hc$-Atiyah sequence for a formal tensor field $\cV$, 
we will have a very local model for the Atiyah class living in $\clie^*(\Vect,\GL_n; \hOmega^1_n \otimes_{\hO_n} \End_{\hO_n}(\cV))$.

%\owen{For $\cV$ a formal tensor field, there is a natural Lie algebra inclusion $\Vect \to \End_\CC(\cV)$ in addition to the Lie algebra inclusion $\End_{\hO_n}(\cV)) \to \End_\CC(\cV)$.
%By direct computation (e.g., picking an $\hO_n$ frame for $\cV$), one can show that the commutator of a vector field with an $\hO_n$-linear endomorphism is again an $\hO_n$-linear endomorphism.
%Hence these subalgebras together span a Lie subalgebra, which we denote $\cA(\cV)$ for the {\em Atiyah algebra} of $\cV$.
%In fact, these Lie algebras sit in an exact sequence
%\[
%\End_{\hO_n}(\cV) \to \cA(\cV) \xto{\sigma} \End_{\hO_n}(\cV) \otimes_{\hO_n}\hT_n.
%\]
%This sequence splits as $\hO_n$-modules (e.g., by picking an $\hO_n$ frame for $\cV$ and coordinates on the formal $n$-disk), 
%but it is also a sequence of formal tensor fields and typically does not split in $\vb(\hD^n)_{\hc}$.}

%\owen{\begin{dfn}
%The {\em $\hc$-Atiyah sequence} of $\cV$ is the short exact sequence
%\[
%\End_{\hO}(\cV) \to \cA(\cV) \to \hT_n
%\]
%in $\vb(\hD^n)_{\hc}$.
%\end{dfn}
%}

\subsubsection{The formal Atiyah sequence} \label{sec gk cc}

Let $\cV$ be a formal vector bundle. 
We will now construct the ``formal'' Atiyah sequence associated to $\cV$.  
First, we need to define the $(\Vect, \GL_n)$-module of {\em first order jets} of $\cV$. 
Let's begin by recalling the construction of jets in ordinary geometry.

If $X$ is a manifold, we have the diagonal embedding $\Delta : X \hookrightarrow X \times X$. 
Correspondingly, there is the ideal sheaf $\cI_\Delta$ on $X \times X$ of functions vanishing along the diagonal. 
Let $X^{(k)}$ be the ringed space $(X, \cO_{X \times X}/\cI_\Delta^k)$ 
describing the $k$th order neighborhood of the diagonal in $X \times X$. 
Let $\Delta^{(k)} : X^{(k)} \to X \times X$ denote the natural map of ringed spaces.
The projections $\pi_1, \pi_2 : X \times X \to X$ compose with $\Delta^{(k)}$ 
to define maps $\pi^{(k)}_1, \pi_2^{(k)} : X^{(k)} \to X$. 
Given an $\cO_X$-module $\cV$, 
``push-and-pull'' along these projections,
\ben
J^k_X(\cV) = (\pi_1^{(k)})_* (\pi_2^{(k)})^* \cV,
\een
defines the $\cO_X$-module of $k$th order jets of~$\cV$.

There is a natural adaptation in the formal case. 
The diagonal map corresponds to an algebra map $\Delta^* : \hO_{2n} \to \hO_n$.
Fix coordinatizations $\hO_n = \CC \ll t_1,\ldots,t_n \rr$ and $\hO_{2n} = \CC \ll t'_1,\ldots,t_n', t_1'', \ldots,t_n'' \rr.$ 
Then the map is given by $\Delta^*(t'_i) = \Delta^*(t_i'') = t_i$. 

Let $\hI_n = \ker(\Delta^*) \subset \hO_{2n}$ be the ideal given by the kernel of $\Delta^*$. 
For each $k$ there is a quotient map
\ben
\Delta^{(k)*}: \hO_{2n} \to \hO_{2n} / \hI_n^{k+1} ,
\een
The projection maps have the form
\ben
\pi_1^{(k)*}, \pi_2^{(k)*}  : \hO_n \to \hO_{2n} / \hI_n^{k+1},
\een
which in coordinates are $\pi_1^*(t_i) = t'_i$ and $\pi_2^*(t_i)
=~t''_i$. 

\begin{dfn} 
Let $\cV$ be a formal vector bundle on $\hD^n$.
Consider the $\hO_{2n} / \hI_n^{k+1}$-module
$\cV \tensor_{\hO_n} \left(\hO_{2n} / \hI_n^{k+1}\right)$,
where the tensor product uses the $\hO_n$-module structure on the
quotient $\hO_{2n} / \hI_n^{k+1}$ coming from the map $\pi_2^{(k)*}$. 
We define the {\em $k$th order formal jets of $\cV$}, denoted $J^k(\cV)$, 
as the restriction of this $\hO_{2n}/\hI_n^{k+1}$-module 
to a $\hO_n$-module using the map $\pi_1^{(k)*} : \hO_n \to \hO_{2n} / \hI_n^{k+1}$. 
\end{dfn}

\begin{lemma} For any $\cV \in \VB_n$ the $k$th order formal jets
  $J^k(\cV)$ is an element of $\VB_n$. 
\end{lemma}
\begin{proof}
For $\cV$ in $\VB_n$ there is an induced action of $(\Vect, \GL_n)$ on
the tensor product $\cV \tensor_{\hO_n} \hO_{2n} /
\hI_{n}^{k+1}$. For fixed $k$ we see that $\hO_{2n} / \hI_n^{k+1}$ is
finite rank as a $\hO_n$ module. Thus it
is immediate that this module satisfies the conditions of a formal
vector bundle.
\end{proof}

As a $\CC$-linear vector space we have $J^1(\cV) = \cV \oplus (\cV \tensor_{\hO_n} \hOmega^1_n)$. 
For $f \in \hO_n$ and $(v, \beta) \in \cV \oplus (\cV \tensor \hOmega^1_n)$, 
the $\hO_n$-module structure is given by
\ben
f \cdot (v, \beta) = (f v, (f \beta + v \tensor \d f)).
\een 
(This formula is the formal version of Atiyah's description in Section 4 of \cite{atiyah},
where he uses the notation~$\mathcal{D}$.) The following is proved in
exact analogy as in the non-formal case which can also be found in
Section 4 of \cite{atiyah}, for instance. 

\begin{prop}\label{1jet2} 
For any $\cV \in \VB_{\hc}$, the $\hO_n$-module $J^1(\cV)$ has a compatible action of the pair $(\Vect, \GL_n)$ and hence determines an object in $\VB_{\hc}$. 
Moreover, it sits in a short exact sequence of formal vector bundles 
\be\label{formalatiyah1}
\cV \tensor \hOmega^1_n \to J^1 (\cV) \to \cV .
\ee
Finally, the Gelfand-Kazhdan descent of this short exact sequence is isomorphic to the Atiyah sequence
\ben
\sdesc_{\GK}(\cV) \tensor \Omega^1_{hol} \to J^1 \sdesc_{\GK} (\cV) \to \sdesc_{\GK}(\cV) .
\een
In particular, $J^1 \desc_{\GK}(\cV) = \desc_{\GK}(J^1 \cV)$.
\end{prop}

We henceforth call the sequence (\ref{formalatiyah1}) {\em the formal Atiyah sequence} for $\cV$. 

\begin{rmk} 
Note that $J^1(\cV)$ is an element of the category $\VB_n$ but it is {\em not} a formal tensor field. 
That is, it does not come from a linear representation of $\GL_n$ via coinduction. 
\end{rmk}

\begin{rmk} 
A choice of a formal coordinate defines a splitting of the first-order jet sequence as $\hO_n$-modules. 
If we write $\cV = \hO_n \tensor_\CC \cV$, then one defines 
\ben
j^1 : \cV \to J^1 \cV \;\; , \;\; f \tensor_\CC v \mapsto (f \tensor_\CC v, (1 \tensor_\CC v) \tensor_{\cO} \d f) .
\een
It is a map of $\hO_n$-modules, and it splits the obvious projection $J^1(\cV) \to \cV$. 
We stress, however, that it is {\em not} a splitting of $\Vect$-modules. 
We will soon see that this is reflected by the existence of a certain characteristic class in Gelfand-Fuks cohomology. 
\end{rmk}

Note the following corollary, which follows from the identification 
$$\Ext^1(\cV \tensor_{\hO_n} \hOmega_{n}^1, \cV) \cong \clie^1(\Vect,\GL_n; \hOmega^1_n \otimes_{\hO_n} \End_{\hO_n}(\cV))$$ 
and from the observation that an exact sequence in $\vb(\hD^n)$ maps to an exact sequence in $\vb(\GK_n)$.

\begin{cor}
There is a cocycle $\At^\GF(\cV) \in \clie^1(\Vect,\GL_n; \hOmega^1_n \otimes_{\hO_n} \End_{\hO_n}(\cV))$ representing the Atiyah class $\At(\desc_\GK(\cV))$. 
\end{cor}

We call this cocycle the Gelfand-Fuks-Atiyah class of $\cV$ since it
descends to the ordinary Atiyah class for $\desc(\cV)$ as a sheaf of
$\cO$-modules. 

%We call this cocycle the {\em universal Atiyah class} since it descends to the Atiyah class on any $n$-manifold with respect to the map
%\ben
%{\rm H}^1(\Vect, \GL_n ; \hOmega^1_n \tensor \End_{\hO_n}(\cV)) \cong \Ext^1(\cV \tensor \hOmega^1_n, \cV) \to \Ext_{\GK_n}(\desc(\cV) \tensor \Omega^1, \desc(\cV)) .
%\een

%Let us fix a GK-structure $\sigma$ over a complex manifold $X$. 

%\begin{lemma} There is a quasi-isomorphism
%\ben
%\Ext^1_{\cO_X}(\sdesc(\sigma, \cV_1), \sdesc(\sigma, \cV_2)) \simeq \bdesc()
%\een
%\end{lemma}

%For a fixed GK-structure $\sigma$ over a complex manifold $X$ the image of $\At^\GF(\cV)$ under t%he characteristic map
%\ben
%\ch_\sigma : \clie^*(\Vect , \GL_n ; \hOmega^1 \tensor_{\hO_n} \End_{\hO_n}(\cV)) \to \bdesc(\sigma, \\cV) = \dR\left(X ; \desc(\sigma, \cV)\right) \simeq \ch^*(X ; \sdesc(\sigma, \cV))
%\een
%agrees with the ordinary Atiyah class for $\desc(\cV)$ in cohomology.

%\owen{\begin{proof}[Proof of lemma]
%The key is to use the Lie algebra structure on the formal Atiyah sequence for $\cV$. 
%The action of formal vector fields on $\cV$ descends to the action of vector fields on the tensor bundle $\desc_\GK(\cV)$, which is canonical and determined by the Lie derivative.
%Likewise, the action of $\cO$-linear endomorphisms $\End_{\hO_n}(\cV)$ descends to the action of $\cO$-linear endomorphisms $\End_{\cO}(\desc_\GK(\cV))$, which is also canonical.
%Hence, we have a short exact sequence of Lie algebras in sheaves on the site $\GK_n$, 
%and its leftmost and rightmost terms are the same as Atiyah's sequence.
%We need to identify the Lie algebras in the middle of the exact sequences.
%One strategy would be to reinterpret $\cA(\cV)$ as "invariant vector fields on the total space of $\cV$ over $\hD^n$," although that may seem silly.
%\end{proof}}
%\owen{BW suggests the following approach: verify that $\desc_\GK(\Diff^{\leq 1})$ is the appropriate tensor bundle by directly doing sufficiently many examples}
%%\owen{I'd like to say that $$\loc(\Diff^{\leq 1}_\cV) = \Diff^{\leq 1}_{\loc(\cV)}$$ but I'm not sure how to write something rigorous. The crux seems to be showing that this localized Lie algebra, whose avatar on the formal disk acts naturally on $\cV$ as a ``Lie algebroid,'' acts on the localization of $\cV$ in the appropriate way.}
%
%\owen{Vague thoughts: 
%The local action of formal vector fields globalizes to the action of vector fields on a tensor bundle, which is canonical and determined by the Lie derivative.
%Likewise, the local action of $\cO$-linear endomorphisms globalizes to the action of endomorphisms, which is also canonical.
%Hence it will suffice to identify the usual Atiyah algebra, in the global setting, as this descent object. 
%This must be somewhere in the literature.}

\begin{dfn}
The {\em Gelfand-Fuks-Chern character} is the formal sum $\ch^\GF(\cV) = \sum_{k \geq 0} \ch^\GF_k(\cV)$, 
where the $k$th component
\ben
{\rm ch}_k^\GF(\cV) := \frac{1}{(-2 \pi i)^k k!} {\rm Tr}({\At}^\GF(\cV)^k)
\een
lives in $\clie^k(\Vect,\GL_n; \hOmega^k_n)$.
\end{dfn}

It is a direct calculation to see that $\ch^{\GF}_k(\cV)$ is closed for
the differential on formal differential forms, 
i.e., it lifts to an element in $\clie^k(\Vect,\GL_n; \hOmega^k_{n,cl})$.

\subsubsection{An explicit formula}

In this section we provide an explicit description of the Gelfand-Fuks-Atiyah class  
\ben
\At^{\rm GF}(\cV) \in \clie^1(\Vect, \GL_n ; \hOmega^1_n
\tensor_{\hO_n} \End_{\hO}(\cV)) .
\een 
of a formal vector bundle $\cV$. 

By definition, any formal vector bundle has the form $\cV = \hO_n \tensor V$, 
with $V$ a finite-dimensional vector space.
We view $V$ as the ``constant sections'' in $\cV$ by the inclusion $i: v \mapsto 1 \otimes v$.
This map then determines a connection on $\cV$:
we define a $\CC$-linear map $\nabla: \cV \to \hOmega^1_n \otimes_{\hO_n} \cV$
by saying that for any $f \in \hO_n$ and $v \in V$,
\[
\nabla(f v) = \d_{dR}(f) v,
\]
where $\d_{dR} : \hO_n \to \hOmega^1_n$ denote the de Rham
differential on functions. This connection appeared earlier when we
defined the splitting of the jet sequence $j^1 = 1 \oplus \nabla$. 

The connection $\nabla$ determines an element in $\clie^1(\Vect ;
\hOmega^1_n \tensor_{\hO} \End_{\hO}(\cV))$, as follows. Let 
\ben
\rho_{\cV} : \Vect \tensor \cV \to \cV
\een
denote the action of formal vector fields and consider the composition
\ben
\Vect \tensor V \xto{\id \tensor i} \Vect \tensor \cV \xto{\rho_{\cV}} \cV \xto{\nabla} \hOmega^1_n \tensor_{\hO} \cV .
\een 
Since $V$ spans $\cV$ over $\hO_n$, this composite map determines a $\CC$-linear map
\[
\alpha_{\cV,\nabla}: \Vect \to \hOmega^1_n \tensor_{\hO} \End_{\hO}(\cV)
\]
by
\[
\alpha_{\cV,\nabla}(X)(fv) = f \nabla( \rho_\cV(X)(i(v))),
\]
with $f \in \hO_n$ and $v \in V$.

\begin{prop} \label{atiyahprop1} 
Let $\cV$ be a formal vector bundle. 
Then $\alpha_{\cV,\nabla}$ is a representative for the Gelfand-Fuks-Atiyah class~$\At^{\rm GF}(\cV)$. 
\end{prop}

\begin{proof}
We begin by recalling some general facts about the Gelfand-Fuks-Atiyah class as an
extension class of an exact sequence of modules. Viewing $\hO_n$ as functions on the formal $n$-disk, we can ask about the jets of such functions.
A choice of formal coordinates corresponds to an identification $\hO_n \cong \CC[[t_1,\ldots,t_n]]$,
and that choice provides a trivialization of the jet bundles by providing a preferred frame.
This frame identifies, for instance, $J^1$ with $\hO_n \oplus \hOmega^1_n$,
and the1-jet of a formal function $f$ can be understood as~$(f, \d_{dR}f)$.

For a formal vector bundle $\cV = \hO_n \otimes V$, something similar happens after choosing coordinates.
We have $J^1(\cV) \cong \cV \oplus \hOmega^1_n \otimes_{\hO_n} \cV$ and
the 1-jet of an element of $\cV$ can be written as
\ben
\begin{array}{cccc}
j^1 : & \cV & \to & J^1(\cV)   \\
& f v & \mapsto & (f  v, \d_{dR}(f) v ) .
\end{array}
\een 
where $f \in \hO_n$ and $v \in V$. 
The projection onto the second summand is precisely the connection $\nabla$ on $\cV$ 
determined by $\cV = \hO_n \otimes V$, the defining decomposition.

The Gelfand-Fuks-Atiyah class is the failure for this map $\nabla$ to be a map of $\Vect$-modules. 
Indeed, $\nabla$ determines a map of graded vector spaces
\ben
1 \tensor \nabla : \clie^\#(\Vect ; \cV) \to \clie^\#(\Vect ;\hOmega^1_n
\tensor_{\hO} \cV) .
\een
Let $\d_{\cV}$ denote the differential on $\clie^*(\Vect; \cV)$ and
$\d_{\Omega^1 \tensor \cV}$ denote the differential on $\clie^*(\Vect
; \hOmega^1_n \tensor_{\hOmega} \cV)$. The failure for $1 \tensor \nabla$ is precisely the difference
\be\label{difference}
(1 \tensor \nabla) \circ \d_{\cV} - \d_{\Omega^1 \tensor \cV} \circ (1 \tensor
\nabla).
\ee
This difference is $\clie^\#(\Vect)$ linear and can hence be
thought of as a cocycle of degree one in $\clie^*(\Vect ; \hOmega^1
\tensor_{\hO} \End_{\hO} (\cV))$. This is the representative for the Atiyah
class. 

We proceed to compute this difference. The differential $\d_{\cV}$ splits as $\d_{\Vect}
\tensor 1_\cV
+ \d'$ where $\d_{\Vect}$ is the differential on the complex
$\clie^*(\Vect)$ and $\d'$ encodes the action of $\Vect$ on
$\cV$. Likewise, the differential $\d_{\Omega^1 \tensor \cV}$ splits
as $\d_{\Vect} \tensor 1_{\Omega^1 \tensor \cV} + \d_{\Omega^1}
\tensor 1_V + 1_{\Omega^1} \tensor \d '$ where $\d_{\Omega^1}$ is the differential on the complex $\clie^*(\Vect ;
\hOmega^1_n)$. 

The de Rham differential clearly commutes with the
action of vector fields so that $(1 \tensor \d_{dR}) \circ
(\d_{\cO}\tensor 1) = (\d_\Vect + \d_{\Omega^1})\circ(1 \tensor
\d_{dR})$ so that the the difference in (\ref{difference}) reduces to 
\ben
(1 \tensor \nabla) \circ \d' - (1_{\Omega^1} \tensor \d') \circ (1
\tensor \nabla) .
\een
By definition $\d'$ is the piece of the Chevalley-Eilenberg
differential that encodes the action of $\Vect$ on $\cV$, so if we
evaluate on an element of the form $1 \in v \in \clie^0(\Vect ; V)
\subset \clie^0(\Vect ; \cV)$ the only term that survives is the GF 1-cocycle
\ben
X \mapsto \nabla \d'(1 \tensor v)(X) = \nabla (\rho_\cV(X) (v)) .
\een
as desired. 
\end{proof}

\begin{cor} 
On the formal vector bundle $\hT_n$ encoding formal vector fields, 
fix the $\hO_n$-basis by $\{\partial_j\}$ and the $\hO_n$-dual basis of one-forms by $\{\d t^j\}$. 
The explicit representative for the Atiyah class is given by the Gelfand-Fuks 1-cocycle 
\ben
f^i \partial_i\mapsto - \d_{dR} (\partial_j f^i) (\d t^j
\tensor \partial_i)
\een
taking values in $\hOmega^1_n \tensor_{\hO_n} \End_{\hO}(\hT_n)$.
\end{cor}

\begin{proof} 
We must compute the action of vector fields on $\hO_n$-basis elements of $\hT_n$. 
We fix formal coordinates $\{t_j\}$ and let $\{\partial_j\}$ be the associated constant formal vector fields. 
Then the structure map is given by the Lie derivative $\rho_{\hT} (f^i \partial_i , \partial_j ) = - \partial_j f^i$. 
The formula for the cocycle follows from the Proposition. 
\end{proof}
 
We can use this result to explicitly compute the cocycles representing the Gelfand-Kazhdan Chern characters. 
For instance, we have the following formulas that will be useful in later sections.

\begin{cor}
The second component $\ch_2^{\rm GF}(\hT_n)$ of the universal Chern character is the cocycle
\ben
{\rm Tr}({\rm At}^\GF(\hT_n)^{\wedge 2}): (f^i \partial_i, g^j \partial_j) \mapsto - \d_{dR}(\partial_j f^i) \wedge \d_{dR}(\partial_i g^j)
\een 
in $\clie^2(\Vect,\GL_n; \hOmega_n^2)$. 
As the de Rham differential $\d_{dR} : \hOmega^1_n \to \hOmega^2_n$ is $\Vect$-equivariant, 
there is an element $\alpha$ in $\clie^2(\Vect,\GL_n; \hOmega_n^1)$ such that
\[
\ch_2^{\rm GF}(\hT_n) = \d_{dR} \alpha
\]
where 
\[
\alpha: (f^i \partial_i, g^j \partial_j) \mapsto - \partial_j f^i \wedge \d_{dR}(\partial_i g^j).
\]
Moreover, as $\ch_2$ is closed for the differential $\partial$, 
it lifts to a cocycle in $\clie^2(\Vect, \GL_n ; \hOmega^2_{n,cl})$.
\end{cor}

\subsubsection{Extended pair}
The $2$-cocycle $\ch_2^{\GF}(\hT_n)$ determines an extension Lie algebras of $\Vect$ by the abelian Lie algebra $\hOmega^2_{n,cl}$
\ben
0 \to \hOmega^2_{n,cl} \to \TVect \to \Vect \to 0 .
\een

We have already discussed the pair $(\Vect, \GL_n)$. We will need that
the above extension of Lie algebras fits in to a Harish-Chandra pair
as well. The action of $\GL_n$ extends to an action on $\TVect$ where
we declare the action of $\GL_n$ on closed two-forms to be the natural
one via linear formal automorphisms.

\begin{lemma} 
The pair $(\TVect, \GL_n)$ form a Harish-Chandra pair and fits into an extension of pairs
\ben
0 \to \hOmega^2_{n,cl} \to (\TVect, \GL_n) \to (\Vect, \GL_n) \to 0
\een
which is determined by the cocycle $\ch_2^{\GF}(\hT_n)$. 
\end{lemma}

One might be worried as to why there is only a non-trivial extension
of the Lie algebra in the pair. The choice of a coordinate determines
an embedding of linear automorphisms $\GL_n$ into formal automorphisms
$\Aut_n$. The extension of formal automorphisms $\Aut_n$ defined by
the group two-cocycle $\ch_2^\GF(\hT_n)$ is trivial when restricted to
$\GL_n$ so that it does not get extended.

% \subsubsection{Calculation of the cocycle}

% \begin{prop} 
% The universal Atiyah class of $\cV = \hT_n$ is the cocycle 
% \ben
% f^i \partial_i \mapsto - \d_{dR} (\partial_j f^i) (\d t_j
% \tensor \partial_i)
% \een 
% in $\clie^1(\Vect,\GL_n; \hOmega^1_n \tensor_{\hO} \hOmega^1_n
% \tensor_{\hO} \hT_n) \cong \clie^1(\Vect , \GL_n ; \hOmega^1_n \tensor_{\hO} \End_{\cO}(\hT_n))$ .
% \end{prop}

% Here, $\d_{dR}$ denotes the formal differential on holomorphic forms
% $\d_{dR} (f) = (\partial_i f) \d t_i$. 

% \begin{proof}
% We have already mentioned that a choice of a formal coordinate
% determines a splitting $s : \cV \to J^1(\cV)$
% for any formal vector bundle $\cV$. In the case of $\hT_n = \hO_n \tensor_\CC \CC\{\partial_1,\ldots, \partial_n\}$ the splitting has the form
% \ben 
% g^j \tensor_\CC \partial_j \mapsto \left(g^j
% \tensor_\CC \partial_j, \d_{dR} (g^j) \tensor_{\hO} (1
% \tensor_\CC \partial_j) \right) . 
% \een  

% With respect to the splitting the $\Vect$ action on $J^1(\cV)$ has the
% form
% \ben
% \rho : \Vect \tensor (\hT_n \oplus \hOmega^1_n \tensor_{\hO} \hT_n) \to \hT_n \oplus
% \hOmega^1_n \tensor_{\hO} \hT_n .
% \een
% This action has three terms:
% \begin{itemize} 
% \item[(i)] $\rho_1 : \Vect \tensor \hT_n \to \hT_n$, this is just the Lie
%   bracket of vector fields; 
% \item[(ii)] $\rho_2 : \Vect \tensor (\hOmega^1_n \tensor_{\hO} \hT_n) \to
%   \hOmega^1_n \tensor_{\hO} \hT_n$, this is just the standard action
%   on the tensor product according the symmetric monoid structure on
%   $\VB_{(\Vect, \GL_n)}$;
% \item[(iii)] $\rho_3 : \Vect \tensor \hT_n \to \hOmega^1_n \tensor_{\hO}
%   \hT_n$. 
% \end{itemize}
% There is no term $\Vect \tensor (\hOmega^1_n \tensor_{\hO} \hT_n) \to
% \hT_n$ since $\hOmega^1_n \tensor_{\hO} \hT_n$ is a submodule.

% The map in (iii) determines a 1-cocycle in $\clie^1(\Vect ;
% \hOmega^1_n \tensor_{\hO} \hT_n \tensor_{\hO} \hT_n^*) \cong
% \clie^1(\Vect ; \hOmega^1_n \tensor_{\hO_n} \End_{\hO}(\hT_n))$ and
% this is a representative for the Atiyah class. We will compute this
% cocycle directly. 

% Let $X = f^i \partial_i \in \Vect$ and
% consider the constant section $Y = 1 \tensor_\CC \partial_j$. The vector field
% $f^i \partial_i$ acts on this section via
% \ben
% X \cdot Y = (f^i \partial_i) \cdot (1 \tensor_\CC \partial_j) = - \partial_j f^i
% \tensor_\CC \partial_i .
% \een 
% With respect to the splitting $s$ this maps to the element 
% \ben
% ([X,Y], -\d_{dR} (\partial_j f^i) \tensor_{\hO} (1 \tensor_\CC \partial_i) ) \in J^1
% \cV = \cV \oplus \hOmega^1
% \tensor_{\hO} \hT_n .
% \een 
% The second component corresponds to the component (iii) of the
% action. That is 
% \ben
% \rho_3(f^i \partial_i, 1 \tensor \partial_j) = - \d_{dR} (\partial_j f^i)
% \tensor_{\hO} (1 \tensor_\CC \partial_i) .
% \een 
% Dualizing we find the 1-cocycle
% \ben
% f^i \partial_j \mapsto - \d_{dR} (\partial_j f^i) \tensor_{\hO}
% (\d t_j \tensor_\CC \partial_i) 
% \een
% as desired. 
% \end{proof}

% \brian{I think we can nix the following proof, since I do everything in terms
% of jets anyway. }
% \begin{proof} 
% We have already mentioned that a choice of a formal coordinate determines a splitting of $\hO_n$-modules.
% \ben
% \cA(\hT_n) = \End(\hT_n) \oplus \hT_n .
% \een
% With respect to this splitting a general element in $\cA(\hT_n)$ is of the form
% \ben
% G + H = g_j^i (\partial_i \tensor \d t_j) + \id \tensor h^l \partial_l
% \een
% where $g_j^i,h^l \in \hO_n$. Here, we view $\End(\hT_n) \cong \hT_n \tensor \hOmega^1_n$ and the second component $\hT_n$ of $\cA(\hT_n)$ is embedded as
% \ben
% \hT_n = \id_{\hO_n} \tensor \hT_n \subset \End(\hT_n) \tensor \hT_n
% \een
% to which $\Diff^{\leq 1}(\hT_n)$ maps as the quotient by constant differential operators. 

% Consider the $\Vect$-module structure on $\cA(\hT_n)$. It is given by a map
% \ben
% \rho : \Vect \tensor (\End(\hT_n) \oplus \hT_n) \to \End(\hT_n) \oplus \hT_n .
% \een 
% We will compute the inclusion followed by projection
% \ben
% {\rm pr}_{\End(\hT_n)} \circ \rho \circ i_{\hT_n}  : \Vect \tensor \hT_n \to \End(\hT_n).
% \een
% This will be the representative for the Atiyah class.  

% Let $X = f^i \partial_i \in \Vect$. We first compute 
% \ben
% \rho(f^i \partial_i \tensor (\id \tensor h^l \partial_l)) = L_{f^i \partial_i} \circ (\id \tensor h^l \partial_l) - (\id \tensor h^l \partial_l) \circ L_{f^i \partial_i} \in \End(\hT_n) \oplus \hT_n .
% \een
% Choose a test section $a^m \partial_m \in \hT_n$. The first term acting on this test section is
% \bestar
% \left(L_{f^i \partial_i} \circ (\id \tensor h^l \partial_l)\right) (a^m \partial_m) & = & L_{f^i \partial_i}((h^l \partial_l a^m )\partial_m) \\ & = & [f^i \partial_i , (h^l \partial_l a^m \partial_m] \\ & = & (f^i \partial_i (h^l \partial_l a^m) \partial_m - (h^l \partial_l a^m \partial_m f^i)\partial_i \\ & = & (f^i \partial_i h^l \partial_l a^m)\partial_m + (f^i h^l \partial_i \partial_l a^m)\partial_m - (h^l \partial_l a^m \partial_m f^i)\partial_i .
% \eestar 

% The second term acting on the test section is
% \bestar
% \left((\id \tensor h^l \partial_l) \circ L_{f^i \partial_i} \right) (a^m \partial_m) & = & (\id \tensor h^l \partial_l) \left([f^i \partial_i, a^m \partial_m]\right) \\ & = & h^l \partial_l((f^i \partial_i a^m)\partial_m - (a^m \partial_m f^i)\partial_i) .
% \eestar

% Combining the above we see that
% \ben
% \rho(f^i \partial_i \tensor (\id \tensor h^l \partial_l)) = [f^i \partial_i, h^l \partial_l] (a^m \partial_m) - (h^l a^m \partial_m\partial_l f^i)\partial_l .
% \een
% Upon projecting on to the $\End(\hT_n)$ piece acting on the test function we see
% \ben
% ({\rm pr}_{\End} \circ \rho)(f^i \partial_i \tensor (\id \tensor h^l \partial_l)) = -(h^l a^m \partial_m\partial_l f^i)\partial_l
% \een
% for which it follows
% \ben
% {\rm pr}_{\End} \circ \rho(f^i \partial_i \tensor h^l \partial_l) = - h^l \partial_l \partial_m f^i (\partial_i \tensor \partial^m) .
% \een
% Dualizing we find that the Atiyah class
% \ben
% {\rm At}_{for}(\Vect) : \Vect \to \hOmega^1_n \tensor {\rm End}(\Vect) = \hOmega^1_n \tensor (\hT_n \tensor \hOmega^1_n)
% \een
% is given by 
% \ben
% f^i \partial_i \mapsto - \d_{dR}(\partial_j f^k) (\partial_k \tensor \d t_j)
% \een 
% as an element in $\clie(\Vect ; \hOmega^1_n)$ as desired. It is immediate to see that this lies in the subspace 
% \ben
% \clie^1(\Vect , \GL_n ; \hOmega^1_n).
% \een
% \end{proof}

%We define differential operators of order $\leq 1$ on $\cV$ to be the formal vector field
%\ben
%\Diff^{\leq 1}(\cV) := {\rm Hom}_{\hO_n}(J^1(\cV), \cV) . 
%\een
%By the above lemma we have a short exact sequence
%\be\label{1diff}
%\End_{\hO_n}(\cV) \to \Diff^{\leq 1}(\cV) \to \End_{\hO_n}(\cV) \tensor \hT_n 
%\ee
%of formal tensor fields.
%Consider the map
%\ben
%\iota : \hT_n \to \End_{\hO_n}(\cV) \tensor \hT_n \; \; , \;\; X \mapsto {\rm id}_{\hO_n} \tensor X,
%\een
%Note that this is a map of $\Vect$-modules but is {\em not} a map of Lie algebras. We define $\cA(\cV)$ to be the the pull-back 
%\ben
%\xymatrix{
%\cA(\cV) \ar[r] \ar[d] & \hT_n \ar[d]^-{\iota} \\
%\Diff^{\leq 1}(\cV) \ar[r] & \End_{\hO_n}(\cV) \tensor \hT_n 
%}
%\een
%in the category of formal tensor fields.

%\begin{prop} 
%For any $\cV$ in $\VB_{\hc}$, there is a short exact sequence in $\VB_{\hc}$
%\be\label{formalatiyah}
%\cV \tensor_{\hO_n} \hOmega^1_{n} \to J^1(\cV) \to \cV .
%\ee
%Moreover, the Gelfand-Kazhdan descent of this short exact sequence
%\[
%\sdesc_\GK(\End_{\hO_n}(\cV)) \to \sdesc_\GK(\cA(\cV)) \to \sdesc_\GK(\hT_n)
%\]
%is isomorphic to the classical Atiyah sequence for the holomorphic vector bundle $\desc_\GK(\cV)$.
%\end{prop}

%\begin{proof}
%The first statement is immediate. The second statement follows from the well-known fact that the Atiyah sequence is dual to the 
%\end{proof}

%\def\Diff{{\rm Diff}}
%\def\xto{\xrightarrow}
%
%
%
%For $\cV$ in $\vb(\hD^n)_{\hc}$, let $\Diff_\cV$ denote the algebra of differential operators on $\cV$. If we fix an isomorphism $\cV \cong \hO^{\oplus d}$ of $\hO$-modules, then $\Diff_\cV \cong D \otimes_\CC \End_\CC(\CC^d)$. This algebra is filtered by order, just as ordinary differential operators are. Let $\Diff^{\leq 1}_\cV$ denote the order 1 differential operators on $\cV$. There is a canonical short exact sequence of $\hO$-modules
%\[
%\End_{\hO}(\cV) \to \Diff^{\leq 1}_\cV \xto{\sigma} \End_{\hO}(\cV) \otimes_{\hO}\hT_n
%\]
%where $\sigma$ is the principal symbol map. The $\Vect$-module structure on $\cV$ is encoded by a map of Lie algebras $\rho: \Vect \to \Diff^{\leq 1}_\cV$, and there is likewise a natural $\GL_n$-module structure. In other words, $\Diff^{\leq 1}_\cV$ is an $\hc$-module, and the above is a short exact sequence in $\vb(\hD^n)_{\hc}$. \owen{Need to give detailed descriptions of this structure! And why it's an SES in that category!}
%
%\begin{dfn}
%The {\em $\hc$-Atiyah sequence} of $\cV$ is the short exact sequence
%\[
%\End_{\hO}(\cV) \to \cA(\cV) \to\hT_n
%\]
%pulled back from the sequence for $\Diff^{\leq 1}_\cV$ along the map $\sigma \circ \rho$.
%\end{dfn}

\section{Harish-Chandra structure on CDOs} \label{sec vertex alg}

In this section, we first recall the definition of chiral differential
operators on affine space $\CC^n$; this object always exists and there
is no obstruction to defining it. Then we formulate a construction of chiral differential
operators on more general complex manifolds based on the theory of
Gelfand-Kazhdan descent developed in the previous section. The key
element of this formulation is the Harish-Chandra module structure for
formal vector fields and automorphisms, much of which has been studied
in the literature on vertex algebras. The two main results we extract is
Theorem \ref{GMS1} which shows how formal automorphisms act, and Theorem
\ref{MSV1} which shows how formal vector fields act. We find these
actions to be compatible and deduce the structure of a module 

\subsection{Recollections on vertex algebras}

\subsubsection{Recollections}

We briefly recall the definition of a vertex algebra and some other notions associated to vertex algebras. 
Our main references are \cite{BZF} and \cite{Kac}.

\begin{dfn}
A {\em vertex algebra} is the following data:
\begin{itemize}
\item[(i)] a vector space $V$ over $\CC$ (the \emph{state space}); 
\item[(ii)] a nonzero vector $\left|0 \> \in V$ (the \emph{vacuum vector}); 
\item[(iii)] a linear map $T : V \to V$ (the \emph{translation operator});
\item[(iv)] a linear map $Y (-; z) : V \to \End(V) \ll z^{\pm} \rr$ (the \emph{vertex operator});
\end{itemize}
subject to the following conditions:
\begin{itemize}
\item[(1)] For $v \in V$, let 
\[
Y(v;z) = \sum_{n \in \ZZ} v_{(n)} z^{-n-1}
\]
in $\End (V) \ll z^{\pm} \rr$. 
(We call the endomorphisms $v_{(n)}$ the \emph{Fourier modes} of $Y(v;z)$.)
Then for each $w \in V$ there exists some $N \in \ZZ$ such that $v_{(j)} w = 0$ for all $j > N$.
\item[(2)] $Y(\left|0\>; z) = \id_V$ and $Y(v;z) \left|0\> \in v + z V \ll z
  \rr$ for all $v \in V$. 
\item[(3)] For every $v$, $[T, Y(v;z)] = \partial_z Y(v; z)$, and $T\left|0\> = 0$.
\item[(4)] For any pair $v,v'\in V$, there exists $N \in \ZZ_{\geq 0}$ such that $(z-w)^N [Y(v;z), Y(v';w)] = 0$.
\end{itemize}
\end{dfn}

\begin{rmk}
Alternatively, one can  formulate the definition of a vertex algebra in terms of the Fourier modes $v_{(n)}$. 
Indeed, our definition above provides a family of bilinear operations
\[
\begin{array}{cccc}
(-)_{(n)} (-) : & V \times V & \to & V \\
& (v,w) & \mapsto & v_{(n)}w
\end{array}
\]
These operations satisfy algebraic conditions coming from conditions (1)-(4) above. 
For instance, see~\cite{Kac}. 
\end{rmk}

We will be interested in, and take advantange of, vertex algebras with the additional structure of a $\ZZ_{\geq 0}$-grading. 
This grading is not cohomological in nature and does not follow the Koszul sign rule.
We call it the \emph{conformal dimension grading}.

\begin{dfn}
A vertex algebra as above is {\em $\ZZ_{\geq 0}$-graded} if 
the underlying state space $V$ is a $\ZZ_{\geq 0}$-graded vector space $V = \bigoplus_{N \in \ZZ_{\geq 0}} V^{(N)}$
such that 
\begin{enumerate}
\item[(1)] the vacuum $\left|0\>$ has dimension zero, 
\item[(2)] the translation operator $T$ is a dimension $1$ map, and 
\item[(3)] for $v \in V^{(N)}$ the dimension of the endomorphism $v_{(m)}$ is $-m + N -1$. 
\end{enumerate}
\end{dfn}

Condition (3) ensures that  if $v \in V^{(N)}$ and $w \in V^{(M)}$, 
then $v_{(m)} w \in V_{-m + N + M-1}$. 


\subsubsection{Actions on vertex algebras}

We now discuss what it means for a Harish-Chandra pair to act on a
vertex algebra. 

It is clear how to define an action of a Lie group on a vertex
algebra $V$. Indeed, if $K$ is a Lie group then by an action of $K$ on
$V$ is a group homomorphism
\ben
\rho_K : K \to \Aut_{{\rm VA}}(V)
\een
where $\Aut_{{\rm VA}}(V)$ are the vertex algebra automorphisms. That is,
maps of vertex algebras $V \to V$ whose underlying $\CC$-linear map is
invertible.  

To define the action of a Lie algebra on $V$ we first recall what a
vertex algebra derivation is. It is the data of a linear map $D : V
\to V$ such that for all $v \in V$ one has
\ben
Y(D v ; z) = [D, Y(v ; z)] .
\een 
The set of all derivations forms a Lie algebra which we denote
$\Der_{{\rm VA}}(V)$. An action of a Lie algebra $\fg$ on $V$ is the data
of a homomorphism
\ben
\rho_\fg : \fg \to \Der_{{\rm VA}}(V) .
\een 

It also makes sense to talk about vertex algebras that have actions by
apair $(\fg,K)$. Indeed, a $(\fg,K)$-action on a vertex algebra $V$ is
a $(\fg,K)$-action is given by actions of $\fg$ and $K$ as above such
that we have the obvious compatibility. 

The underlying vector space of a vertex algebra is almost always infinite dimensional, however,
and so does not immediately fit into our definition of a module of a Harish-Chandra pair from Section 1. 
We sidestep this issue by focusing on vertex algebras are graded by conformal dimension where the conformal dimension $N$ space $V^{(N)}$ is finite dimensional for each $N$
(in our case, finite rank over $\hO_n$) 
so that we have a well-behaved category of modules. 
From here on, we will assume the following definition of an action on
a vertex algebra. 

\begin{dfn}\label{graction} 
An \emph{action of a Harish-Chandra pair $(\fg,K)$ on a $\ZZ_{\geq 0}$-graded vertex algebra $V = \bigoplus_{N} V^{(N)}$} 
is a collection of $(\fg,K)$-actions $(\rho^{(N)}_{\fg}, \rho^{(N)}_{K})$ on the underlying fixed conformal dimension spaces $V^{(N)}$ such that:
\begin{itemize}
\item[(1)] for each $x \in \fg$ the induced map $\oplus_N \rho^{(N)}_\fg(x)$ is a vertex algebra derivation for $V$, and
\item[(2)] for each $A \in K$ the induced map $\oplus_{N} \rho^{(N)}_K(A)$ is a vertex algebra automorphism for $V$.
\end{itemize}
\end{dfn}

%\brian{examples where $V^{(N)}$ is actually finite dimensional? Check out BZF}

\subsection{The $\beta\gamma$-vertex algebra}

One of the main objects that we will focus on is the vertex algebra of
chiral differential operators on $\CC^n$. In the physics literature
\cite{WittenCDO}, \cite{Nek}, \cite{polchinski} it is typically called the $n$-dimensional $\beta\gamma$ vertex algebra. 

\begin{dfn}
Let $\CDO_n$ denote the vertex algebra of {\em chiral differential operators} for $\CC^n$. The underlying vector space is
\[
\CC [b_l^j,c_m^j]_{1 \leq j \leq n, l < 0, m \leq 0},
\]
the translation operator $T$ is
\begin{align*} 
 b_m^j &\mapsto -m b_{m-1}^j, \\
 c_m^j &\mapsto -(m-1) c_{m-1}^j,
\end{align*}
and the vertex operator is
\[
Y(b^j_{-1},z) = \sum_{m < 0} b_m^j z^{-1-m} + \sum_{m \ge 0} \frac{\partial}{\partial c_{-m}^j} z^{-1-m} 
\]
and 
\[
Y(c_{0}^j,z) = \sum_{m \le 0} c^j_m z^{-m} - \sum_{m > 0}  \frac{\partial}{\partial b_{-m}^j} z^{-m}.
\]
These determine a vertex algebra by a reconstruction theorem (see, e.g., Theorem 2.3.11 of \cite{BZF}).
\end{dfn}

This vertex algebra $\CDO_n$ is a $\ZZ_{\geq 0}$-graded. We specify this by
saying that $c_0^j$ has conformal dimension $0$ and $b_{-1}^j$ has
conformal dimension $1$. Denote by $\CDO_n^{(N)}$ the conformal dimension
$N$ subspace. 

\begin{rmk}\label{rmk:notations}
The generators of this vertex algebra are given a variety of symbols:
\begin{enumerate}
\item in \cite{MSV}, they use $a^j_{m}$ for what we call $b^j_m$ and $b^j_{m}$ for our~$c^j_m$;
\item in Chapter 11 Section 3.6 of \cite{BZF}, they use $a^j_{-m}$ for what we call $b^j_m$ and ${a^{\ast}}^j_{-m}$ for our~$c^j_m$.
\end{enumerate}
%wen{Add further references, possibly. Verify indices!}
\end{rmk}

It is important to note how $\CDO_n$ relates to the geometry of $\CC^n$, and some subtleties thereof.
The underlying vector space of $\CDO_n$ is isomorphic with the underlying vector space of the commutative algebra $\CC [b_{l}^i, c_{m}^j]$, 
where $l < 0$, $m \leq 0$, and $i,j = 1,\ldots,d$. 
The map
\[
\begin{array}{cccc}
\label{poly}
\tau : &\cO_n = \CC [t^1,\ldots, t^n] &\to& \CDO^0_n\\ 
& t_i & \mapsto & c_0^i .
\end{array}
\]
identifies the commutative algebra $\cO_n$ of functions on $\CC^n$ with the conformal dimension zero subspace $\CDO_n^{(0)} \subset \CDO_n$, 
which consists of polynomials in the variables $c_0^1,\ldots, c_0^{n}$. 
In other words, for any polynomial function $f$ on $\CC^n$, we substitute $c^i_0$ for $t_i$ in the polynomial $f$.
We will express this, somewhat abusively, as $\tau(f) = f(c)$.
This relationship shows that one can view the underlying vector space of $\CDO_n$ as an $\cO_n$-module.

One might hope that this map $\tau$ is a map of commutative algebras,
by using the $(-1)$-Fourier mode as a bilinear operation
\ben
(-)_{(-1)} (-) : \CDO_n^{(0)} \times \CDO_n^{(0)} \to \CDO_n^{(0)} 
\een
to equip $\CDO_n^{(0)}$ with a commutative algebra structure.
The issue is that this product is not associative! \si 
Hence, we emphasize that $\CDO_n$ {\em as a vertex algebra} is not $\cO_n$-linear. 

\begin{rmk}
In \cite{BorVAMS} Borisov develops a clean formalization of this situation by introducing the notion of an $R$-loop module over a commutative algebra $R$,
clarifying how, in our example above, the $\cO_n$-module structure interacts with the vertex algebra structure on $\CDO_n$.
This notion of loop module also leads to quasi-loop-coherent sheaves and then to sheaves of vertex algebras.
Borisov used it to globalize the chiral de Rham complex to complex manifolds, 
and suitably modified, it should apply to chiral differential operators too.
\end{rmk}

\subsubsection{Completion}

We use this module structure to complete along powers of $\{t^1,\ldots,t^n\}$. 
That is, we base change $\CDO_n$ to a module for $\hO_n$:
\ben
\hCDO_n := \hO_n \tensor_{\cO_n} \CDO_n.
\een
In Theorem 3.1 of \cite{MSV} it is shown that this module obtains a
vertex algebra structure by extending that on $\CDO_n$. The critical
step is showing that the vertex operator
\ben
Y(-,z) : \hCDO_n \to \End(\hCDO_n)\llbracket z,z^{-1}\rrbracket 
\een
is well defined. Every power series $f \in \hO_n$ is a limit of polynomials $\{f_k\} \subset \cO_n$. According to the inclusion (\ref{poly}), every $f_k \in \cO_n$ determines a field
\ben
f_k(z) := f_k(c_0^1(z),\ldots, c_0^n(z)) \in \End(\CDO_n)\llbracket z, z^{-1} \rrbracket .
\een 
The result of \cite{MSV} is that the limit of $\{f_k(z)\}$ determines a field
\ben
f(z) := f(c_0^1(z),\ldots,c_0^n(z)) \in \End(\hCDO_n)\llbracket z, z^{-1} \rrbracket .
\een
Note that $\hCDO_n$ is still a $\ZZ$-graded vertex algebra, inherited from the conformal dimension $\ZZ$-grading on $\CDO_n$. 
Indeed, for each $N \in \ZZ$ we have $\hCDO_n^{(N)} = \hO_n \tensor_{\cO_n} \CDO_n^{(N)}$. 


\subsubsection{}

The primary complication in gluing chiral differential operators $\CDO_n$ to a sheaf on a general manifold 
is that the group of automorphisms of the disk do {\em not} act as automorphisms of the vertex algebra. 
This problem appears for the formal disk as well. 
The group of formal automorphisms $\Aut_n$ do not act on $\hCDO_n$, 
as we will see explicitly at the level of formal vector fields, in way preserving the vertex operator. 

If we restrict ourselves to {\em linear} automorphisms of the disk, however, we find that there is no such problem. 
Indeed we can explicitly describe the action of the Lie group $\GL_n$ 
by vertex algebra automorphisms on $\CDO_n$ and $\hCDO_n$  as follows. 
Denote by $\mathbf{b}_m$ the $n$-tuple $(b_m^1,\ldots,b_m^n)$ considered as a vector in $\CC^n$ and
$\mathbf{c}_m$ as the vector $(c_m^1,\ldots, c_m^n)$. 
Given $A \in \GL_n$, the action of $A$ is specified by 
\begin{align}
A \cdot {\bf c}_{0} & = A {\bf c}_0 \label{GLact1} \\
A \cdot {\bf b}_{-1} & = (A^T)^{-1} {\bf b}_{-1} \label{GLact2}
\end{align} 
where on the right-hand side we understand matrix
multiplication. 
Clearly this action preserves the $\ZZ_{\geq 0}$-grading.

\subsection{The classical limit}
While the $\beta\gamma$ vertex algebra does not carry an action of
formal automorphisms or formal vector fields, its ``classical limit''
does. For this reason, descending the classical vertex algebra is much
simpler and the formalism of Gelfand-Kazhdan descent from Section
\ref{sec gk descent} directly applies. (For an alternative approach to
this see \cite{Malikov2008}) First, we discuss what we mean by the
classical limit of $\CDO_n$.

For each fixed conformal dimension $N \in \ZZ$, there is a filtration on the subspace $\CDO_n^{(N)}$ that we now describe. First we set up some notation.

Let $L = \left((i_1,l_1),\ldots,(i_p,l_p)\right) \in
\left(\{1,\ldots,n\} \times \ZZ_{<0}\right)^p$, $M =
\left((j_1,m_1),\ldots,m_q)\right) \in \left(\{1,\ldots,n\} \times
  \ZZ_{\leq 0}\right)^q$ be multi-indices of length $p$ and $q$ respectively. Define
\bestar
b_L &:= & b_{l_1}^{i_1} \cdots b_{l_p}^{i_p} \\
c_M & := & c_{m_1}^{j_1} \cdots c_{m_q}^{j_q} .
\eestar
Then as a vector space, the subspace $\CDO_n^{(N)}$ of conformal dimension $N$ is generated by monomials of the form $c_M b_L$ where
\ben
|L| +|M| = (l_1 + \cdots l_p)  + (m_1 + \cdots m_q) = - N .
\een
Define the subspace $F^k \CDO_n^{(N)}$ as the $\CC$-linear span of all
elements of the form $c_M b_L$ such that $p \leq k$ where $p$ is the
length of the multi-index $L$ as above. This construction also
provides a filtration on $\hCDO_n^{(N)}$.

\def\Gr{{\rm Gr}}

\begin{prop} 
The associated graded 
\ben
{\rm Gr} \, \CDO_n := \bigoplus_{N \in \ZZ} \; {\rm Gr}(\CDO_n^{(N)}) = \bigoplus_N \left(\bigoplus_k F^k \CDO_n^{(N)}/ F^{k-1} \CDO_n^{(N)} \right)
\een
has the structure of a $\ZZ_{\geq 0}$-graded Poisson vertex algebra, as does ${\rm Gr} \, \hCDO_n$. 
\end{prop}

Roughly, a vertex algebra can be thought of as an integer family of
products. A Poisson vertex algebra is essentially a commutative vertex algebra
together with an integer family of Lie brackets that act on the underlying
commutative vertex algebra by derivations. For the precise
definition of a Poisson vertex algebra see Chapter 16 Section 2 of \cite{BZF}. The fact that $\Gr \, \CDO_n$ is a Poisson vertex algebra follows from the well-known fact. 

\begin{prop}[Chapter 16 of \cite{BZF} ]
If $V$ is a filtered vertex algebra such that $\Gr \; V$ is a commutative vertex algebra,
then $\Gr \; V$ carries a canonical structure of a Poisson vertex algebra.
\end{prop}

\begin{rmk} 
The associated graded $\Gr\, \CDO_n$ can be thought of as a {\em classical limit} of the vertex algebra $\CDO_n$. 
We can introduce a deformation parameter $\hbar$ by modifying the definition of the vertex operator to
\[
Y(b^j_{-1},z) = \sum_{n < 0} b_n^j z^{-1-n} + \hbar \sum_{n \ge 0} \frac{\partial}{\partial c_{-n}^j} z^{-1-n} 
\]
and 
\[
Y(c_{0}^j,z) = \sum_{n \le 0} c^j_n z^{-n} - \hbar \sum_{n > 0}  \frac{\partial}{\partial b_{-n}^j} z^{-n}.
\]
These formulas define a vertex algebra $\CDO_{n,\hbar}$ over the ring $\CC_\hbar = \CC [ \hbar]$ whose specialization $\hbar = 1$ agrees with $\CDO_n$. 
Moreover, when we specialize $\hbar = 0$ we get the Poisson vertex algebra above. 
It is called the ``classical'' $\beta\gamma$ vertex algebra.
\end{rmk}

For each conformal dimension $N$, we can thus identify the associated graded ${\rm Gr}(\CDO_n^{(N)})$ with a direct sum of symmetric powers of tensor modules on $\CC^n$. Under this identification, the Lie algebra of polynomial vector fields 
\ben
{\rm W}^{\rm poly}_n = \CC[t^1,\ldots,t^n]\{\partial_1,\ldots,\partial_n\}
\een
acts via Lie derivative on ${\rm Gr} \; \CDO_n$. Expressing the Lie algebra of
{\em formal} vector fields as $\Vect = \hO_n \tensor_{\cO_n} {\rm
  W}_n^{\rm poly}$, we find that $\Vect$ acts on the vertex algebra
${\rm Gr} \, \hCDO_n$ via derivations.

\begin{prop} \label{grcdo}
The construction in the preceding paragraph defines the structure of a $(\Vect, \GL_n)$-module on the $\ZZ_{\geq 0}$-graded vertex algebra ${\rm Gr} \; \hCDO_n$ preserving the family of brackets definining the Poisson vertex algebra structure. Moreover, this action is compatible with the $\hO_n$-module structure. 
\end{prop}

\begin{proof} The associated graded can be written as \si 
%\ben
%\Gr \; \hCDO_n \cong
%\underset{{0<k}}{\widehat{\bigotimes}}\,\cSym_{\hO_n}(\hT^*_n)\,
%\widehat{\otimes}\, \underset{{0\leq
%    l}}{\widehat{\bigotimes}}\,\cSym_{\hO_n}(\hT_n) .
%\een
\[
\Gr \; \hCDO_n \cong
\underset{{0\leq k}}{\bigotimes} \,\Sym_{\hO_n}(\hOmega^1_n)\,
\otimes \, \underset{{0<
    l}}{\bigotimes} \,\Sym_{\hO_n}(\hT_n) .
\]
The action by $\Vect$ and $\GL_n$ is by Lie derivative and changes of
linear
frame on the respective tensor
bundles appearing in the large decomposition above. 
\end{proof}

%\begin{prop} 
%The Poisson vertex algebra ${\rm Gr} \; \hCDO_n$ has the structure of
%a $(\Vect, \Aut_n)$-module such that:
%\begin{itemize}
%\item[(i)] there is an action of $\Aut_n$ on $\Gr \; \hCDO_n$ by vertex
%  algebra automorphisms;
%\item[(ii)] there is an action of $\Vect$ on $\Gr \; \hCDO_n$ by vertex
%  algebra derivations that is compatible with the action in (i), in the sense of Definition \ref{hcmod};
%\item[(iii)] the action of $\Vect$ commutes with the vertex algebra
%  derivations given by the family of brackets defining the Poisson
%  vertex structure.
%\end{itemize}
%\end{prop}

%\begin{rmk} The category of $(\Vect, \Aut_n)$-modules is symmetric
%  monoidal and it makes sense to talk about vertex algebras and
%  Poisson vertex algebras in it. Although we don't develop the
%  machinery here, the above implies that $\hCDO_n$ is a Poisson vertex
%  algebra object of $(\Vect,\Aut_n)$-modules.
%\end{rmk}
\subsubsection{Conformal structure}\label{sec conformal structure}

The vertex algebra $\CDO_n$, and its completion $\hCDO_n$, has the additional structure of a {\em
  conformal vertex algebra} of central charge equal to twice the dimension
$2n$. This means that $\hCDO_n$ receives a map
from the Virasoro vertex algebra, ${\rm Vir}_{c=2n}$, of central
charge $c = 2n$. The Virasoro vertex algebra is the $\ZZ_{\geq 0}$-graded with underlying vector space ${\bf
  Vir}_c = \CC [L_k, C]$ where $k \leq -2$ and generating field given
by 
\ben
Y(L_{-2}, z) = \sum_{k \in \ZZ} L_k z^{-k-2} .
\een
where the conformal dimension of $L_{-2}$ is $2$. A conformal vector for $\hCDO_n$ is defined by
\ben
L_{-2} := \sum_{i=1}^n b^i_{-1} T c^i_0 = \sum_{i=1}^n b^i_{-1}
c^i_{-1} \in \hCDO_n^{(2)}.
\een

\begin{rmk} 
If $V$ is a conformal vertex algebra and $L_0 \in V$ is the zero Fourier mode of the Virasoro field, 
then for every $v \in V$, one has $L_0 v = N(v) v$ for some $N(v) \in \ZZ$. 
If $N(v) \in \ZZ_{\geq 0}$ for all $v$, 
we see that $L_0$ determines the structure of a $\ZZ_{\geq 0}$-graded vertex algebra on $V$, 
where $V^{(N)}$ denotes the $N$-eigenspace of the $L_0$ operator. 
This fact motivates the use of the term ``conformal dimension'' for a $\ZZ_{\geq 0}$-graded vertex algebra.
\end{rmk}

\subsection{Harish-Chandra structure on $\CDO_n$}\label{sec hc cdo}

As opposed to the classical limit the vertex algebra $\hCDO_n$ is {\em not} a module for the pair $(\Vect, \GL_n)$. The main result of this section is to show that there is an extension of this Harish-Chandra pair that does act on the vertex algebra. 
This is largely based on the work of \cite{MSV} and \cite{GMS}, as
well as \cite{GMS2}, and we summarize their results below.
 
\subsubsection{Extension of vector fields}

On the Lie algebra side, the extension of Lie algebras that acts on
$\hCDO_n$ is precisely the extension $\TVect$ of formal vector fields
by $\hOmega^2_{n,cl}$ defined by the Gelfand-Fucks second component of
the Chern character defined in Section \ref{sec gk descent}. We now recall the
construction in \cite{MSV} that describes how this extension acts. We can state the main result as follows. 

\begin{thm}\label{MSV1} [Section 5.1 of \cite{MSV}]
There is map of Lie algebras
\ben
\rho : \TVect \hookrightarrow {\rm Der}_{\rm VA}(\hCDO_n) 
\een
of the extended Lie algebra $\TVect$ into derivations of vertex algebra of chiral differential operators on the formal $n$-disk. 
In particular, $\hCDO_n$ is a $\TVect$-module.
\end{thm}

First, we describe how one embeds the vector space of formal vector fields inside of chiral differential operators on $\hD^n$. We have already described how to map a formal power series $f(t_1,\ldots,t_n)$ to an element $f(c_0^{1},\ldots, c_0^{n}) \in \hCDO_n^{(0)}$. This puts the structure of an $\hO_n$-module on $\hCDO_n^{(N)}$ for each $N$. Note that as $\hO_n$-modules we have a splitting $\Vect = \hO_n \tensor \CC \{\partial_1,\ldots,\partial_n\}$. We define 
\[
\begin{array}{cccc}
\tau_{\rm W} : & \Vect &\to& \hCDO_n^{(1)}, \\
& f(t) \partial_j & \mapsto & \tau(f) b_{-1}^j = f(c) b_{-1}^j.
\end{array}
\]
In other words, we substitute $c^i_0$ for $t_i$ in the power series $f$ and replace $\partial_j$ by~$b_{-1}^j$.

The subspace of vectors of conformal dimension one $\hCDO_n^{(1)}$ acts on the vertex algebra through left multiplication by its zero Fourier mode
\ben
(-)_{(0)}(-) : \CDO_n^{(1)} \times \CDO_n \to \CDO_n
\een
In fact, for a fixed $a \in \hCDO_n^{(1)}$ the endomorphism $a_{(0)}$ is a derivation of the vertex algebra. The composite map of taking the zero mode after $\tau_{\rm W}$ thus produces a linear map
\[
\begin{array}{cccc}
\rho_{\rm W} :  &\Vect &\to& {\rm Der}_{{\rm VA}} (\hCDO_n),\\ 
&f(t) \partial_j& \mapsto & (\tau(f) b_{-1}^j)_{(0)}=(f(c) b_{-1}^j)_{(0)} .
\end{array}
\]
Moreover, for any $a \in \hCDO_n^{(1)}$, 
the derivation $a_{(0)} : \hCDO_n \to \hCDO_n$ preserves the $\ZZ$-grading 
and so defines a map $a_{(0)} : \hCDO^{(N)}_n \to \hCDO^{(N)}_n$ for each $N \in \ZZ$. 
A quick calculation verifies that this map is {\em not} a map of Lie algebras. 
This issue is remedied this by introducing an extension of Lie algebras, as we will see shortly. 


\subsubsection{}
We introduce the space of $1$-forms $\hOmega^1_n$ on the formal disk. Considered as an abelian Lie algebra this acts on the vertex algebra $\hCDO_n$ as we now describe.

The de Rham differential $\d_{dR} : \hO_n \to \hOmega_n^1$ has an
interpretation in the vertex algebra $\hCDO_n$ as the translation operator $T$ defining the vertex algebra structure. 
Indeed, we define
\[
\begin{array}{cccc}
\tau_{\Omega^1} : &\hOmega_n^1 &\to &\hCDO_n^{(1)},\\
& f(t) \d t_j & \mapsto & \tau(f) T(c_0^j) = f(c) T(c_0^j).
\end{array}
\]
As $\hOmega^1_n$ is abelian, the map $\tau_{\Omega^1}$ automatically determines a Lie algebra representation of $\Omega^1_n$ on $\CDO_n$ via the Lie algebra homomorphism
\[
\begin{array}{cccc}
\rho_{\Omega^1} : &\hOmega_n^1 &\to& {\rm Der}_{{\rm VA}}(\hCDO_n), \\ 
&\omega &\mapsto& \tau_{\Omega^1}(\omega)_{(0)} .
\end{array}
\]
It is clear that the action by an exact one-form is zero, so $\rho_{\Omega^1}$ factors as
\ben
\hOmega_n^1 \to \hOmega_n^1 / \d \hO_n \cong \hOmega^2_{n,cl} \xto{\rho_{\Omega^2_{cl}}}  {\rm Der}_{{\rm VA}}(\hCDO_n),
\een
where we have identified $\hOmega_n^1 / \d \hO_n \cong \hOmega^2_{n,cl}$ via the de Rham differential. 
The map $\rho_{\Omega^2_{cl}}$ is the desired action by closed two-forms. 

We can explicitly describe the action by a closed two-form $\omega$ as follows.
Let $\alpha = \alpha_i (t) \d t^i$ be a one-form such that $\d \alpha =  \omega$.
\si
Then
\ben
\rho_{\Omega^2_{cl}} (\omega) = - \left(\partial_j \alpha_i (c) T(c_0^j) T (c_0^{i}) + \alpha_i(c) T (c_0^{i})^2 \right)_{(1)} .
\een

\subsubsection{}

Consider the linear subspace 
\[
\Bar{\rm W}_n := {\rm Im}(\rho_{\rm W}) \oplus {\rm Im}(\pi_{\Omega^2_{cl}}) \subset {\rm Der}_{{\rm VA}}(\hCDO_n).
\] 
A direct calculation shows that $\Bar{\rm W}_n$ is actually a sub-Lie algebra of the vertex algebra derivations. 
It is immediate that ${\rm Im}(\rho_{\Omega^2_{cl}})$ is an ideal in $\Bar{\rm W}_n$ and the quotient is isomorphic to $\Vect$.
Thus, $\Bar{\rm W}_n$ sits in a short exact sequence
\ben
0 \to \hOmega^2_{n,cl} \to \Bar{\rm W}_n \to \Vect \to 0 .
\een
The 2-cocycle determining this extension is
\ben
\alpha_{MSV}(f^i \partial_i, g^j \partial_j) = - \d_{dR}(\partial_j f^i) \wedge \d_{dR}(\partial_i g^j) .
\een 
This cocycle is precisely the cocycle $\ch_2^{\GF}(\hT_n)$ determining the extension $\TVect$, so that we have $\TVect \cong \Bar{\rm W}_n$. 

\begin{rmk} 
In \cite{MSV} the connection to the Gelfand-Fuks Chern character is not present, 
though our cocycle agrees on the nose with the vertex algebra calculation. 
\end{rmk}

We have thus constructed a map of Lie algebras 
\[
\Tilde{\rho}_{\rm W} = (\rho_{\rm W}, \rho_{\Omega^2_{cl}}) : \TVect \cong \Bar{\rm W}_n \to {\rm Der}_{{\rm VA}}(\hCDO_n),
\]
as desired.

\subsubsection{}

We have already described the action of $\GL_n$ on $\hCDO_n$ in
(\ref{GLact1}) and (\ref{GLact2}). Combining the results highlighted
in the section above we obtain the following. This action is
compatible with the action of $\Vect$ just constructed. In conclusion,
we can summarize the above as follows. 

\begin{prop}\label{hc str on cdo}
The pair $(\TVect, \GL_n)$ acts on the $\ZZ_{\geq 0}$-graded vertex algebra $\hCDO_n$. Moreover, this action is compatible with the $\hO_n$-module structure. 
\end{prop}

\subsection{Formal automorphisms}

The above construction of the action of the pair $(\TVect, \GL_n)$ on
the vertex algebra of CDOs will be sufficient for our purposes. In
this section we review the main result of \cite{GMS} which constructs
an action of an extension of {\em all} formal automorphsims $\Tilde{\Aut}_n \to
\Aut_n$ on CDOs. This action is compatible with our construction
above.   

%The proof of the Proposition \ref{hc1} amounts to exhibiting the compatibility of results of \cite{GMS} and \cite{MSV}. 
%We review their constructions here. 

\begin{thm} \label{GMS1}
Let $\Aut_{VA}(\hCDO_n)$ denote the group of automorphisms of the
vertex algebra $\hCDO_n$. There is a subgroup 
\ben
\Tilde{\rm Aut}_n \hookrightarrow {\rm Aut}_{\rm VA}(\hCDO_n)
\een
that fits in a short exact sequence of groups
\be\label{grpses}
0 \to \Hat{\Omega}^2_{n,cl} \to \Tilde{\rm Aut}_n \to {\rm Aut}_n \to 1 .
\ee
\end{thm}

In \cite{GMS}, this subgroup $\Tilde{\rm Aut}_n \subset {\rm Aut}_{{\rm VA}}(\hCDO_n)$ is characterized as the ``natural'' vertex algebra automorphisms.
We will outline their argument and attempt to explain the sense of ``natural'' here.

First, as $\hCDO_n$ is $\ZZ$-graded by conformal dimension, it is reasonable to restrict to dimension-preserving automorphisms,
which will be determined by where they send the generators.
As discussed above, the generators are in dimensions 0 and 1:
the dimension 0 component can be identified with $\hO_n$ --- functions on the formal $n$-disk --- 
and the dimension 1 component with $\hOmega^1 \oplus \hT$ --- one-forms and vector fields on the formal $n$-disk.
We view the dimension 1 component as 2-step filtered, with  $\hOmega^1$ as the submodule.

Before worrying about the vertex algebra structure, let us consider dimension-preserving maps of the space of generators.
This group is $\Aut(\hO_n) \times \Aut(\hOmega^1 \oplus \hT)$.
Following \cite{GMS}, we restrict our attention to an important subgroup.
On the dimension 0 component, they only consider the subgroup $\Aut_n$.
Note that every element of $\Aut_n$ acts on the dimension 1 component, since they are tensor fields,
so there is a natural map $\Aut_n \to \Aut(\hOmega^1 \oplus \hT)$.
On the dimension 1 component, they restrict to automorphisms whose action respects the filtration 
and whose associated graded action on $\Gr\, \hCDO_n$ is simply the action induced by the underlying automorphism on the dimension 0 component.
In other words, such an automorphism $\phi$ is ``triangular'':
it consists of a term $\phi_0 \in \Aut_n$ and of an $\hO_n$-linear map $\phi_1: \hT \to \hOmega^1$,
and 
\[
\phi(f, \omega, X) = (\phi_0 \cdot f, \phi_0 \cdot \omega + \phi_1(X), \phi_0\cdot X) \in \hO_n \oplus \hOmega^1 \oplus \hT.
\]
Let us use $\Aut^{GMS}_n$ to denote this group considered in \cite{GMS}.
The underlying set is isomorphic to the product 
\ben
{\rm Aut}_n \times {\rm Mat}_n(\ccO_n),
\een
by using the natural isomorphism 
\[
\hOmega^1_n \widehat{\otimes}_{\hO_n} \hOmega^1_n \cong {\rm Mat}_n(\ccO_n).
\]
But this group $\Aut^{GMS}_n$ has an interesting group structure because of how $\Aut_n$ acts on the dimension 1 component.
In fact, it has the structure of a semi-direct product ${\rm Aut}_n \ltimes_{pb} (\hOmega^1_n)^{\tensor 2}$, where the pull-back action is as above.
%\owen{Where? Let's give a precise citation.}

By definition, the group $\Tilde{\rm Aut}_n$ is the subgroup of $\Aut^{GMS}_n$ consisting of vertex algebra automorphisms. 
In other words, we pick out the dimension-preserving automorphisms of generators that intertwine with the vertex operator and so on.

In \cite{GMS} it is shown that the composition 
\[
\widetilde{\Aut}_n \to\Aut^{GMS}_n \to \Aut_n
\]
is surjective and that its kernel is isomorphic to closed 2-forms. That is, one has a map of extensions
\ben
\xymatrix{
\Hat{\Omega}^2_{n,cl} \ar[r] \ar[d] & \widetilde{\Aut}_n \ar[r] \ar[d] & \Aut_n \ar[d] \\
\Hat{\Omega}_n^1 \tensor \Hat{\Omega}^1_n \ar[r] & \Aut^{GMS}_n \ar[r] & {\rm Aut}_n.
}
\een 
This identifies the relevant short exact sequence (\ref{grpses}). 

\subsubsection{An explicit formula for the cocycle} 
\label{sec GMScocycle}

% \brian{I have extracted all the juice we need for our construction
% in the previous sections. This last section should be seen as a
% comparison to GMS's work, though we do not use their results
% explicitly in our construction.}

In this section we describe an explicit group 2-cocycle
\ben
\Tilde{\alpha}_{GMS} \in {\rm C}_{\rm Grp}^2(\Aut_n ; \hOmega^2_{n,cl}) .
\een
describing the extension (\ref{grpses}). First, we elaborate on what
we mean by a group 2-cocycle. 

We use the van Est model for smooth group cohomology and denote the cochains by ${\rm C}_{\rm Grp}^*$.
(See Chapter 3 of \cite{Fuks} for more discussion.) 
Given a Lie group $G$ and $M$ a representation,
let ${\rm C}_{\rm Grp}^k(G ; M)$ denote the space of smooth functions $C^\infty(G^k,M)$.
(Typically we have in mind a finite-dimensional representation,
but it is well-defined for any vector space $M$ such that smooth maps $C^\infty(G^k,M)$ is defined.)
The differential $\d_{Grp}$ is defined by
\si
\ben
(\d_{\rm Grp} \alpha)(g_1,\ldots, g_{k+1}) = 
g_1 \alpha(g_2, \ldots, g_{k+1}) + 
\sum_{i = 1}^{k} (-1)^i \alpha(g_1,\ldots,g_{i}g_{i+1}, \ldots, g_{k+1}) +
(-1)^{k+1} \alpha(g_1,\ldots,g_k) .
\een 
When $M$ is itself a cochain complex with differential $\d_M$, 
we naturally obtain a double complex.
Let ${\rm C}_{\rm Grp}^*(G; M)$ denote the associated total complex, combining the differential $\d_{\rm Grp}$ and~$\d_M$. 

Note that  a 2-cocycle $\alpha$ of ${\rm C}_{\rm Grp}^*(G; M)$ determines an extension
\ben
0 \to M \to \Tilde{G}_\alpha \to G \to 0
\een
where the group structure on $\Tilde{G}_\alpha$ is defined by
\[
(g_1, m_1) \cdot (g_2, m_2) = (g_1 g_2, m_1 + g_1m_2 + \alpha(g_1,g_2)),
\]
in the standard way.

We now proceed to write down a formula for the cocycle associated to the extension (\ref{grpses}). 
Much of the argumentation below is implicit in Section 6 of \cite{GMS2} (in the context of the closely related
\v{C}ech approach to CDOs) and also in \cite{GMS}, and we refer the reader to these sources for more details.  

Let $\hOmega^{\geq 2}_n$ denote a truncation of the de Rham complex: it is the total complex of the double complex
\[
\hOmega^{2}_n \xto{\d_{dR}} \hOmega^3_n \xto{\d_{dR}}\cdots \xto{\d_{dR}} \hOmega^n_n.
\]
There is a natural action of $\Aut_n$ on this complex, as Cartan's
formula for the action of vector fields on differential forms
intertwines with the de Rham differential. 

\def\D{{\rm D}}

First, we write down a 2-cocycle $\alpha_{GMS} \in {\rm C}_{\rm Grp}^*(\Aut_n ; \hOmega^{\geq 2}_n)$,
following~\cite{GMS}.
Given an element $f \in \Aut_n$, we will use $\D f$ to denote its Jacobian.
We give an explicit formula for $\alpha_{GMS}$ via a pair of maps $(\alpha_2, \alpha_3)$, where 
\ben
\begin{array}{cccc}
\alpha_2 : & \Aut_n \times \Aut_n & \to & \hOmega^{2}_n \\ 
& (f_1,f_2) & \mapsto&\tr\left((\D f_1)^{-1} \d_{dR} (\D f_1) (\d_{dR}(\D f_2) (\D f_2)^{-1})\right)
\end{array}
\een
and
\ben
\begin{array}{cccc}
\alpha_3 : & \Aut_n & \to & \hOmega^3_n \\ 
& f & \mapsto & \frac{1}{3} \tr\left( ((\D f)^{-1}\d_{dR} \D f)^3\right) .
\end{array}
\een
This cochain is of degree 2 and has no terms of type $\Omega^k$ for $k \geq 4$. 
One
immediately checks that this is a cocycle. That is, 
\begin{align*}
\d_{dR} \alpha_2 (f_1,f_2) & =  (\d_{\rm Grp} \alpha_3) (f_1,f_2),  \\
\d_{dR} \alpha_3 (f_1) & = 0 , \\
(\d_{\rm Grp} \alpha_2)(f_1,f_2,f_3) & = 0 ,
\end{align*}
for all $f_1,f_2,f_3 \in \Aut_n$. 
The last two equations are immediate by computation. 
The first equation follows from the relation
\be\label{PW1}
\alpha_3(f_2 \circ f_1) = \alpha_3(f_1) + f_1^* \alpha_3(f_2) - \d_{dR} \alpha_2(f_1,f_2), 
\ee
which is an instance of the Polyakov-Wiegmann identity. The Jacobian of the composition $f_2
\circ f_1$ is given by $\D(f_2 \circ f_1) = f_1^* (\D f_2) \D f_1$ as matrix-valued formal power series. 
Thus, for instance, we have
\ben
\d_{dR} \left(\D(f_2 \circ f_1)\right) = f_1^*(\d_{dR} \D f_2) \D f_1 + f_1^* \D f_2
\d_{dR} \D f_1 . 
\een 
Let $\D f = Jac(f_2 \circ f_1)$ so that $\alpha_3(f_2 \circ f_1) =
\frac{1}{3} \Tr\left(((\D f)^{-1} \d_{dR} \D f)^3\right)$. Plugging in the formula for the
Jacobian we compute
\bestar
\frac{1}{3} \left((\D f)^{-1} \d_{dR} \D f\right)^3 & = & \frac{1}{3} \left((\D f_1)^{-1} f_1^*((\D f_2)^{-1} \d_{dR}
\D f_2) \D f_1\right)^3 + \frac{1}{3} \left((\D f_1)^{-1} \d_{dR} \D f_1\right)^3 +
\{{\rm cross \; terms}\} .
\eestar
Taking the trace of both sides we see that the first two terms return
the first two terms of Equation (\ref{PW1}). In a similar way, a
direct (albeit tedious) calculation shows that the cross terms agree with $\d_{dR}
\alpha(f_1,f_2)$. 

By the formal Poincar\'{e} lemma we know that the inclusion 
$\hOmega^{2}_{n,cl} \hookrightarrow \hOmega^{\geq 2}_n$ is a quasi-isomorphism.
Moreover, this quasi-isomorphism is clearly $\Aut_n$-equivariant 
so that we have a resulting quasi-isomorphism of complexes 
\ben
{\rm C}_{\rm Grp}^*(\Aut_n ; \hOmega^2_{n,cl}) \to {\rm C}_{\rm Grp}^*(\Aut_n ; \hOmega^{\geq 2}_n) .
\een 
A lift $\Tilde{\alpha}_{GMS} \in \clie^2(\Aut_n ; \hOmega^2_{n,cl})$
of the cocycle $\alpha_{GMS} = (\alpha_2,\alpha_3)$ under this
quasi-isomorphism is a representative for the group extension~(\ref{grpses}). 

We can obtain an explicit formula as follows. 
Since $\d_{dR} \alpha_3(f) = 0$ for all $f$, 
the formal Poincar\'e lemma assures the existence of a map
$\mu : \Aut_n \to \hOmega^2_n$
such that $\d_{dR} \mu  = \alpha_3$. 
We define the 2-cocycle
\ben
\Tilde{\alpha}_{GMS}(f_1,f_2) = \alpha_2(f_1,f_2) + \mu(f_1) +
f_1^*\mu(f_2) - \mu (f_2 \circ f_1) .
\een 
Via the Polyakov-Wiegmann identity (\ref{PW1}), this element is closed and determines a
2-cocycle in ${\rm C}_{\rm Grp}^2(\Aut_n ; \hOmega^2_{n,cl})$. 

\subsubsection{} 

We discuss how the construction of $\Tilde{\Aut}_n$ and its action on $\hCDO_n$
from Proposition \ref{GMS1} is
compatible with the action of $(\TVect,\GL_n)$ on $\hCDO_n$ that we constructed in
Proposition \ref{hc str on cdo}. First, we see that the group cocycle $\alpha_{GMS}$ is
compatible with the cocycle $\ch_2(\hT_n)$ defining $\TVect$. 

Given any Lie group and $G$-representation $M$,
the derivative at the identity of $G$ (and its products $G^k$) determines a cochain map
\ben
D_1 : {\rm C}_{\rm Grp}^*(G ; M) \to \clie^*(\fg ; M),
\een 
where we view $M$ as a $\fg = \Lie(G)$-module on the right hand side. 
Explicitly, given a $k$-cochain $\alpha$ of $G$ we define
\ben
(D_1 \alpha)(x_1,\ldots,x_k) = \frac{\d}{\d t}  \left. \left(
  \alpha(x_1(t), \ldots,x_k(t)\right) \right|_{t= 0}
\een
where $x_i(t)$ is the flow on $G$ determined by $x_i \in \fg$. 

The Lie algebra of formal automorphisms of the $n$-disk is identified
with the subalgebra $\Vectz \subset \Vect$ consisting of formal vector
fields that vanish at the origin. Thus, there is a map of vector
spaces 
\be\label{lie1}
D_1 : {\rm C}_{\rm Grp}^2({\rm Aut}_n; \Hat{\Omega}^2_{n,cl}) \to \clie^2(\Vectz ; \Hat{\Omega}^2_{n,cl}) 
\ee
induced by taking the tangent space at the identity.

\begin{prop} 
The image of $\Tilde{\alpha}_{GMS}$ under the map (\ref{lie1}) is equal to 
the restriction of $\ch_2^{\rm GF}(\hT_n)$ to formal vector fields that vanish at the origin. 
\end{prop}

This proposition shows that $(\TVect, \Tilde{\rm Aut}_n)$ is a Harish-Chandra
pair extending the pair $(\Vect, \Aut_n)$. Combined with Theorem
\ref{GMS1} of \cite{GMS} we see that $(\TVect, \Tilde{\Aut}_n)$ acts on the vertex algebra
$\hCDO_n$. This action is compatible with the action of the pair
$(\TVect, \GL_n)$ we have constructed from Proposition \ref{hc str on cdo} in the following way. 

There is a natural map $p : \Tilde{\Aut}_n \to \GL_n$ that takes a formal automorphism together with a closed two-form and
maps it to the linear piece of the 1-jet of the automorphism. This is
clearly equivariant for the action of vector fields so that we have an
induced map of pairs $p : (\TVect, \TAut_n) \to (\TVect, \GL_n)$. 
The choice of a formal coordinate determines a splitting $s : \GL_n \to \Aut_n$ and hence a map of pairs 
$s : (\TVect, \GL_n)\to (\TVect, \TAut_n)$.
The action of $(\TVect, \GL_n)$ on $\hCDO_n$ constructed in
Proposition \ref{hc str on cdo} is the restriction along the map $s$ of the action by
$(\TVect, \TAut_n)$ constructed in~\cite{GMS}. 

% Differential forms pull back along maps of manifolds, and so diffeomorphisms of the formal $n$-disk $\Aut_n$ acts via pullback on the vector space $\hOmega^2_n$ of two-forms on the formal $n$-disk. Let $\Aut_n \ltimes_{pb} \hOmega^2_{n,cl}$ denote the semidirect product of groups determined by this pullback action. The action by pullback is {\em not} an action on the vertex algebra (i.e., it does not preserve the vertex operator). We will see, however, that there is a ``deformation'' of the group $\Aut_n \ltimes_{pb} \hOmega^2_{n,cl}$ that does act on the vertex algebra. 

%Moreover, there is a fiber square
%\ben 
%\xymatrix{
%\Aut_n \ltimes_{pb} \hOmega^2_{n,cl} \ar[r] \ar[d] & \Aut_{\rm VA}({\rm Gr} \; \CDO_n) \ar[d] \\
%\Aut_n \ltimes_{pb} \hOmega^2_n \ar[r] & \Aut_{\rm Vect}(V_n) .
%}
%\een
%\brian{not sure about this, it seems like $\Aut_n \ltimes_{pb} \hOmega^2_n$ does act}

%That is, the subgroup of $\Aut_n \ltimes_{pb} \hOmega^2_n$ that acts on $V_n$ by vertex algebra automorphisms is precisely the semi-direct product of automorphisms (via the pull-back action) by closed two-forms.

%The group $\Aut_n \ltimes_{pb} \hOmega^2_{n,cl}$, and the corresponding Lie algebra, still do not act on the vertex algebra $\CDO_n$. There is, however, a deformation that does act.  

% The main result of this section is the following.

% \begin{prop}\label{hc1} 
% There is an extension of Harish-Chandra pairs
% \ben
% 0 \to \Hat{\Omega}^2_{n,cl} \to (\TVect, \Tilde{\rm Aut}_n) \to (\Vect, {\rm Aut}_n) \to 0
% \een
% such that the vertex algebra $\hCDO_n$ has the structure of a $(\TVect, \Tilde{\rm Aut}_n)$-module .
% \end{prop}

\subsection{The conformal structure for the equivariant vertex algebra}

We have already seen that the $\beta\gamma$ vertex algebra is
conformal so that there is a map of vertex algebras $\Phi_{\rm Vir} :
{\rm Vir}_{c=n} \to \hCDO_n$. This map is {\em not} equivariant for
the action of the extended Lie algebra $\TVect$ (where we equip ${\bf
  Vir}_{c=n}$ with a trivial $\TVect$ action). We will see that the
failure for this map to be a map of $\TVect$-modules is measured by a
certain Gelfand-Kazhdan characteristic class. 

The map of vertex algebras $\Phi_{\rm Vir}$ is completely determined
by where it sends the Virasoro generator, which we called $L_{-2} \in
\hCDO_n^{(2)}$. Since ${\rm Vir}_{c=n}$ has the trivial $\TVect$
module structure, we see we see that $\Phi_{\rm Vir}$ is map of $\TVect$-modules if and only if $\Tilde{X} \cdot L_{-2}$ is zero for all $\Tilde{X}$ in $\TVect$. An immediate calculation shows that closed two-forms act on $L_{-2}$ by zero, thus it suffices to look at $X \cdot L_{-2}$ for $X \in \Vect$. 

Given any element $a \in \hCDO_n^{(2)}$ we obtain a linear map given
by the second Fourier mode
\ben
a_{(2)} : \hCDO_n^{(1)} \to \hCDO_n^{(0)}. 
\een 
For $X \in \Vect$, the element $X \cdot L_{-2} \in \hCDO_n^{(2)}$ thus determines a map $(X \cdot L_{-2})_{(2)} : \hCDO_n^{(1)} \to \hCDO_n^{(0)}$. 

Finally, recall that we have described a map of $\Vect$-modules $\tau_{\Omega^1} : \hOmega^1_n \to \hCDO_n^{(1)}$. It's cokernel is identified with $\hT_n$. That is, there is a short exact sequence of $\Vect$-modules
\ben
0 \to \hOmega^1_n \to \hCDO_n^{(1)} \to \hT_n \to 0 .
\een 

\begin{prop}\label{prop c1 conformal} For each $X \in \Vect$ the linear map $(X \cdot L_{-2})_{(2)} : \hCDO_n^{(1)} \to \hO_n$ factors through the quotient $\hT_n$ 
\ben
\xymatrix{
\hCDO_n^{(1)} \ar[d] \ar[r] & \hO_n \\
\hT_n \ar@{.>}[ur]_{\alpha(X)} &  .
}
\een 
and hence determines an $\hO_n$-linear map $\alpha(X) : \hT_n \to \hO_n$ as in the diagram. Moreover, the assignment $X \mapsto \alpha({X})$ defines a cocycle in $\clie^1(\Vect ; \hOmega^1_n)$ and is cohomologous to the Gelfand-Fuks-Chern class $c^\GF_1(\hT_n) \in \clie^1(\Vect ; \hOmega^1_n)$. 
\end{prop}

\begin{proof}
The fact that $(X \cdot L_{-2})_{(2)}$ factors through $\hT_n$ follows from the following short calculation. 
\begin{lemma} For any $c \in \hCDO_n^{(0)}$ we have $(L_{-2})_{(2)} (T c)$. Similarly, for $X \in \Vect$ one has $(X \cdot L_{-2})_{(2)}(T c) = 0$. 
\end{lemma}
\begin{proof} Set $L = L_{-2}$. Since $T$ is a derivation we have $T(L_{(2)}c) = L_{(2)}(T a) + (T L)_{(2)} a$. Thus $L_{(2)}(T c) = T(L_{(2)} c) - (T L)_{(2)} c$. For conformal dimension reasons we have $L_{(2)} c = 0$, thus $L_{(2)}(Tc) = -(TL)_{(2)} c = 2 L_{(1)} c$, again since $T$ is a derivation. The element $L$ is a Virasoro vector, thus $L_{(1)} = T$, so that $L_{(1)} c = Tc = 0$, since $c$ is of degree zero. Similarly, for $X \in \Vect$, we have $(X \cdot L)_{(2)} (Tc) = L_{(2)}(X \cdot Tc) = L_{(2)}(T X \cdot c))$ as $X$ is a derivation of the vertex algebra.
\end{proof}

We thus obtain a linear map $\alpha : \Vect \to \hOmega^1_n$. We verify that this is equal to $c_1^{\rm GF}(\hT_n)$. The formula for this Chern class is given by
\ben
c_1^{\rm GF}(\hT_n) (X) = \d_{dR}(\partial_i f_i)
\een
where $X = f_i \partial_i \in \Vect$. We utilize the following Borcherds identity for how Fourier modes compose
\ben
(a_{(l)} b)_{(m)} c = \sum_j (-1)^j \begin{pmatrix} l \\ j \end{pmatrix} \left(a_{(l-j)} b_{(m+j)} c - (-1)^l b_{(l+m-j)} a_{(j)} c \right) .
\een
First, we simplify $X \cdot L_{-2} = (f_i(c) b_{-1}^i)_{(0)} (b^k_{-1} T c_0^k)$. Since $x_{(0)} (T c_0^k) = 0$ for any $x$, we see 
\ben
X \cdot L_{-2} = \left((f_i (c) b_{-1}^j)_{(0)} (b_{-1}^k) \right) T c_0^k .
\een
By the Borcherd's formula this simplifies to $(- (b_{-1}^k)_{(0)} (f_i(c))  b_{-1}^j) T c_0^k = - (\partial_k f_i)(c)T c_0^k  b_{-1}^i$. We compute the value of $(X \cdot L_{-2})_{(2)}$ on the generators $b_{-1}^j$. There is only one term in the Borcherd's expansion and it is of the form
\begin{align*}
(X \cdot L_{-2})_{(2)} (b_{-1}^j) & = \left(b_{-1}^i\right)_{(1)} \left( (\partial_k f_i (c) T c_0^k)_{(0)} b_{-1}^j \right) \\ & = - (b_{-1}^i)_{(1)} \left((b_{-1}^j)_{(0)} (\partial_k f_i (c)) T c_0^k \right) \\ & = - \delta^{ki} \partial_j \partial_k f_i .
\end{align*}
Thus $\alpha(X) = c_1^{\GF}(\hT_n)(X)$ and the proof is complete. 
\end{proof}

\subsection{The character of a graded vertex algebra} \label{sec vert character}

In this section we define and compute the ``local character" of the vertex algebra $\hCDO_n$. It will globalize, under Gelfand-Kazhdan descent, to the character of the sheaf of chiral differential operators on a complex manifold $X$. 

\begin{dfn} Let $V$ be a $\ZZ_{\geq 0}$-graded vertex algebra.
The {\em graded character} of $V$ is the following $q$-expansion
\be\label{char1}
\chi (V) := \sum_{N} q^{N} \left(\dim V^{(N)}\right) \in \CC[[q]] .
\ee
\end{dfn}

\begin{rmk} 
When $V$ is a {\em conformal} vertex algebra, there is a slight variant of the graded character that involves the central charge $c$ of $V$. 
If $L_0$ is the zero mode of the Virasoro vector in the conformal vertex algebra, 
the character is defined by ${\rm char}(V) := {\rm Tr}_{V} q^{L_0 - c/24}$. 
The relationship to the graded character we defined in Equation~(\ref{char1}) is given by $q^{-c/24} \chi(V) =  {\rm char}(V) \in q^{-c/24} \CC[[q]]$. 
The reason for this extra factor of $q$ is that $\chi(V)$ has nicer modular properties. 
For more about this modularity, and motivation for the the definition of the character, see~\cite{Zhu}. 
\end{rmk}

We wish to define the graded character of a vertex algebra with an action of a Harish-Chandra pair $(\fg, K)$. 
Suppose $\fg$ acts on a  $\ZZ_{\geq 0}$-graded vertex algebra $V$ by grading-preserving derivations. 
Then, each weight space $V^{(N)}$ is a module for $\fg$. 
The character of the vertex algebra will be a $q$-expansion of equivariant characters of the individual spaces of fixed conformal dimension $V^{(N)}$. 
Thus, it suffices to define what we mean by the character of a $(\fg,K)$-module (in vector spaces). 

For simplicity we work just with the Lie algebra $\fg$. The generalization to a module for the pair $(\fg, K)$ is a small extension of this. For any $\fg$-module $W$, with action $\rho : \fg \to \End(W)$, its Chern character is given by $\ch^\fg(W) = {\rm Tr}\left(\exp(\rho(X)) \right) \in \Sym(\fg^\vee)$. 
Since the trace is conjugation invariant the character determines an element in the Hochschild homology of the algebra $\clie^*(\fg)$:
\[
{\rm ch}^\fg(W) \in {\rm HH}_0\left( \clie^*(\fg) \right) \cong
\cSym (\fg^\vee)^\fg .
\]
There is a way to express this character at the cochain level. For this, it is useful to have an interpretation of the character in terms of Lie algebra cohomology, which will coincide with the Gelfand-Fuks-Chern characters in the case of $(\fg, K) = (\Vect, \GL_n)$. 

Let ${\rm Hoch}_*(-)$ denote the complex of Hochschild chains, computing Hochschild homology. The Hochschild-Rosenberg-Kostant theorem for the commutative ring $R$ posits a quasi-isomorphism of cochain complexes 
\ben
{\rm Hoch}_*\left(R\right) \simeq \Omega^{-*}_{R}
\een
where $\Omega^{-*}_{R}$ is the regraded de Rham complex of the commutative ring $R$. In the case that $R = \clie^*(\fg)$ this quasi-isomorphism takes the form
\ben
{\rm Hoch}_*\left(\clie^*(\fg)\right) \simeq \clie^*\left(\fg ; \bigoplus_{k \geq 0} \Sym^k (\fg^\vee)[k] \right) . 
\een
The definition of the Atiyah class of a $\fg$-module $W$ can be found in \cite{GG1}. This class is an element $\At^\fg(W) \in \Omega^1_{B \fg} \tensor \End(W)$ gives a Chern-Weil description in Lie algebra cohomology of the Chern character above: 
\ben
\ch^\fg(W) = {\rm Tr}\left(\exp \left(\frac{1}{2\pi i} \At^{\fg}(W) \right) \right) .
\een 
We will encounter the Atiyah class later, in Part II. Other characteristic classes also admit a description in terms of this Atiyah class. For instance, the Todd class of the $\fg$-module $W$ is defined to be the determinant of a certain formal series involving the Atiyah class: 
\ben
{\rm Td}^\fg (W) = {\rm det} \left(\frac{1 - e^{- {\rm At}(W)}}{{\rm At}(W)} \right) .
\een 

The {\em Euler class} of the $\fg$-module $W$ is defined to be
\ben
\chi^{\fg} (W) := {\rm Td}^\fg(\fg[1]) \cdot \ch^\fg(W) \in \clie^*\left(\fg ; \bigoplus_{k \geq 0} \Sym^k (\fg^\vee)[k] \right) .
\een
If $W$ is a module for the Harish-Chandra pair $(\fg,K)$ the same construction defines the Euler class in relative Lie algebra cochains $\chi^{(\fg,K)}(W) \in \clie^*\left(\fg,K ; \bigoplus_{k \geq 0} \Sym^k (\fg^\vee)[k]\right)$. 

We now return to the case of a vertex algebra. 

\begin{dfn} 
If a pair $(\fg,K)$ acts on a $\ZZ_{\geq 0}$-graded vertex algebra $V$, 
the $(\fg,K)$-{\em equivariant graded character} of $V$ is the $q$-expansion
\ben
{\rm char}^{(\fg,K)}(V) := \sum_{N \geq 0} q^N \chi^{(\fg,K)} (V^{(N)})
\een 
in~$\clie^*\left(\fg,K ; \bigoplus_{k \geq 0} \Sym^k (\fg^\vee)[k]\right)[[q]]$.
\end{dfn}

%\begin{rmk} Note that ${\rm char}^{(\fg,K)} (V) = {\rm
%    char}^{(\fg,K)}({\rm Gr}(V))$ where ${\rm Gr}(V)$ is the
 % associated graded vertex algebra using the filtration coming from
 % conformal weight. 
%\end{rmk}

\subsubsection{} 

We now turn to computing the character for the main example, 
the $(\TVect,\GL_n)$-equivariant vertex algebra $\hCDO_n$. 
\si
There is one subtlety: the conformal weight spaces of $\hCDO_n$ (and $\CDO_n$) are not finite dimensional. 
They are, however, finite rank over the ring $\hO_n$, 
and so, whenever we count dimensions or take duals, we will do so in a $\hO_n$-linear way.

With this modification, the equivariant graded character of $\hCDO_n$ as a module for $(\TVect, \GL_n)$ will be an element 
\[
\chi^{(\Vect, \GL_n)} (\hCDO_n) \in \clie^*(\TVect , \GL_n ; \hOmega^{-*}_n)[[q]]. 
\]
Here, $\hOmega^{-*}_n$ is the regraded de Rham complex $\bigoplus_{k \geq 0} \hOmega^k_n [k]$ on the formal disk.  

Something important happens here: the tilde has vanished on $\Vect$ so that the character is the image of an element from~$\clie^*(\Vect , \GL_n ; \hOmega^{-*}_n)$.
To justify this location for the character, we use the following argument.

Let $p : \Tilde{\fg} \to \fg$ be a morphism of Lie algebras, and let $\mathfrak{k}$ be its kernel. 
We say that a finite-dimensional $\Tilde{\fg}$-module $V$ is {\em off-diagonal} for $p$ if there is a filtration 
\ben
0 = F^{-1} V \subset F^0 V \subset F^1 V \subset \cdots \subset F^N V = V
\een
such that for all $i$, $\mathfrak{k} \cdot F^i V \subset F^{j} V$ for some $j < i$. 
There is an elementary fact about traces of such modules.

\begin{lemma}
If $V$ is an off-diagonal module for the Lie algebra map $p : \Tilde{\fg} \to \fg$ and $V$ has finite dimension, 
then ${\rm tr}(\exp(x)) = \tr(\exp(p(x)))$ for all $x \in \Tilde{\fg}$. 
\end{lemma}

To see this, choose a filtration for $V$ exhibiting the off-diagonal action, and a pick a basis for $V$ compatible with this filtration. 
In terms of this basis, each element of $\frak{k}$ acts by a matrix that is strictly upper triangular (i.e., off-diagonally), and hence does not contribute to the trace. 

Similarly, we have the following.

\begin{lemma}\label{lem: offdiag}
Let $(\fg, K)$ and $(\Tilde{\fg}, K)$ be Harish-Chandra pairs with $(p, \id) : (\fg, K) \to (\Tilde{\fg}, K)$ a morphism of pairs. 
If $V$ is a finite-dimensional off-diagonal $(\Tilde{\fg},K)$-module,
then $\ch^\fg(V)$ is in the image of the map
\[
p^* : \clie^*\left(\fg,K ; \bigoplus_{k \geq 0} \Sym^k (\fg^\vee)[k]\right) \to  \clie^*\left(\Tilde{\fg},K ; \bigoplus_{k \geq 0} \Sym^k (\fg^\vee)[k]\right) .
\]
\end{lemma}

%We wish to apply this observation to an infinite-dimensional vector space (for us, $\hCDO_n$) and the Gelfand-Fuks character,
%but the operations of exponentiating and taking traces may be ill-defined in the infinite-dimensional setting.
%One must check explicitly that they make sense for the operators of interest.
In our case, we take the map of Lie algebras $p : \TVect \to \Vect$ and the $\TVect$-module $\hCDO_n$.
Note that we will exhibit a filtration of infinite length.
 
Consider the basis of $\hCDO_n$ given by products of elements $c^i_m, b^j_l$. 
Define the filtered subspace $F^q \hCDO_n$ to be the subspace spanned by elements of the form
\ben
c_{m_1}^{i_1} \cdots c_{m_k}^{i_k} b_{l_1}^{j_1} \cdots b_{l_q}^{j_q} .
\een 
It is a quick computation to verify that the action of $\ker(p)=\hOmega^2_{n,cl}$ on the CDOs is off-diagonal for this filtration.

A slight modification of Lemma \ref{lem: offdiag}, which applies to the $q$-graded situation, implies the following. \si

\begin{cor}\label{cor formal char cdo} 
The $(\TVect, \GL_n)$-equivariant graded character of the vertex algebra $\hCDO_n$ is the image of an element 
\ben
\chi^{(\Vect, \GL_n)}(\hCDO_n) \in \clie^*(\Vect , \GL_n ; \hOmega^{-*}_n) [[q]]
\een
along the pull-back $\clie^*(\Vect , \GL_n ; \hOmega^{-*}_n) \to \clie^*(\TVect , \GL_n ; \hOmega^{-*}_n).$
\end{cor}

\def\Td{{\rm Td}}

For the pair $(\fg,K) = (\Vect, \GL_n)$ the Chern character in the previous section coincides with the Gelfand-Fuks-Chern character $\ch^{\GF}(W)$ for any formal vector bundle $W$. 
Set $\Td^{\GF} := \Td^{(\Vect, \GL_n)}$. 

\begin{prop} \label{prop local character} 
The $(\Vect, \GL_n)$-equivariant graded character of $\hCDO_n$ is given by
\ben
\chi^{(\Vect, \GL_n)}(\hCDO_n) = \Td^{\GF} \cdot \ch^{\rm GF} \left(\bigotimes_{l \geq 1} \Sym_{q^l} (\hOmega^1_n \oplus \hT_n) \right)
\een
as an cocycle in $\clie^*\left(\Vect , \GL_n ; \hOmega^{-*}_n\right)[[q]]$.
\end{prop}

\si

\begin{rmk}
Here we use the notation 
\[
\Sym_{q^l}(V) = \bigoplus_{k \geq 0} q^{kl} \Sym^k(V),
\] 
so that
\[
\ch\left(\Sym_{q^l}(V)\right) = \sum_{k \geq 0} q^{kl} \ch\left(\Sym^k(V)\right).
\]
\end{rmk}

\begin{proof}
The conformal dimension zero subspace of $\hCDO_n$ is identified with $\hO_n$ and the conformal dimension one subspace is identified with $\hOmega^1_n \oplus \hT_n$ (all as $\TVect$-modules). The full associated graded of CDOs is given by
\[
\Gr \; \hCDO_n \cong
\underset{{0\leq k}}{\bigotimes} \,\Sym_{\hO_n}(\hOmega^1_n)\,
\otimes \, \underset{{0<
    l}}{\bigotimes} \,\Sym_{\hO_n}(\hT_n) .
\]
Putting this all together we find
\begin{align*}
{\rm char}^{(\TVect, \GL_n)} (\hCDO_n) & = \sum_{N \geq 0} q^N {\rm
                                         ch}^{\GF}\left(\hCDO_n^{(N)}\right)
  \\ & = \ch^{\rm GF} \left(\bigotimes_{N \geq 1} \Sym_{q^N} (\hT_n \oplus
       \hOmega^1_n) \right) 
\end{align*}
as desired.
\end{proof}


\section{Extended Gelfand-Kazhdan descent} \label{sec ext desc}

Our construction of descent in Section \ref{sec gk descent} uses the Harish-Chandra pair $(\Vect, \GL_n)$. 
We have seen, however, that this pair is not appropriate 
if we wish to describe descent for the vertex algebra of chiral differential operators. 
In this section we develop the theory of descent for the pair $(\TVect, \GL_n)$, 
which does act on the vertex algebra, as we saw in the preceding section. 

\subsection{The extended bundle}
The central object in the construction of Gelfand-Kazhdan descent is the coordinated bundle $X^{coor}$. 
This space is a principal bundle for the group of formal automorphisms. 
Using a Gelfand-Kazhdan structure, we obtain from $X^{coor}$ a $\Vect$-valued flat connection on the frame bundle $\Fr_X$. 
In this section, we construct and classify lifts of the bundle $X^{coor}$ 
to an ``extended'' coordinate bundle $\Tilde{X}^{coor}$ on which the extension $\TVect$ acts transitively. 
Together with the choice of an {\em extended} Gelfand-Kazhdan structure (defined in Section \ref{sec ext descent2}), 
this extended bundle will give us the data of a holomorphic $(\TVect, \GL_n)$-bundle with flat connection on the frame bundle of $X$.

\subsubsection{} \label{otherway}
 
The data of a flat $\TVect$-valued connection on $\Fr_X$ is a 1-form
\ben
\Tilde{\omega} \in \Omega^{1,0} (\Fr_X ; \TVect)
\een
satisfying the Maurer-Cartan equation
\ben
\d_{dR} \Tilde{\omega} + \frac{1}{2} [\Tilde{\omega}, \Tilde{\omega}]
= 0
\een 
where $[-,-]$ is the Lie bracket for $\TVect$ extended to the de Rham complex. 
A crucial issue here is that such a structure on the frame bundle does not always exist.

We have already seen that the Gelfand-Fuks-Chern character
$\ch^\GF (\hT_n)$ maps to the ordinary Chern character of a complex
$n$-manifold under the characteristic map 
\ben
{\rm char}_\sigma : \bigoplus_k {\rm H}^k(\Vect , \GL_n ; \hOmega^k_{n,cl}) \to
\bigoplus_k {\rm H}^k(X ; \Omega^k_{X, cl}) 
\een  
associated to a Gelfand-Kazhdan structure~$(X, \sigma)$.
Assuming we have an extension  $\Tilde{X}^{coor}$,
the image of $\Tilde{\omega}$ under the quotient map 
$\Omega^1(\Fr_X ; \TVect) \to \Omega^1(\Fr_X ; \Vect)$ 
is the connection one-form $\omega_\sigma$ defined by the Gelfand-Kazhdan structure. 
Thus, the restriction of the second component of the Chern character $\ch_2^{\GF}(\hT_n)$ to
an element in $\clie^2(\TVect ; \hOmega^2_{n,cl})$ still maps to the
ordinary Chern character $\ch_2(T_X)$ using the characteristic map for
the flat connection~$\Tilde{\omega}$. 

The point here is that in $\clie^2(\TVect ; \hOmega^2_{n,cl})$, 
the element $\ch_2(\hT_n)$ is cohomologically {\em trivial}. 
That is, there
is an element $\alpha_n$ such that $\d_{\rm Lie} \alpha_n = \ch_2(\hT_n)$ where
$\d_{\rm Lie}$ is the differential on $\clie^*(\TVect ;
\hOmega^2_{n,cl})$. By naturality of descent, we see that the image of
$\alpha_n$ under the characteristic map is a trivialization for
$\ch_2(T_X)$. We conclude that lifts exists only if the second
component of the Chern character of
the manifold is trivial. Moreover, we wish to classify such lifts.

\begin{thm}\label{extbundle} 
Fix a Gelfand-Kazhdan structure $\sigma$ on X. 
Then there is a bijection between  lifts of the $(\Vect, \GL_n)$-bundle $(\Fr_X, \omega_\sigma)$ to a $(\TVect, \GL_n)$-bundle 
and trivializations of $\ch_2(T_X) \in H^2(X ; \Omega^{2}_{cl,X})$.
Moreover, if $\ch_2(T_X) = 0$, such lifts are a torsor for $H^1(X; \Omega^{2}_{cl,X})$. 
\end{thm}

Our proof is based on the Dolbeault model for the Chern character, and
throughout this section we will work with Dolbeault representatives for the Atiyah class. 
This approach is well studied and an overview can be found in \cite{atiyah} and \cite{kapranov1999}, 
but we will briefly review the requisite background.

Fix a complex K\"ahler manifold $X$ and a holomorphic vector bundle $E$. 
Also, let $\nabla$ be a smooth connection of type $(1,0)$ on $X$ for a
holomorphic vector bundle $E$. That is, an operator
\ben
\nabla : \sE \to \Omega^{1,0}(X) \tensor \sE .
\een
Let $\nabla ' = \nabla + \dbar$, then $\nabla'$ is an ordinary
connection for $E$. The curvature of $\nabla '$ splits as
\ben
F_{\nabla'} = F_{\nabla '}^{2,0} + F_{\nabla '}^{1,1} \in \Omega^{2,0}(X
; \End(E)) \oplus \Omega^{1,1}(X ; \End(E)) .
\een 
According to the Dolbeault isomorphism 
$H^{p,q}_{\dbar} (X ; E) \cong H^q(X ;  \Omega^p_X \tensor \sE)$, 
one has the following fact about the $(1,1)$-component of the curvature. 

\begin{prop} (Proposition 4 in \cite{atiyah})
The $(1,1)$-form $F_{\nabla'}^{1,1}$ is $\dbar$-closed  and is independent, in Dolbeault cohomology, of the choice of $\nabla$. 
Moreover, the cohomology class $[F_{\nabla'}^{(1,1)}]_{\dbar} \in H^{1,1}(X ; \End(E))$ is a Dolbeault representative for the Atiyah class ${\rm At}(E) \in H^1(X ; \Omega^{1,hol}_X \tensor_{\cO} \End(\sE))$.
\end{prop}

As a corollary, we see that $\Tr \left((F_{\nabla'}^{(1,1)})^k\right)$ is closed for both $\partial$ and $\dbar$. 
Moreover, this $(k,k)$-form is a Dolbeault representative for the
$k$th component of the Chern character $\ch_k(E)$. In particular, trivializations for $\ch_2(T_X)$, as in the theorem, 
are equivalent to $\dbar$-trivializations of the element
$\Tr\left( (F_{\nabla '}^{(1,1)})^2 \right) \in \Omega^{2,2}(X)$. 

\subsubsection{Warm-up: Chern-Simons forms on $\CC^n$}

\def\CS{{\rm CS}}
\def\Tr{{\rm Tr}}

Let us consider an open subset $U \subset \CC^n$ and a hermitian vector
bundle $E$ on $U$. We fix a trivialization $E = U \times E_0$ with $E_0$
equipped with a hermitian inner product. 

%\noindent {\bf Notation Warning:} As a matter of , when we
%write $\Omega^{k,l}$ we mean the space of {\it smooth} $(k,l)$
%forms. When we write $\Omega^{k}_{cl}$ we mean the space of {\it
 % holomorphic} $\partial$-closed $k$-forms.

In this situation, there is a unique connection on $E$ 
that preserves the hermitian inner product compatible with the complex structure. 
With respect to the trivialization, it takes the form
\ben
\d_{dR} + A 
\een
where $A \in \Omega^{1,0}(U ; \End(E_0))$. 
(This connection is usually called the Chern connection.)  
The curvature of the connection is of type $(1,1)$, and it has the form
\ben
F_A = F^{(1,1)}_A = \dbar A 
\een
and lives in $\Omega^{1,1}(U ; \End(E_0))$.

Consider the $(k,k)$-form $\Theta^{(k)}_A := \Tr (F_A^k)$. 
This form is a local representative for the $k$th Chern character. 
For the following calculations, it is convenient to introduce the following complex. 
Define $\Omega^{\geq 2, *} (U)$ to be the complex
\ben
\Omega^{2,*}_{\dbar} (U) \xto{\partial} \Omega^{3,*}_{\dbar}(U) \xto{\partial} \cdots
\een
where $\Omega^{p,*}_{\dbar} (U)$ is the Dolbeault complex of
$(p,*)$-forms with differential $\dbar$. In this complex the degree of a form of type
$(k,l)$ is $k+l - 2$. Equivalently, $\Omega^{\geq 2, *}$ is the total complex of the
double complex $(\Omega^{\geq 2, *}, \partial, \dbar)$. 

There is an obvious embedding
\ben
\Omega^{2,hol}_{cl}(U) \hookrightarrow \Omega^{\geq 2, *} (U)
\een 
where $\Omega^{2,hol}_{cl}(U)$ is concentrated in degree zero. This is a quasi-isomorphism by using Poincar\'e lemma for the operators
$\partial$ and $\dbar$ for the open set
$U$ together with the obvious spectral sequence. (Note that the left hand side is concentrated in cohomological
degree zero)

A direct calculation shows that $\Theta^{(k)}_A$ is both $\partial$ and
$\dbar$-closed. 
In fact, we will use a
preferred one given by the Chern-Simons functional. 
\si
In the case $k = 2$ we evaluate the usual Chern-Simons functional on the Chern connection $A$: consider the $3$-form
\begin{align*}
\CS (A) & = {\rm Tr}\left(A \wedge \d A + \frac{2}{3} A \wedge A \wedge A \right) \\ & = {\rm Tr}\left(A \wedge \dbar A + A \wedge \partial A + \frac{2}{3} A \wedge A \wedge A \right) \\
& = {\rm Tr}\left(A \wedge \dbar A - \frac{1}{3} A\wedge A \wedge A\right)
\end{align*}
using $\partial A + A \wedge A = 0$. 
Note that $\CS (A)$ is an element in $\Omega^{\geq 2, *} (U)$ of cohomological degree one. 
By construction $\d\CS(A) =\Theta^{(2)}_A$, 
where $\d$ is the total differential on the complex. 

We are interested in how the Chern-Simons form interacts with other trivializations of $\Theta^{(2)}_A$. 
Let us fix another trivialization $\alpha \in \Omega^{\geq 2, *} (U)$ of $\Theta^{(2)}_A$ 
such that $\d \alpha = \Theta^{(2)}_A$. 
Notice that the element $\alpha - \CS(A)$ is a closed element of degree one in the complex $\Omega^{\geq 2, *} (U)$. 
Thus, there exists an element $\beta \in \Omega^{\geq 2, *} (U)$ of cohomological degree zero, i.e., a $(2,0)$-form
such that
\ben
\d \beta = \alpha - \CS (A) .
\een
The ambiguity in choosing such a $\beta$ is precisely the cohomology
of the complex which we already determined to be
$\Omega^{2,hol}_{cl}(U)$. That is, if $\omega$ is a closed holomorphic
two-form then $\beta + \omega$ satisfies 
\ben
\d (\beta + \omega) = \d \beta = \alpha - \CS (A) .
\een
More precisely, given a trivialization $\alpha$ the space of all such $\beta$ is a torsor for
$\Omega^{2,hol}_{cl}(U)$. 

Before we proceed to the formal situation, and the construction of the extended coordinated bundle, 
we need to understand how all of the trivializations above change as we make a gauge transformation. 

Suppose that our holomorphic vector bundle $E$ is $TU$, the holomorphic tangent bundle. 
Given a biholomorphism $f : U \to U$, we obtain a gauge transformation of $A$ to the new connection
\ben
f \cdot A := g^{-1} A g + g^{-1} \partial g,
\een
where $g = Jac(f)$ is the Jacobian of $f$. 

\begin{lemma}\label{cs formula} 
There is a $(2,0)$-form $\rho$ depending on $f$ and $A$ such that
\ben
\CS(A) - \CS(f \cdot A) = \d \rho.
\een 
\end{lemma}

\begin{proof} 
For the existence of such a $\rho$, it suffices
to show that the difference $\CS(A) - \CS(f \cdot A)$ is closed. Indeed, under a gauge
transformation the Chern-Simons
functional becomes
\ben
\CS(f \cdot A) = \CS(A) + \d \Tr(g^{-1} \partial g \wedge A) + \frac{1}{3}
\Tr\left( (g^{-1} \partial g)^3\right) .
\een
Now $\Tr((g^{-1} \partial g)^3)$ is both $\partial$ and $\dbar$
closed, so the result follows.
\end{proof}

\begin{rmk} The $2$-form $\rho$ is only unique up to a holomorphic closed
$2$-form. We will need to fix one in the next section when we define
the extended bundle.
\end{rmk}

%With respect to our trivialization, however, we can choose
%our favorite one. 

% \begin{lemma} Given $f$ and $A$ as above define the $(2,0)$ form
% \ben
% \rho_{f, A} = \Tr(g^{-1} \partial g \wedge A) + \# \Tr(g^{-1} \partial
% g g^{-1} \partial g) \in \Omega^{2,0}(U) .
% \een
% Then $\d \rho_{f,A} = \CS(A) - \CS(f \cdot A)$.
% \end{lemma}

\subsubsection{Formal coordinates}

There is a completely formal version of the above trivializations, and
we will use it to construct the bundle $X^{coor}_\alpha$ extending the
ordinary coordinate bundle.

Let $\varphi$ be a formal holomorphic coordinate around a point $x \in X$. 
In the construction of the coordinate bundle, 
we viewed a formal holomorphic coordinate as a map $\varphi : \hD^n \to X$ where $\hD^n$ is the holomorphic formal disk. In this section we view this coordinate as a ``holomorphic" map $\varphi : \hD^n_{\CC} \to X$ 
where $\hD^n_{\CC}$ denotes the {\em complex} formal disk in the sense that its ring of functions is
\ben
\cO(\hD^n_{\CC}) = \CC \ll t_1,\ldots, t_n, \Bar{t}_1,\ldots, \Bar{t}_n \rr  .
\een
Similarly to the non-formal case, we denote the full de Rham complex by
\ben
\hOmega^{*,*}_{n} := \left(\CC \ll t_1,\ldots, t_n, \Bar{t}_1,\ldots, \Bar{t}_n \rr \tensor \CC[\d t_i, \d \Bar{t}_j], \d_{dR} \right)
\een
where $\d t_i$, $\d \Bar{t}_j$ are placed in cohomological degree one. 
In this section, to stress holomorphic dependence, we denote by $\hOmega^{k,hol}_{n,cl}$ 
the space of holomorphic closed $k$-forms on $\hD^n$, 
i.e., $\partial$-closed $k$-forms depending only on the formal variables~$\{t_i\}$.  

\begin{notation} 
In this section we will denote the full de Rham differential by
\ben
\d_{dR} : \hOmega^{*,*}_n \to \hOmega^{*,*}_n
\een
and write $\d_{dR} = \partial + \dbar$ where $\partial$, $\dbar$ are
the formal Dolbeault operators. 
\end{notation}

We define the truncated de Rham complex $\hOmega^{\geq 2, *}_n$ to be
\ben
\hOmega^{2, *} \xto{\partial} \hOmega^{3,*} \xto{\partial} \cdots  .
\een 
Its differential will be
denoted by $\d$. Note that we still have a quasi-isomorphism at the
formal level
\ben
\hOmega^{2,hol}_{n,cl} \xto{\simeq} \hOmega^{\geq 2, *}_n
\een 
by the formal Poincar\'{e} lemma. 

Fix a K\"ahler manifold $X$ and equip the holomorphic tangent bundle
with the associated Chern connection $\nabla$. Let us also fix a global trivialization
$\alpha$ of the second component of the Chern character of $T_X$. 

Pulling back to the formal disk via the coordinate $\varphi : \hD^n_{\CC} \to X$, 
we can write the connection in the form $\d_{dR} + A_\varphi$,
where $A _\varphi \in \hOmega^{1,0}_{n} \tensor \End(\CC^n)$ is the formal connection one-form. 
Just as above, the degree two element
\ben
\Hat{\Theta}^{(2)}_{A_\varphi} = \Tr((\dbar A_\varphi )^2) \in
\hOmega^{\geq 2, *}_n 
\een 
is a representing form for $\Theta_{\nabla}^{(2)}$ on the formal disk.
Note that this element is both $\partial$ and $\dbar$-closed. 
Let $\Hat{\CS}(A) \in \hOmega^{\geq 2, *}_n$ be the corresponding Chern-Simons form on the formal disk. 

\begin{rmk}\label{rmk: closed2}
It is here that we see the explicit appearance of closed $2$-forms, or really its natural resolution. \si
\end{rmk}

For each formal coordinate $\varphi$, 
the trivialization $\alpha$ of $\Theta^{(2)}_X$ determines a formal trivialization 
$\Hat{\alpha}_\varphi \in \hOmega^{\geq 2, *}_n$ satisfying  $\d \Hat{\alpha}_\varphi =~\Hat{\Theta}^{(2)}_{A_\varphi}$. 
Just as above, the difference $\Hat{\alpha}_\varphi - \Hat{\CS} (A_\varphi)$ is $\d$-closed and hence
there exists a $\beta_\varphi \in \hOmega^{2,0}_n$ such that $\d \beta = \Hat{\alpha}_\varphi -~\Hat{\CS} (A_\varphi)$. 

\begin{dfn} 
The \emph{extended coordinate bundle} $X^{coor}_\alpha$ is the set of pairs
\ben
(\varphi, \beta_\varphi)
\een
where $\varphi : \hD^n_{\CC} \to X$ is a formal coordinate
and $\beta_\varphi \in \hOmega^{2,0}_{n}$ satisfies 
\ben
\d \beta_\varphi = \Hat{\alpha}_{\varphi} - \Hat{\CS}(A_\varphi) 
\een
in the cochain complex $\hOmega^{\geq 2, *}_n$.
\end{dfn}

\subsubsection{Defining the bundle}

We have just defined the {\em set} corresponding to the extended
bundle. We now show that it is a principal bundle on $X$ for the group
$\Tilde{\Aut}_n$ lifting the coordinate bundle $X^{coor}$. 

Before we define the action of $\TAut_n$ we make the following
observations. Given a formal coordinate $\varphi$ and an automorphism
$f \in \Aut_n$ we obtain a new formal coordiante $f^* \varphi =
\varphi \circ f$. If $A_\varphi$ is the connection one-form
corresponding to $\varphi$ then $A_{f^* \varphi}$ is given by the
gauge transformation
\ben
A_{f^*\varphi} = g^{-1} A_\varphi g + g^{-1} \partial g .
\een
where $g = Jac(f) \in \GL_n(\hO_n)$ is the Jacobian. Just as in the
proof of Lemma \ref{cs formula} we have
\ben
\Hat{\CS}(A_\varphi) - \Hat{\CS}(A_{f^*\varphi}) = \d \Tr(g^{-1} \partial g \wedge A) + \frac{1}{3}
\Tr\left( (g^{-1} \partial g)^3\right)  .
\een
The $3$-form $\Hat{\chi}^{WZW}(f) := \frac{1}{3}
\Tr\left( (g^{-1} \partial g)^3\right)$ is $\partial$-closed, and
hence we may choose a non-unique cobounding two-form. Explicitly, the
choice of a formal coordinate determines a homotopy
\ben
h : \hOmega^{k,hol}_n \to \hOmega^{k-1,hol}_n
\een
and we define $\Hat{\mu}_f := h (\Hat{\chi}^{WZW}(f))$. Note that $\mu_f$
does {\em not} depend on the coordinate $\varphi$. Finally, let 
\ben
\Hat{\rho}_{f,\varphi} := \Tr(g^{-1} \partial g \wedge A_\varphi) + \mu_f,
\een 
which lies in $\hOmega^{2,0}_n$.

Recall that the group $\Tilde{\Aut}_n$ consist of pairs $(f, \omega)$
with $f \in \Aut_n$ an automorphism of the holomorphic formal disk
and with $\omega \in \hOmega^2_{n,cl}$. For a pair $(\varphi,
\beta_\varphi)$ as in the definition above, define
\be\label{extended coords1}
f \cdot (\varphi, \beta_\varphi) := (f^* \varphi, f^* \beta_\varphi + \Hat{\rho}_{f,\varphi}) .
\ee
and
\be\label{extended coords2}
\omega \cdot (\varphi, \beta_\varphi) := (\varphi , \beta_\varphi + \omega) .
\ee
Here $f^* \varphi = \varphi \circ f$ is precomposition with the
automorphism $f$, i.e., change of coordinates, and $f^* \beta_\varphi$ is
the pull-back of forms. 

\begin{prop}\label{lift1} 
Equations (\ref{extended coords1}) and (\ref{extended coords2}) define an action of $\Tilde{\Aut}_n$ on $X^{coor}_\alpha$. Moreover, it induces the structure of a $\Tilde{\Aut}_n$-principal bundle $\pi^{coor}_\alpha :X^{coor}_\alpha \to X$ lifting the $\Aut_n$-principal bundle $\pi^{coor}:~X^{coor}~\to~X$.
\end{prop}

\begin{rmk} Note that the choice of $\Hat{\rho}_{f, \varphi}$ is
  only unique up to a closed holomorphic $2$-form on the formal disk. That is, for each $\eta \in \hOmega^2_{n,cl}$ we get a different action of $\Tilde{\Aut}_n$ defined by
\ben
f \cdot (\varphi, \beta_\varphi) := (f^*\varphi, f^* \beta_\varphi + \Hat{\rho}_{f,\varphi} + \eta) .
\een
This action is equivalent to the original action. Indeed, denote $\Tilde{X}^{coor}_\alpha$ with this new action determined by $\eta$ by $\Tilde{X}^{coor}_{\alpha,\eta}$. For any two closed $2$-forms $\eta,\eta'$ we define
\[
\begin{array}{cccc}
\Phi_{\eta,\eta'} : & \Tilde{X}^{coor}_{\alpha,\eta} & \to& \Tilde{X}^{coor}_{\alpha,\eta'}\\
&(\varphi, \beta_\varphi)& \mapsto &(\varphi, \beta_\varphi + \eta - \eta')
\end{array}.
\]
Then $\Phi_{\eta,\eta'}$ is a map of $\Tilde{\Aut}_n$-spaces. In fact, it is an isomorphism with inverse given by $\Phi_{\eta',\eta}$. Hence we have an isomorphism of principal $\Tilde{\Aut}_{n}$-bundles.
\end{rmk}

The proof of the proposition is a direct calculation. First, we show that the map is well defined at the level of sets. That is, for any $f$ we must show that $f \cdot (\varphi, \beta_\varphi) \in \Tilde{X}^{coor}_\alpha$. We have 
\begin{align*}
\d(f^* \beta_\varphi + \Hat{\rho}_{f, A_\varphi}) 
& =  f^* \d \beta_\varphi + \d\Hat{\rho}_{f, A_\varphi} \\ 
& =  f^*(\varphi^* \alpha - \Hat{CS}(A_{\varphi})) + (f^* \Hat{\CS}(A_\varphi) - \Hat{\CS}(f^* A_{\varphi})) \\ 
& =  f^*\varphi^* \alpha - \Hat{\CS}(f^*A_{\varphi}) .
\end{align*}
Thus $f^* \beta_\varphi + \Hat{\rho}_{f,\varphi}$ trivializes the difference of the Chern-Simons functional associated to $f^*A_{\varphi}$ and the original trivialization as desired. 

It remains to see that we have an action by $\Tilde{\Aut}_n$. 
It suffices, in fact, to show that for any $f_1,f_2 \in \Aut_n \subset~\Tilde{\Aut}_n$,
\be\label{action1}
f_1 \cdot \left(f_2 \cdot(\varphi, \beta_\varphi)\right) = (f_2 \circ f_1) \cdot \left(f_2 \cdot(\varphi, \beta_\varphi)\right) + (\varphi, \beta_\varphi + \alpha_{GMS}(f,g)) ,
\ee
where $\Tilde{\alpha}_{GMS}$ is the defining cocycle for the extension
(\ref{grpses}) defined in Section \ref{sec GMScocycle}. 

Expanding the left-hand side, we have
\ben
\left(f_1^* f_2^*\varphi, f_1^*f_2^* \beta_\varphi + f_1^* \Hat{\rho}_{f_2,\varphi} + \Hat{\rho}_{f_1, f_2^* \varphi}\right) .
\een
The last term $\Hat{\rho}_{f_1, f_2^* \varphi}$ has the following meaning. 
Choose any (macroscopic) automorphism $\Tilde{f}_2 : \CC^n \to \CC^n$ whose $\infty$-jet class is $f_2$, 
and look at the element $\Hat{\rho}_{f_1, \Tilde{f}_2^* \varphi}$. 
Since $\Hat{\rho}_{f, \psi}$ only depends on the power series expansion of $\psi$, 
this element is well defined and does not depend on the lift~$\Tilde{f}_2$.

Now the right-hand side of (\ref{action1}) is
\ben
\left((f_2 \circ f_1)^* \varphi, (f_2 \circ f_1)^* \beta_\varphi + \rho_{f_2 \circ f_1, A_{\varphi}} + \Tilde{\alpha}_{GMS} (f_1,f_2)\right) .
\een 
Thus, to verify we have an action and finish the proof of Proposition \ref{lift1}, 
it suffices to prove the following.

\begin{lemma}
The cocycle $\Tilde{\alpha}_{GMS}$ satisfies
\be\label{rhoeqn}
\Tilde{\alpha}_{GMS}(f_1,f_2) = \Hat{\rho}_{f_1,f_2^* \varphi} + f_1^*
\Hat{\rho}_{f_2, A_\varphi} - \Hat{\rho}_{f_2 \circ f_1, A_\varphi}  .
\ee
for any $f,g$ in $\Aut_n$. 
\end{lemma}
\begin{proof}
We recall the formula for the GMS 2-cocycle from Section \ref{sec GMScocycle}. 
In the notation from that section it reads
\ben
\Tilde{\alpha}_{GMS}(f_1,f_2) = \alpha_2(f_1,f_2) + \mu_{f_1} + f_1^* \mu_{f_2} -
\mu_{f_2 \circ f_1} .
\een
(We use $\partial$ this time and not $\d_{dR}$ to stress that it is
the holomorphic differential.) We expand the right-hand side of
Equation~(\ref{rhoeqn}):
\begin{align*}
\tr((\D f_1)^{-1} \partial \D f_2 A_{f_2^* \varphi}) 
+ f_1^*\tr((\D f_2)^{-1} \partial \D f_2 A_\varphi) &
- \tr( (f_1^*\D f_2 \D f_1)^{-1} \partial(f_1^*\D f_2 \D f_1) A_\varphi) 
\\+ \mu_{f_1} 
+ f_1^*\mu_{f_2} 
- \mu_{f_2 \circ f_1} .
\end{align*} 
We have used the fact that the Jacobian of $f_2 \circ f_1$ is given by
the product $f_1^*\D f_2 \D f_1$. Finally, to complete the proof we notice
that the first three terms in the above formula simplify to 
\[
\alpha_2(f_1,f_2) = \tr \left(g_1^{-1} \partial \D f_1 \wedge
  f_1^*(\partial \D f_2 (\D f_2)^{-1}) \right)
\]
and so we are done.
\end{proof}

\subsubsection{Proof of Theorem \ref{extbundle}} \label{sec ext descent2}
 
In this section we prove the theorem. 
We will use the data of an extended coordinate bundle to construct a Gelfand-Kazhdan structure for the frame bundle
$\Fr_X \to X$, with a connection one-form valued in the
extension~$\TVect$. 

Clearly, the action of $\TAut_n$ on the set of pairs $(\varphi,
\beta_\varphi)$ lifts the action of $\Aut_n$ on formal
coordinates $\varphi : \hD^n \to X$. This observation, together with the compatibility of the cocycle $\Tilde{\alpha}_{GMS}$ and the Gelfand-Fuks-Atiyah
cocycle $\ch^{\GF}_2(\hT_n)$ defining the extension $\TVect \to
\Vect$, allows us to
summarize the construction of previous section as follows.

\begin{prop} 
For each trivialization $\alpha$ of $\Theta^{(2)}_X$
there exists a transitive action of $\TVect$ on $\Tilde{X}^{coor}_\alpha$ that lifts the action of $\Vect$ on $X^{coor}$. 
That is, there is a map of Lie algebras
\ben
\Tilde{\theta}_\alpha : \TVect \to \cX(\Tilde{X}^{coor}_\alpha)
\een
such that for each $(x, \varphi, \beta_\varphi) \in \Tilde{X}^{coor}_\alpha$, 
the induced map $\Tilde{\theta}(x) : \TVect \to T_{(x, \varphi, \beta_\varphi)} \Tilde{X}^{coor}_\alpha$ is an isomorphism and the diagram
\ben
\xymatrix{
\TVect \ar[d] \ar[r]^-{\Tilde{\theta}_\alpha (x)} & T_{ (x, \varphi, \beta_\varphi)} \Tilde{X}^{coor}_\alpha \ar[d] \\ 
\Vect \ar[r]^-{\theta(x)} & T_{(x, \varphi)} X^{coor} .
}
\een
commutes.
\end{prop}

The inverse of $\Tilde{\theta}_\alpha$ defines a connection one-form
$\Tilde{\omega}_\alpha \in \Omega^1(\Tilde{X}^{coor}_\alpha ; \TVect) .$
Now, $\Tilde{X}_\alpha^{coor}$ is an $\hOmega^2_{cl,n}$-torsor over
$X^{coor}$ and so there exists a $\Aut_n$-equivariant smooth section
$\sigma_{\Omega^2} : X^{coor} \to \Tilde{X}^{coor}_\alpha.$
Note that this section is {\em not} unique, but its choice will not matter in the end 
(much as in the case of an ordinary Gelfand-Kazhdan structure). 
Given such a section we have an induced map
\ben
\Omega^1(\Tilde{X}^{coor}_\alpha ; \TVect) \xto{\sigma_{\Omega^2}^*}
\Omega^1(X^{coor} ; \TVect) \xto{p} \Omega^1(X^{coor} ; \Vect) ,
\een
where $p : \TVect \to \Vect$ is the projection. Under this composition, the 1-form $\Tilde{\omega}_\alpha^{coor}$ maps
to the Grothendieck connection 1-form $\omega^{coor} \in
\Omega^1(X^{coor} ; \Vect)$. 

Now, we would like to apply the theory of Gelfand-Kazhdan descent to this
situation. Recall that in the case of the pair $(\Vect, \GL_n)$, a
Gelfand-Kazhdan structure amounted to choosing a formal
exponential. That is, a $\GL_n$-equivariant splitting $\sigma : \Fr_X \to X^{coor}$
of the projection $\pi^{coor} : X^{coor} \to~\Fr_X$. 

Fixing a section $\sigma_{\Omega^2}$ of the $\Omega^2_{n,cl}$-torsor
over $X^{coor}$ as above,  we can compose with the canonical section
$\sigma_{\Omega^2} : X^{coor} \to \Tilde{X}_\alpha^{coor}$ of
$\Tilde{X}^{coor}_\alpha$ over $X^{coor}$ to get the section
$\sigma_{\Omega^2} \circ \sigma$. This composite defines the connection
one-form
\ben
\Tilde{\omega}_{\sigma, \sigma_{\Omega^2}}^\alpha = (\sigma_{\Omega^2} \circ \sigma)^*
\omega^{coor} = \sigma^* \sigma_{\Omega^2}^* \omega^{coor}
\een
living  in $\Omega^1(\Fr_X; \TVect)$.

\begin{dfn} 
An {\em extended Gelfand-Kazhdan structure} on $X$ is a triple $(\alpha, \sigma, \sigma_{\Omega^2})$ where
\begin{itemize}
\item[(i)] $\alpha$ is a trivialization for the second component of the
Chern character of $X$;
\item[(ii)] $\sigma$ is a Gelfand-Kazhdan structure on $X$; and
\item[(iii)] $\sigma_{\Omega^2}$ is an $\Aut_n$-equivariant smooth splitting of
  $\Tilde{X}^{coor}_\alpha \to X^{coor}$ .
\end{itemize}
\end{dfn}

The construction in the above paragraph shows that the data of an
extended Gelfand-Kazhdan structure on $X$ determines a holomorphic
$(\TVect, \GL_n)$-bundle on $\Fr_X \to X$ with flat connection
one-form given by~$\Tilde{\omega}_{\sigma, \sigma_{\Omega^2}}^\alpha$.

The same argument as in the non-extended case (see Section \ref{gauge equiv}) gives the following.

\begin{lemma} 
Fix a Gelfand-Kazhdan structure $\sigma$. 
Let $\sigma^1_{\Omega^2}$ and $\sigma^1_{\Omega^2}$ be two smooth splittings of $\Tilde{X}^{coor}_\alpha \to X^{coor}$. 
Then the induced connection one-forms $\omega^{\alpha}_{\sigma, \sigma_{\Omega^2}^1}$ and $\omega^\alpha_{\sigma,\sigma_{\Omega^2}^2}$ are gauge equivalent.
\end{lemma}

To finish the proof of Theorem \ref{extbundle}, we must go the other way: 
given a lift $(\Fr_X, \Tilde{\omega})$ of the $(\Vect, \GL_n)$-bundle $(\Fr_X, \omega_\sigma)$, 
we must produce a trivialization. 
This construction is outlined above in Section \ref{otherway}. 
It is a direct calculation to show that these two constructions are
inverse to each other. 

Before we define extended descent, we discuss the class of modules that we wish to consider.

\subsection{Extended modules}

We have defined the category of ``vector bundles" on the formal disk $\VB_n$. 
These Harish-Chandra modules were especially well behaved from the point of view of Gelfand-Kazhdan descent. 
In this section we consider an analogue of this category of modules for the pair $(\TVect, \GL_n)$. 
These modules will be objects that descend along the extended bundle~$(\Fr_X, \Tilde{\omega}^\alpha_{\sigma})$. 

Since $\TVect$ is an extension of Lie algebras, 
it has a two-step filtration 
\ben
F^1 \TVect = \TVect \supset F^0 \TVect = \hOmega^2_{cl} .
\een 
The associated graded of this filtration is the Lie algebra $\Vect
\oplus \hOmega^2_{cl}$. 

Let $\Mod_{(\TVect, \GL_n)}^{\rm fil}$ denote the category of filtered modules for the pair $(\TVect,\GL_n)$, 
using the filtration above. 
Given any such module $\cV$, we can consider its associated graded ${\rm Gr} \; \cV$. 
This associated graded forgets down to a graded module for the Lie algebra $\Vect$. 
Since $\cV$ also has a compatible $\GL_n$-action,
the associated graded has the structure of a graded $(\Vect, \GL_n)$-module. 
There is thus a functor 
\ben
\Gr: \Mod_{(\TVect, \GL_n)}^{\rm fil} \to \Mod_{(\Vect, \GL_n)}^{\ZZ/2}
\een
given by taking the associated graded for the two-step filtration. 
Here, $\Mod_{(\Vect, \GL_n)}^{\ZZ/2}$ is the category of $\ZZ/2$-graded vector spaces 
together with a grading-preserving action of the pair~$(\Vect, \GL_n)$. 

Similarly, there is a full sub-category $\VB_n^{\ZZ/2} \subset \Mod_{(\Vect, \GL_n)}^{\ZZ/2}$ 
consisting of those $(\Vect,\GL_n)$-modules that are also elements in $\VB_n$ by forgetting the grading. 

\begin{dfn} 
The category $\Tilde{\VB}_n$ of {\em filtered $(\TVect, \GL_n)$-vector bundles} 
is the pull-back
\ben
\xymatrix{
\Tilde{\VB}_n\ar[r] \ar[d] & \VB^{\ZZ/2}_n \ar[d] \\
\Mod_{(\TVect, \GL_n)}^{\rm fil} \ar[r] & \Mod^{\ZZ/2}_{(\Vect, \GL_n)} 
}
\een 
of categories.
\end{dfn}

Explicitly, an object of $\Tilde{\VB}_n$ is a $\ZZ/2$-graded $\hO_n$-module 
that is free and finite rank together with a compatible action of $(\TVect, \GL_n)$ that respects the two-step filtration of~$\TVect$.

%One defines a slightly larger category $\Hat{\Tilde{\VB}}_{(\Vect,\GL_n)}$ by adjoining countable products and direct sums.

\subsection{Extended descent}

We are now in a place to define the extended Gelfand-Kazhdan descent
functor for modules as in the previous section. 

Define the category $\Tilde{\Hol}_n$ to have objects consisting of pairs $(X, \alpha)$,
where $X$ is a complex manifold of dimension $n$ and $\alpha$ is a
trivialization of its second component of the Chern character $\ch_2(T_X)$. Morphisms
are defined to be local biholomorphisms that pull-back
trivializations. For instance, if $(X,\alpha_X)$ and $(Y,\alpha_Y)$
are objects and $f : X \to Y$ is a local biholmorphism, we require $f^*
\alpha_Y = \alpha_X$. We let $\Tilde{\GK}_n$ denote the category fibered over $\Tilde{\Hol}_n$ whose objects over $(X,\alpha)$ are extended Gelfand-Kazhdan structures $(X,\alpha, \sigma, \sigma_{\Omega^2})$.

\begin{dfn} The {\em extended Gelfand-Kazhdan descent} is the functor
\ben
\Tilde{\desc}_{\GK} : \Tilde{\GK}_n^{op} \times \Tilde{\VB}_n
\to {\rm Pro}(\VB(X)_{flat})
\een
sending an extended Gelfand-Kazhdan structure $(X, \alpha, \sigma, \sigma_{\Omega^2})$ and an extended module $\cV \in \Tilde{\VB}_n$ to the pro-vector bundle $\Fr_X \times^{\GL_n} \cV$ with flat connection induced from $\omega_{\alpha, \sigma, \sigma_\Omega^2}$.
\end{dfn} 

Let $\Tilde{\bdesc}_{\GK}(X, \sigma, \sigma_{\Omega^2},\alpha; \cV)$ denote
the corresponding $\Omega^*(X)$-module. Since different
choices of sections $\sigma$ and $\sigma_{\Omega^2}$ determine gauge
equivalent connections the resulting sheaf of flat sections is independent of such choices and
we will denote the sheaf by $\sdesc_{\GK}(X, \alpha; \cV)$. 

% \brian{We can probably define a category $\Tilde{\Hol}_n$ which consists of complex manifolds of dimension $n$ together with a trivialization $\alpha$. Morphisms are biholomorphisms that pull-back trivializations. Then there is a category $\Tilde{\GK}$ fibered over $\Tilde{\Hol}_n$ given by a pair $(X, \alpha)$ together with a choice of GK-structure as before. The category $\VB_{flat}$ pulls back to $\Tilde{\VB}_{flat}$ consisting of flat vector bundles on manifolds with trivialization. So it looks like we should write something like
% \ben
% \Tilde{\desc} : \Tilde{\GK}^{op} \times \VB_{(\TVect, \GL_n)}^{\rm fil} \to {\rm Pro}(\Tilde{\VB}_{flat})
% \een
% that sends a triple $(\Fr_X, \alpha, \sigma)$ together with filtered module $\cV$....
% }

\section{Descent for vertex algebras} \label{sec vertex desc}

In this section we discuss Gelfand-Kazhdan descent for vertex
algebras. Namely, we show how the structure of a vertex algebra that
has a compatible action of a pair $(\fg, K)$ descends to a sheaf of
vertex algebras on complex manifolds via the functors we have already
constructed. Of course, the most important cases will be the pairs
$(\Vect, \GL_n)$ and its extension $(\TVect, \GL_n)$. 

For another approach for constructing sheaves of vertex algebras on manifolds, 
see \cite{Malikov2008},  although the case of extended descent is not covered there. 

For a \v{C}ech style approach to constructing the sheaf of vertex
algebras given by CDOs, see~\cite{GMS2}. 

\subsection{General descent} 
\label{gendescent}

We will define descent for vertex algebras in a
similar way as in the general setting of Harish-Chandra descent. For this
to make sense, we need to first say what we mean by a vertex algebra
in the differentially graded setting. 

\begin{dfn} 
A {\em dg vertex algebra} is a $\ZZ$-graded vertex algebra $V$ 
together with a vertex algebra derivation $\d : V \to V$ of degree 1 such that
\begin{itemize}
\item[(i)] $\d^2 = 0$ and
\item[(ii)] the structure maps $Y(-; z) : V \to \End(V) \ll z^\pm \rr$ have cohomological degree zero.
\end{itemize}
Moreover, if $V$ has the additional structure of a $\ZZ_{\geq 0}$-graded vertex algebra 
(by what we call the dimension grading), 
a {\em dg $\ZZ_{\geq 0}$-graded vertex algebra} is a dg vertex algebra such that
$\d$ preserves the dimension grading. 
\end{dfn}

Consider now a torsor $P \to X$ for a Harish-Chandra pair $(\fg, K)$. 
If $V$ is a vertex algebra on which $K$ acts via vertex algebra automorphisms, 
then invariants for this group action will be a sub-vertex algebra. 
Likewise, if $\fg$ acts on $V$ via vertex algebra derivations,
then the induced connection $\nabla^{P,V} = \d_{dR} + \rho_\fg(\omega)$ also acts by vertex algebra derivations on $\Omega^*(P) \tensor V$. 
If we choose actions that are compatible (as well as $\ZZ_{\geq 0}$-graded) we
obtain the following. 

\begin{prop} 
If $(\fg,K)$ acts on the vertex algebra then $\bdesc((P, \omega, V))$
has the structure of a dg vertex algebra in $\Omega^*(X)$-modules. 
If $(\fg, K)$ acts on the $\ZZ_{\geq 0}$-graded vertex algebra $V$,
then $\bdesc((P, \omega), V)$ has the structure of a dg $\ZZ_{\geq 0}$-graded vertex algebra in dg $\Omega^*(X)$-modules.
\end{prop}

This result implies that the sheaf of flat sections $\sdesc((P, \omega), V)$
has the structure of a sheaf of $\ZZ_{\geq 0}$-graded vertex
algebras. 

\subsection{Formal vertex algebras}

We now develop what we mean by vertex algebras in the category of
formal vector bundles. The vertex algebras we are interested in are not finite dimensional,
so are ill-behaved in the context of doing ordinary Harish-Chandra
descent. The graded pieces, however, are finite dimensional over $\hO_n$, so we are in a similar context of Gelfand-Kazhdan descent as in Section 2.

Recall, that the category of formal vector bundles (or formal vector bundles on the formal $n$-disk) $\VB_n$ consists of
$\hO_n$-modules together with a compatible structure of a $(\Vect,
\GL_n)$-module. The category of formal vertex algebras we consider is a modest generalization of the category of formal vector bundles
$\VB_n$. 

\begin{dfn}
A {\em Gelfand-Kazhdan vertex algebra} is a $\ZZ_{\geq 0}$-graded vertex
algebra $\cV$ together with an
action of $(\Vect, \GL_n)$ as in Definition \ref{graction} such that
for each $N \geq 0$ one has a $\GL_n$-equivariant identification
\be\label{GK vert}
\cV^{(N)} = \hO_n \tensor_\CC V^{(N)}
\ee
where $V^{(N)}$ is a finite dimensional $\GL_n$-representation. A {\em morphism} of Gelfand-Kazhdan vertex algebras is a $(\Vect, \GL_n)$-equivariant morphism of $\ZZ_{\geq 0}$-graded vertex algebras.
We denote this category by~${\rm Vert}_n$. 
\end{dfn}

Thus, a Gelfand-Kazhdan vertex algebra is a vertex algebra in the category of
Harish-Chandra modules $\Mod_{(\Vect, \GL_n)}$ together with some
finiteness property. 

\begin{lemma}\label{lemma GK vert gr} The vertex algebra $\Gr \; \hCDO_n$ has the structure of a formal vertex
  algebra. 
\end{lemma}
\begin{proof}
We have already seen that $\Gr \; \hCDO_n$ has an action of the pair $(\Vect, \GL_n)$. Moreover, from the explicit formula $\Gr \; \hCDO_n = \Hat{\tensor}_{0 < k} \Hat{\Sym}_{\hO_n} (\hOmega^1_n) \Hat{\tensor} \Hat{\tensor}_{0 \leq l} \Hat{\Sym}_{\hO_n} (\hT_n)$ shows that the spaces of fixed conformal dimension are finite sum of tensor products of the $(\Vect,\GL_n)$ modules $\hOmega^1_n$ and $\hT_n$. Thus, we can write each space of conformal dimension $N$ in the presentation of Equation (\ref{GK vert}). 
\end{proof}

\begin{dfn} 
An {\em extended Gelfand-Kazhdan vertex algebra} is a $\ZZ_{\geq 0}$-graded vertex algebra together with an action of $(\TVect, \GL_n)$ as in Definition \ref{graction} such that for each $N \geq 0$ one has a $\GL_n$-equivariant identification
\be\label{GK vert 2}
\cV^{(N)} = \hO_n \tensor_\CC V^{(N)}
\ee 
where $V^{(N)}$ is a finite dimensional $\GL_n$-representation. A {\em morphism} of a Gelfand-Kazhdan vertex algebra is a $(\TVect, \GL_n)$-equivariant morphisms of $\ZZ_{\geq 0}$-graded vertex algebras. We denote this category by $\Tilde{\rm Vert}_{n}$. 
\end{dfn}

The category ${\rm Vert}_n$ is a full subcategory of vertex algebras in $\Mod^{\ZZ/2}_{(\TVect, \GL_n)}$ consisting of those objects that satisfy the finiteness constraint above. 

\begin{lemma} 
The vertex algebra $\hCDO_n$ is an extended Gelfand-Kazhdan vertex algebra.
\end{lemma}

\begin{proof} We have already seen that $\hCDO_n$ has the structure of a $(\TVect, \GL_n)$-module. The 
same argument as in Lemma \ref{lemma GK vert gr} shows that the spaces of fixed conformal dimension can be expressed as in Equation (\ref{GK vert 2}). 
\end{proof}

\begin{rmk} 
As noted following Remark \ref{rmk:notations}, we do {\em not} require that a Gelfand-Kazhdan vertex algebra $\cV$
be $\hO_n$-linear.
The underlying vector space of $\cV$ is an $\hO_n$-module but  vertex algebra operations do not preserve that action.
\end{rmk}


\subsection{Descending Gelfand-Kazhdan vertex algebras} 

We show how Section \ref{gendescent} carries over to
Gelfand-Kazhdan descent for the categories of equivariant vertex
algebras defined in the previous section. We will perform both an
extended and non extended version of descent.

For a Gelfand-Kazhdan vertex algebra $\cV$ we define the sheaf $\sdesc_{\GK} (\cV)$ of
vertex algebras on the category $\GK_n$, and hence on the category
${\rm Hol}_n$. For now, let's fix a Gelfand-Kazhdan structure $\sigma$ on $X$. It will be
evident that all constructions are still functorial in this parameter.  

For each $N \geq 0$ we have a decomposition $\cV^{(N)} = \hO_n
\tensor_\CC V^{(N)}$ and hence a filtration on $\cV^{(N)}$ coming
from the vanishing order of jets. Thus, applying the same
construction as in Section~\ref{sec gk descent}, 
we obtain the pro-vector
bundle $\Fr_X \times^{\GL_n} \cV^{(N)}$. 
Since the action of $(\Vect,
\GL_n)$ preserves the $\ZZ_{\geq 0}$ grading, 
it is a pro-vector bundle equipped with a flat connection and hence we can define the
$\Omega^*(X)$-module 
\ben 
\bdesc(\sigma, \cV^{(N)}) = \left( \left(\Omega^*(\Fr_X) \tensor
    \cV^{(N)}\right)_{bas}, \d_{dR} + \omega_\sigma\right)  .
\een 
We now sum over all dimension spaces to obtain the $\Omega^*(X)$-module
\ben
\bdesc(\sigma, \cV) := \bigoplus_{N \geq 0} \bdesc(\sigma, \cV^{(N)})
\een

\begin{lemma} 
For any Gelfand-Kazhdan vertex algebra $\cV$ and Gelfand-Kazhdan structure
$(X,\sigma)$, the $\Omega^*(X)$-module $\bdesc(\sigma, \cV)$ has the
structure of a $\ZZ_{\geq 0}$-graded dg vertex algebra over
$\Omega^*(X)$. 
\end{lemma}

Thus, we obtain a sheaf of $\ZZ_{\geq 0}$-graded vertex algebras
$\sdesc(\sigma, \cV)$ by
taking flat sections. It is clear the construction is natural in the choice of a GK
structure so that we obtain a sheaf $\sdesc(\cV)$ of vertex algebras
on the category $\Hol_n$. 

\subsubsection{Classical limit of the sheaf of CDOs} 

In the example of the Gelfand-Kazhdan vertex algebra $\Gr \; \hCDO_n$ we denote the descent object by
\ben
\Gr \; \CDO_X := \sdesc((X,\sigma) ; \Gr \; \hCDO_n) .
\een
This is a sheaf of vertex algebras defined on any complex
manifold. As we remarked above, functoriality of the construction
implies that we have a sheaf of vertex algebra $\Gr \; \CDO$ defined
on the {\em category} ${\rm Hol}_n$.

Moreover, as the action of the pair $(\Vect, \GL_n)$
preserves the Poisson structure. This shows that $\Gr \; \CDO$ is actually a sheaf of Poisson
vertex algebras. 

\subsubsection{Extended descent for vertex algebras}

The construction for extended formal vertex algebras is similar, this
time we use the bundle of extended coordinates constructed in Section
\ref{sec ext desc}. 

Let us fix an extended Gelfand-Kazhdan structure $(X, \alpha,
\sigma,\sigma_{\Omega^2})$, that we simply denote by $\Tilde{\sigma}$,
and an extended Gelfand-Kazhdan vertex algebra
$\cV$. 

By construction, each dimension space $\cV^{(N)} = \hO_n \tensor_\CC
V^{(N)}$ has an action of $(\TVect, \GL_n)$ and hence we can form the
pro-vector bundle $\Fr_X \times^{\GL_n} \cV^{(N)}$ that is equipped
with a flat connection. The de Rham complex is the
$\Omega^*(X)$-module
\ben
\Tilde{\bdesc}(\Tilde{\sigma}, \cV^{(N)}) =
\left(\left(\Omega^*(\Fr_X) \tensor \cV^{(N)}\right)_{bas}, \d_{dR} +
  \Tilde{\omega}^\alpha_{\sigma, \sigma_{\Omega^2}}\right) .
\een 
Again, by summing over spaces of fixed conformal dimension we obtain the
$\Omega^*(X)$-module
\ben
\Tilde{\bdesc}(\Tilde{\sigma}, \cV) = \bigoplus_{N \geq 0}
\Tilde{\bdesc}(\Tilde{\sigma}, \cV^{(N)}) .
\een

The same proof as above carries over with minor modifications to show.

\begin{lemma} For any extended Gelfand-Kazhdan structure
  $\Tilde{\sigma}$ and extended Gelfand-Kazhdan vertex algebra $\cV$ the
  $\Omega^*(X)$-module $\bdesc(\Tilde{\sigma}, \cV)$ is a $\ZZ_{\geq
    0}$-graded dg vertex algebra over $\Omega^*(X)$. 
\end{lemma}

We obtain a sheaf of $\ZZ_{\geq 0}$-graded vertex algebras by taking
flat sections that we denote $\Tilde{\sdesc}(\Tilde{\sigma}, \cV)$. Again,
the construction is natural in the extended Gelfand-Kazhdan structure
so we obtain a sheaf of $\ZZ_{\geq 0}$-graded vertex algebras
$\Tilde{\sdesc}(\cV)$ on the category $\Tilde{\Hol}_n$. 

\subsubsection{The sheaf of CDOs}

We are finally able to to define the central object of study in this
work. 

\begin{dfn} Let $X$ be a complex manifold together with a
  trivialization $\alpha$ of $\ch_2(T_X)$. The {\em sheaf of chiral
    differential operators} on $X$ is the sheaf of vertex algebras
\ben
\CDO_{X,\alpha} := \Tilde{\sdesc}_{\GK} (X, \alpha ; \hCDO_n) .
\een
\end{dfn} 

\begin{rmk} The descent functor $\Tilde{\desc}_{\GK}$ depends on the
  choice of an extended Gelfand-Kazhdan structure and not just a
  trivialization of $\ch_2$. But, as we have already mentioned, the
  sheaf of flat sections does not depend on such a choice so we omit
  it from the notation. 
\end{rmk}

This definition of chiral differential operators via Gelfand-Kazhdan
formal geometry is similar in spirit to the formulation of the chiral
de Rham complex in \cite{MSV}. There, one defines the sheaf in a
similar way as above though with the non-extended pair $(\Vect,
\GL_n)$ (this pair indeed acts on the affine chiral de Rham vertex
algebra). We hope that the above constructions reflect systematically
how one can handle descent for objects that require extending the
usual action of formal automorphisms and derivations on the formal
disk. 

The compatibility of the Gelfand-Fuks-Chern class $\ch_2(\hT_n)$ and
the group cocycle $\alpha_{GMS}$ 
%\in {\rm C}_{Grp}^2(\Aut_n ; \hOmega^2_{n,cl
shows how our definition of chiral differential operators is related
to the original definition given in \cite{GMS}.

\subsubsection{The conformal structure}

We address the conformal structure for the sheaf of chiral differential operators. We have already notes that the vertex algebra $\hCDO_n$ has the structure of a conformal vertex algebra of charge $c = 2n$. This conformal structure, however, is not compatible with the action of $\TVect$ on CDO's on the formal disk. Indeed, Proposition \ref{prop c1 conformal} implies that the obstruction for these structures to be compatible is the first Gelfand-Fuks-Chern class $c_1^{\GF}(\hT_n)$. 

The conformal vector $L_{-2} \in \hCDO_n^{(2)}$ is preserved, however, by the action of $\GL_n$. Thus, the map of vertex algebras $\Phi : {\rm Vir}_{c=2n} \to \hCDO_n$, encoding the conformal structure, determines a map of graded $\Omega^\#_X$-modules 
\ben
\Phi : \Omega^\#(X) \tensor {\rm Vir}_{c=2n} \to \left(\Omega^\#(\Fr_X) \tensor \hCDO_n\right)_{bas} .
\een 
Now, the action of $\TVect$ on ${\rm Vir}_{c=2n}$ is trivial. So, when we equip the left-hand side with the differential $\d_{dR} + \Tilde{\omega}_{\sigma, \sigma_{\Omega^2}}$ coming from a fixed extended Gelfand-Kazhdan structure we obtain the constant $\Omega^*_X$-module $\Omega^*_X \tensor {\rm Vir}_{c=n}$. Thus, the sheaf obtained via descent $\sdesc(X ; {\rm Vir}_{c=2n}) = \ul{\rm Vir}_{c=2n}$ is just the constant sheaf. 

The right hand side also has a natural differential $\d_{dR} + \Tilde{\omega}_{\sigma, \sigma_{\Omega^2}}$ coming from a fixed extended Gelfand-Kazhdan structure making it a $\Omega^*_X$-module. The calculation of Proposition \ref{prop c1 conformal} implies that the failure for $\Phi$ to be a map of $\Omega^*_X$-modules is the image of the cocycle $c^\GF_1(\hT_n)$ under the characteristic map of the Gelfand-Kazhdan structure. This is precisely the usual first Chern class $c_1(T_X)$. We have arrived at the following. 

\begin{prop}\label{prop conformal cdo} 
Let $\alpha$ be a trivialization of $\ch_2(T_X)$ and suppose that $c_1(T_X) = 0$ in $H^1(X ; \Omega^1_X)$. Then there exists a map of sheaves of vertex algebras on $X$
\ben
\Phi : \ul{\rm Vir}_{c=2n} \to \CDO_{X,\alpha} . 
\een
In other words, in the case that $c_1(T_X) = 0$ the sheaf of chiral differential operators has a global Virasoro vector. 
\end{prop}

\subsubsection{The Witten genus}

It is well-known \cite{BorLib, Cheung} that the character of the sheaf of chiral differential operators equals, up to a factor, the Witten genus of the complex manifold. In this section, we remark on how to recover this fact using the construction of chiral differential operators via Gelfand-Kazhdan descent.

Recall, in Section \ref{sec vert character} we have defined the formal graded character of a vertex algebra. For $\cV = \oplus_{N \geq 0} \cV^{(N)}$ a Gelfand-Kazhdan vertex algebra, it is the element 
\ben
\chi^{(\Vect, \GL_n)} (\cV) = \sum_{N \geq 0} q^N \left(\Td^\GF \cdot \ch^{\GF}(\cV^{(N)})\right) \in \clie(\Vect ; \hOmega_n^{-*})[[q]] .
\een 

Given any sheaf of $\ZZ_{\geq 0}$-graded vertex algebras $\cV_X$ on a manifold $X$, one defines the character as follows. Note that the sheaf cohomology $H^*(X ; \cV_X)$ has the structure of a graded vertex algebra (that is, a differential graded vertex algebra with zero differential). In particular, it is a $\ZZ/2$-graded vertex algebra, with even part equal to $H^{ev}(X ; \cV_X)$ and odd part equal to $H^{odd}(X; \cV_X)$. The character of $\cV_X$ is the super character of $H^*(X ; \cV_X)$. That is,
\ben
\chi (\cV_X) := \sum_{N \geq 0} q^N \left(\dim(H^{ev}(X ; \cV_X^{(N)})) - \dim(H^{odd}(X ; \cV_X^{(N)})) \right) .
\een

\begin{lemma}\label{lemma local to global char} Fix a Gelfand-Kazhdan structure $(X,\sigma)$ and let $\cV$ be a Gelfand-Kazhdan vertex algebra one has
\ben
\chi\left(\sdesc(X ; \cV)\right) = \int_X {\rm char}_\sigma \left( \chi^{(\Vect, \GL_n)} (\cV)\right)  \in \CC [[q]]
\een
where ${\rm char}_\sigma : H^*_{\rm Lie} (\Vect, \GL_n ; \hOmega^{-*}_n) \to H^*(\Omega^{-*}_X)$ is the characteristic map associated to the Gelfand-Kazhdan structure extended $q$-linearly. 
\end{lemma}

\begin{proof} As a consequence of Grothendieck-Riemann-Roch for sheaves on $X$, we have
\ben
\chi\left(\sdesc(X ; \cV)\right) =  \int_X \sum_{N \geq 0} q^N \Td_X \cdot \ch(\desc(X ; \cV^{(N)}))  .
\een 
The integrand on the right-hand side is precisely the image of the class $\chi^{(\Vect, \GL_n)}(\cV)$ under the characteristic map associated to the Gelfand-Kazhdan structure. 
\end{proof}

Similarly, if $\cV$ is an extended Gelfand-Kazhdan vertex algebra and $\Tilde{\sigma} = (X,\alpha, \sigma, \sigma_{\Omega^2})$ is an extended Gelfand-Kazhdan structure then one has
\ben
\chi\left(\Tilde{\sdesc}(X ; \cV)\right) = \int_X \Tilde{\rm char}_{\Tilde{\sigma}} \left( \chi^{(\TVect, \GL_n)} (\cV)\right)  \in \CC [[q]]
\een
where $\Tilde{\rm char}(-)$ is the extended characteristic map $H_{\rm Lie}^*(\TVect, \GL_n ; \hOmega^{-*}_n) \to H^*(\Omega^{-*}_X)$ extended $q$-linearly.  

As a corollary, we recover the appearance of the Witten genus as the character of chiral differential operators on $X$. Recall, the {\em Witten class} of a manifold $X$ with ${\rm ch}_2(T_X) = 0$, is defined (see \cite{WittenGenus1, WittenGenus2}) as the following $q$-series valued in differential forms
\ben
{\rm Wit}(X,q) = \Hat{\rm A}_X \cdot \ch\left(\bigotimes_{l \geq 1} \Sym_{q^l} (\Omega^1_X \oplus T_X) \right) \left(\prod_{k \geq 1} (1-q^k)\right)^{2n} \in \Omega^{-*}_X [[q]]
\een
where $\Hat{\rm A}_X$ is the A-hat class of the tangent bundle of $X$. The {\em Witten genus} is obtained as the integral $\int_X {\rm Wit}(X,q)$ and is the $q$-expansion of a modular form. As an immediate consequence of our calculation in Proposition \ref{prop local character}, we obtain the well-known relation of the character and the Witten genus. 

\begin{prop}\label{prop char cdo} Let $\alpha$ be a trivialization of $\ch_2(T_X)$. The graded character of $\CDO_{X,\alpha}$ satisfies
\ben
\chi(\CDO_{X,\alpha}) = \left(\prod_{k \geq 1} (1-q^k) \right)^{-2n} \int_X e^{c_1(T_X)/2} {\rm Wit}(X, q) .
\een
\end{prop}
\begin{proof}
We have identified, in Corollary \ref{cor formal char cdo}, the $(\TVect, \GL_n)$-equivariant graded character of $\hCDO_n$ with the image of the class
\ben
\Td^{\GF} \cdot \ch^\GF \left( \bigotimes_{l \geq 1} \Sym_{q^l} (\hOmega^1_n \oplus \hT_n) \right) \in\clie^*(\Vect , \GL_n ; \hOmega^{-*}_n)[[q]]
\een
under the map $\clie^*(\Vect , \GL_n ; \hOmega^{-*}_n)[[q]] \to \clie^*(\TVect , \GL_n ; \hOmega^{-*}_n)[[q]]$. The image of this class under the characteristic map of the extended Gelfand-Kazhdan structure is $\Td_X \cdot \ch \left( \bigotimes_{l \geq 1} \Sym_{q^l} (\Omega^1_X \oplus T_X) \right)$. Thus, by Lemma \ref{lemma local to global char} we see that the graded character of $\CDO_{X,\alpha}$ is 
\ben
\chi(\CDO_{X,\alpha}) = \int_X \Td_X \cdot \ch \left( \bigotimes_{l \geq 1} \Sym_{q^l} (\Omega^1_X \oplus T_X) \right) .
\een
Finally, note that $\Td_X = e^{c_1(T_X)/2} \Hat{\rm A}_X$. 
\end{proof} 

\begin{rmk} 
We have already pointed out that in the case that $c_1(T_X) = 0$, 
the sheaf $\CDO_{X,\alpha}$ is a sheaf of conformal vertex algebras. 
Recall that the honest character of a vertex algebra is related to the graded character via ${\rm char}(V) = q^{-c/24} \chi(V)$, 
where $c$ is the central charge. 
Thus, in this case we have the following expression for the character of chiral differential operators:
\ben
{\rm char} (\CDO_{X,\alpha}) = \eta(q)^{-2n} \int_X {\rm Wit}(X, q) 
\een
where $\eta(q) = q^{1/24} \prod_{k \geq 1} (1-q^k)$ is the Dedekind $\eta$-function.
\end{rmk}

% This definition of chiral differential operators via Gelfand-Kazhdan
% formal geometry is similar in spirit to the formulation of the chiral
% de Rham complex in \cite{MSV}. There, one defines the sheaf in a
% similar way as above though with the non-extended pair $(\Vect,
% \GL_n)$ (this pair indeed acts on the affine chiral de Rham vertex
% algebra). We hope that the above constructions reflect systematically
% how one can handle descent for objects that require extending the
% usual action of formal automorphisms and derivations on the formal
% disk.


% \subsubsection{}

% The Lie group $\GL_n$ acts on $\CDO_n$ by vertex algebra
% automorphisms. Denote by $\mathbf{b}_m$ the vector
% $(b_m^1,\ldots,b_m^n)$ and $\mathbf{c}_m$ the vector $(c_m^1,\ldots,
% c_m^n)$. Given $A \in \GL_n$ the action of $A$ on CDOs is specified
% by 
% \begin{align}
% A \cdot {\bf c}_{0} & = A {\bf c}_0 \label{GLact1} \\
% A \cdot {\bf b}_{-1} & = (A^T)^{-1} {\bf b}_{-1} \label{GLact2}
% \end{align} 
% where, on the right-hand side we understand matrix multiplication.

% The choice of a coordinate determines a splitting $\GL_n \to \Aut_n$ of
% \ben
% 1 \to \Aut_n^+ \to \Aut_n \to \GL_n \to 1
% \een
% and determines a map of pairs
% \ben
% (\Vect, \GL_n) \to (\Vect, \Aut_n) .
% \een
% We have constructed an action of $\Aut_n$ on $\Gr \; \hCDO_n$ in Section \brian{ref}. The restriction of this action along the morphism above agrees with the action of $\GL_n$ in (\ref{GLact1}) -- (\ref{GLact2}).

% The extension of $\Aut_n$ determined by the universal second Chern character is trivial when restricted to $\GL_n$. Thus, this splitting lifts to a map $\GL_n \to \TAut_n$. Moreover, this determines a map of pairs
% \ben
% (\TVect, \GL_n) \to (\TVect, \TAut_n) .
% \een
% We have constructed an action of $\TAut_n$ on $\hCDO_n$ in Section \brian{ref}. The restriction of this action along the morphism above also agrees with the action of $\GL_n$ in (\ref{GLact1}) -- (\ref{GLact2}).

% \begin{prop} The following are true about the vertex algebra $\hCDO_n$:
% \begin{itemize}
% \item[(i)] the action of $\Vect$ on the vertex $\hO_n$-module $\Gr \; \hCDO_n$ from Section \brian{ref} gives $\Gr \; \hCDO_n$ the structure of an object in $\Vert(\VB_{(\Vect, \GL_n)})$;
% \item[(ii)] the action of $\TVect$ on the vertex $\hO_n$-module $\hCDO_n$ from Section \brian{ref} gives $\hCDO_n$ the structure of an object in $\Vert(\VB_{(\TVect, \GL_n)}^{\rm fil})$. 
% \end{itemize}
% \end{prop}

% \subsection{Descending vertex algebras}

% \subsubsection{}

% \def\bfV{\mathbf{V}}

% In this section we will show that Gelfand-Kazhdan descent, as in Section \brian{ref}, works in the setting of vertex algebras. More precisely, if we show that descent defines a functor
% \ben
% \desc_\GK : \GK^{op} \times \Vert(\VB_{(\Vect, \GL_n)}) \to \Vert(\Pro(\VB))_{flat} .
% \een
% Here, $\Vert(\Pro(\VB))_{flat}$ is the category of flat $\ZZ_{\geq 0}$-graded vertex algebra bundles on complex manifolds of dimension $n$. We will define this category shortly. As a corollary, the functor of taking flat sections defines an assignment of a Gelfand-Kazhdan structure $\sigma$ and an object $\cV \in \Vert(\VB_{\Vect, \GL_n})$ a {\it sheaf of $\ZZ_{\geq}$-vertex algebras} on $\Hol_n$ which we denote
% \ben
% \sdesc(\sigma, \cV) .
% \een

% The category of vector bundles is symmetric monoidal and so it makes sense to talk about algebra objects in this category. For instance, if $\pi : V \to X$ is a vector bundle on $X$ we can form the endomorphism bundle $\End(\pi) : \End(V) \to X$. It is an algebra object in the category of vector bundles. 

% Likewise, we can consider ``vertex algebra objects'' in the category of vector bundles, which we will call vertex algebra bundles. We can spell out this definition explicitly; it exactly mimics the definition of a vertex algebra given in Section \brian{ref}. 

% The definition of a vertex algebra involves a linear map
% \ben
% Y(-; z) : V \to \End(V) \ll z^\pm \rr
% \een
% whose expansion has the form $Y(v;z) = \sum v_{(m)} z^{-m-1}$. We will
% formulate a definition of a vertex algebra bundle in terms of the
% modes $v_{(n)}$. 

% \begin{dfn} A $\ZZ_{\geq 0}$-graded {\em vertex algebra bundle} on a complex manifold $X$ is a $\ZZ_{\geq 0}$-graded vector bundle $\pi : V = \oplus_N V^{(N)} \to X$ together with the data:
% \begin{itemize}
% \item[(i)] a non-trivial map of vector bundles $\left|0\> : \ul{\CC} \to V^{(0)}$;
% \item[(ii)] a map of vector bundles $T : V \to V$;
% \item[(iii)] for each $m \in \ZZ$ a map of vector bundles 
% \ben
% \mu_m : V \tensor V \to V
% \een
% \end{itemize}
% satisfying the following conditions:
% \begin{itemize}
% \item[(1)] for each $N$ the map $T$ restricts to a map of vector
%   bundles $T|_{V^{(N)}} : V^{(N)} \to V^{(N+1)}$;
% \item[(2)] for each $N,M \in \ZZ_{\geq 0}$ and $m \in \ZZ$ the
%   restriction of $(-)_{(n)}(-)$ is a map of vector bundles
% \ben
% \mu_m : V^{(N)} \tensor V^{(M)} \to V^{(M+N-m-1)}
% \een
% \item[(3)] the composition 
% \ben
% \xymatrix{
% V = \ul{\CC} \tensor V \ar[r]^-{\left| 0 \> \tensor \id} & V \tensor V
%   \ar[r]^-{\mu_m} & V
% }
% \een
% is zero if $n \ne -1$ and the identity when $n = -1$;
% \item[(4)]
% \end{itemize}
% \end{dfn}

% As above we focus only on $\ZZ_{\geq 0}$-vertex algebras. 


%\bibliographystyle{amsalpha}
%\bibliography{../fulldraft/refs}

% \subsubsection{}

% The Lie group $\GL_n$ acts on $\CDO_n$ by vertex algebra
% automorphisms. Denote by $\mathbf{b}_m$ the vector
% $(b_m^1,\ldots,b_m^n)$ and $\mathbf{c}_m$ the vector $(c_m^1,\ldots,
% c_m^n)$. Given $A \in \GL_n$ the action of $A$ on CDOs is specified
% by 
% \begin{align}
% A \cdot {\bf c}_{0} & = A {\bf c}_0 \label{GLact1} \\
% A \cdot {\bf b}_{-1} & = (A^T)^{-1} {\bf b}_{-1} \label{GLact2}
% \end{align} 
% where, on the right-hand side we understand matrix multiplication.

% The choice of a coordinate determines a splitting $\GL_n \to \Aut_n$ of
% \ben
% 1 \to \Aut_n^+ \to \Aut_n \to \GL_n \to 1
% \een
% and determines a map of pairs
% \ben
% (\Vect, \GL_n) \to (\Vect, \Aut_n) .
% \een
% We have constructed an action of $\Aut_n$ on $\Gr \; \hCDO_n$ in Section \brian{ref}. The restriction of this action along the morphism above agrees with the action of $\GL_n$ in (\ref{GLact1}) -- (\ref{GLact2}).

% The extension of $\Aut_n$ determined by the universal second Chern character is trivial when restricted to $\GL_n$. Thus, this splitting lifts to a map $\GL_n \to \TAut_n$. Moreover, this determines a map of pairs
% \ben
% (\TVect, \GL_n) \to (\TVect, \TAut_n) .
% \een
% We have constructed an action of $\TAut_n$ on $\hCDO_n$ in Section \brian{ref}. The restriction of this action along the morphism above also agrees with the action of $\GL_n$ in (\ref{GLact1}) -- (\ref{GLact2}).

% \begin{prop} The following are true about the vertex algebra $\hCDO_n$:
% \begin{itemize}
% \item[(i)] the action of $\Vect$ on the vertex $\hO_n$-module $\Gr \; \hCDO_n$ from Section \brian{ref} gives $\Gr \; \hCDO_n$ the structure of an object in $\Vert(\VB_{(\Vect, \GL_n)})$;
% \item[(ii)] the action of $\TVect$ on the vertex $\hO_n$-module $\hCDO_n$ from Section \brian{ref} gives $\hCDO_n$ the structure of an object in $\Vert(\VB_{(\TVect, \GL_n)}^{\rm fil})$. 
% \end{itemize}
% \end{prop}

% \subsection{Descending vertex algebras}

% \subsubsection{}

% \def\bfV{\mathbf{V}}

% In this section we will show that Gelfand-Kazhdan descent, as in Section \brian{ref}, works in the setting of vertex algebras. More precisely, if we show that descent defines a functor
% \ben
% \desc_\GK : \GK^{op} \times \Vert(\VB_{(\Vect, \GL_n)}) \to \Vert(\Pro(\VB))_{flat} .
% \een
% Here, $\Vert(\Pro(\VB))_{flat}$ is the category of flat $\ZZ_{\geq 0}$-graded vertex algebra bundles on complex manifolds of dimension $n$. We will define this category shortly. As a corollary, the functor of taking flat sections defines an assignment of a Gelfand-Kazhdan structure $\sigma$ and an object $\cV \in \Vert(\VB_{\Vect, \GL_n})$ a {\it sheaf of $\ZZ_{\geq}$-vertex algebras} on $\Hol_n$ which we denote
% \ben
% \sdesc(\sigma, \cV) .
% \een

% The category of vector bundles is symmetric monoidal and so it makes sense to talk about algebra objects in this category. For instance, if $\pi : V \to X$ is a vector bundle on $X$ we can form the endomorphism bundle $\End(\pi) : \End(V) \to X$. It is an algebra object in the category of vector bundles. 

% Likewise, we can consider ``vertex algebra objects'' in the category of vector bundles, which we will call vertex algebra bundles. We can spell out this definition explicitly; it exactly mimics the definition of a vertex algebra given in Section \brian{ref}. 

% The definition of a vertex algebra involves a linear map
% \ben
% Y(-; z) : V \to \End(V) \ll z^\pm \rr
% \een
% whose expansion has the form $Y(v;z) = \sum v_{(m)} z^{-m-1}$. We will
% formulate a definition of a vertex algebra bundle in terms of the
% modes $v_{(n)}$. 

% \begin{dfn} A $\ZZ_{\geq 0}$-graded {\em vertex algebra bundle} on a complex manifold $X$ is a $\ZZ_{\geq 0}$-graded vector bundle $\pi : V = \oplus_N V^{(N)} \to X$ together with the data:
% \begin{itemize}
% \item[(i)] a non-trivial map of vector bundles $\left|0\> : \ul{\CC} \to V^{(0)}$;
% \item[(ii)] a map of vector bundles $T : V \to V$;
% \item[(iii)] for each $m \in \ZZ$ a map of vector bundles 
% \ben
% \mu_m : V \tensor V \to V
% \een
% \end{itemize}
% satisfying the following conditions:
% \begin{itemize}
% \item[(1)] for each $N$ the map $T$ restricts to a map of vector
%   bundles $T|_{V^{(N)}} : V^{(N)} \to V^{(N+1)}$;
% \item[(2)] for each $N,M \in \ZZ_{\geq 0}$ and $m \in \ZZ$ the
%   restriction of $(-)_{(n)}(-)$ is a map of vector bundles
% \ben
% \mu_m : V^{(N)} \tensor V^{(M)} \to V^{(M+N-m-1)}
% \een
% \item[(3)] the composition 
% \ben
% \xymatrix{
% V = \ul{\CC} \tensor V \ar[r]^-{\left| 0 \> \tensor \id} & V \tensor V
%   \ar[r]^-{\mu_m} & V
% }
% \een
% is zero if $n \ne -1$ and the identity when $n = -1$;
% \item[(4)]
% \end{itemize}
% \end{dfn}

% As above we focus only on $\ZZ_{\geq 0}$-vertex algebras. 



